<!doctype html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Echo-Double Combat" /><meta property="og:locale" content="en" /><meta name="description" content="A set of CTF writeups and tutorials" /><meta property="og:description" content="A set of CTF writeups and tutorials" /><link rel="canonical" href="https://writeups.cyscomvit.com/writeups/FinalTrace_2025/45-echo-double-combat.html" /><meta property="og:url" content="https://writeups.cyscomvit.com/writeups/FinalTrace_2025/45-echo-double-combat.html" /><meta property="og:site_name" content="Cyscom" /><meta property="og:type" content="website" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Echo-Double Combat" /><meta name="twitter:site" content="@CyscomVit" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","dateModified":"2025-12-17T21:02:33+05:30","description":"A set of CTF writeups and tutorials","headline":"Echo-Double Combat","url":"https://writeups.cyscomvit.com/writeups/FinalTrace_2025/45-echo-double-combat.html"}</script><title> Cyscom | Echo-Double Combat</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Cyscom"><meta name="application-name" content="Cyscom"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.1/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.1/dist/jquery.min.js"></script><body data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/cyscom-logo.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">Cyscom</a></div><div class="site-subtitle font-italic">Cybersecurity Student Community of VIT Chennai</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>CTF EVENTS</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/posts/" class="nav-link"> <i class="fa-fw fas fa-pencil ml-xl-3 mr-xl-3 unloaded"></i> <span>POSTS</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/cyscomvit" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/CyscomVit" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fab fa-twitter"></i> </a> <a href="https://www.instagram.com/cyscomvit/" aria-label="instagram" target="_blank" rel="noopener noreferrer" > <i class="fab fa-instagram"></i> </a> <a href="mailto:cyscom@vit.ac.in" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/company/cyscomvit/" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span><a href="/writeups/FinalTrace_2025/">FinalTrace 2025</a></span> <span>Echo-Double Combat</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Writeup</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </span> <span id="search-cancel">Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1> Echo-Double Combat</h1><h2 id="echo-double-combat"><span class="mr-2">Echo-Double Combat</span><a href="#echo-double-combat" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><strong>Category</strong>: Reverse Engineering<li><strong>Author</strong>: Suraj Kumar</ul><h2 id="challenge-description"><span class="mr-2">Challenge Description</span><a href="#challenge-description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>A binary executable accepts a 9-character input key and validates it through XOR operations. The correct key is encoded in the binary and must be extracted by XORing stored bytes with <code class="language-plaintext highlighter-rouge">0x55</code>. Once the correct key is entered, the binary decrypts and reveals the flag using repeating-key XOR. A decoy flag is stored in encrypted form as a Base64 string (<code class="language-plaintext highlighter-rouge">WTNsemUyY3dYMkkwWTJ0ZmREQmZjM1EwY25SemZRPT0=</code>) in the binary’s strings, which decodes to <code class="language-plaintext highlighter-rouge">cys{g0_b4ck_t0_st4rts}</code> — this is intentionally wrong and serves as a red herring.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="initial-analysis"><span class="mr-2">Initial Analysis</span><a href="#initial-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Running basic reconnaissance on the binary revealed an encrypted decoy flag in the strings output. Further analysis required disassembling the binary to understand the validation logic and extract the encoded key array used for XOR operations.</p><h3 id="tools-used"><span class="mr-2">Tools Used</span><a href="#tools-used" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>Ghidra / IDA Pro / Binary Ninja<li>strings, file, objdump, readelf<li>Python 3<li>base64 (command-line tool)<li>GCC</ul><h3 id="step-by-step-solution"><span class="mr-2">Step-by-Step Solution</span><a href="#step-by-step-solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="step-1-initial-analysis"><span class="mr-2">Step 1: Initial Analysis</span><a href="#step-1-initial-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>file challenge.dat
strings challenge.dat
</pre></table></code></div></div><p>Found a Base64-encoded string <code class="language-plaintext highlighter-rouge">WTNsemUyY3dYMkkwWTJ0ZmREQmZjM1EwY25SemZRPT0=</code>. Decoding it twice reveals <code class="language-plaintext highlighter-rouge">cys{g0_b4ck_t0_st4rts}</code> which is a decoy flag (intentionally wrong). The binary requires a 9-character key as input.</p><h4 id="step-2-decode-the-decoy-red-herring"><span class="mr-2">Step 2: Decode the Decoy (Red Herring)</span><a href="#step-2-decode-the-decoy-red-herring" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">echo</span> <span class="s2">"WTNsemUyY3dYMkkwWTJ0ZmREQmZjM1EwY25SemZRPT0="</span> | <span class="nb">base64</span> <span class="nt">-d</span> | <span class="nb">base64</span> <span class="nt">-d</span>
<span class="c"># Output: cys{g0_b4ck_t0_st4rts}</span>
</pre></table></code></div></div><p>This decoy flag is not the answer and will fail if used as input. It exists to mislead players who rely only on strings output.</p><h4 id="step-3-extract-encoded-arrays-from-binary"><span class="mr-2">Step 3: Extract Encoded Arrays from Binary</span><a href="#step-3-extract-encoded-arrays-from-binary" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>objdump <span class="nt">-s</span> <span class="nt">-j</span> .data challenge.dat
<span class="c"># or</span>
readelf <span class="nt">-x</span> .data challenge.dat
</pre></table></code></div></div><p>Located two arrays in the <code class="language-plaintext highlighter-rouge">.data</code> section:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>key_enc:  34 39 3a 3d 3a 38 3a 27 34
flag_enc: 12 5f 0c 1a 5c 19 30 43 12 3e 19 01 59 5f 0e 04 17 05
</pre></table></code></div></div><h4 id="step-4-analyze-validation-logic-in-disassembler"><span class="mr-2">Step 4: Analyze Validation Logic in Disassembler</span><a href="#step-4-analyze-validation-logic-in-disassembler" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Opened the binary in Ghidra and decompiled the <code class="language-plaintext highlighter-rouge">main</code> function. Identified the key derivation and validation:</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">key</span><span class="p">[</span><span class="mi">9</span><span class="p">];</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">key</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">key_enc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="mh">0x55</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Read input and compare</span>
<span class="k">if</span> <span class="p">(</span><span class="n">memcmp</span><span class="p">(</span><span class="n">input</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Decrypt flag with repeating-key XOR</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">18</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">flag_enc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">key</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">9</span><span class="p">];</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h4 id="step-5-compute-the-real-key"><span class="mr-2">Step 5: Compute the Real Key</span><a href="#step-5-compute-the-real-key" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">key_enc</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">.</span><span class="nf">fromhex</span><span class="p">(</span><span class="sh">'</span><span class="s">34393a3d3a383a2734</span><span class="sh">'</span><span class="p">)</span>
<span class="n">key</span> <span class="o">=</span> <span class="nf">bytes</span><span class="p">(</span><span class="n">b</span> <span class="o">^</span> <span class="mh">0x55</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">key_enc</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">key</span><span class="p">.</span><span class="nf">decode</span><span class="p">())</span>  <span class="c1"># Output: alohomora
</span></pre></table></code></div></div><p>The real key is: <code class="language-plaintext highlighter-rouge">alohomora</code></p><h4 id="step-6-decrypt-the-flag"><span class="mr-2">Step 6: Decrypt the Flag</span><a href="#step-6-decrypt-the-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="n">flag_enc</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">.</span><span class="nf">fromhex</span><span class="p">(</span><span class="sh">'</span><span class="s">125f0c1a5c193043123e1901595f0e041705</span><span class="sh">'</span><span class="p">)</span>
<span class="n">key</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">alohomora</span><span class="sh">'</span>
<span class="n">flag</span> <span class="o">=</span> <span class="nf">bytes</span><span class="p">(</span><span class="n">flag_enc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">key</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">9</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">flag_enc</span><span class="p">)))</span>
<span class="nf">print</span><span class="p">(</span><span class="n">flag</span><span class="p">.</span><span class="nf">decode</span><span class="p">())</span>  <span class="c1"># Output: s3cr3t_1s_un10cked
</span></pre></table></code></div></div><h4 id="step-7-verify-and-retrieve-flag"><span class="mr-2">Step 7: Verify and Retrieve Flag</span><a href="#step-7-verify-and-retrieve-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>./challenge.dat
Speak the binding spell: alohomora
Flag: cys<span class="o">{</span>s3cr3t_1s_un10cked<span class="o">}</span>
</pre></table></code></div></div><p>Successfully retrieved the real flag by entering the correct key.</p><h3 id="python-solver-script"><span class="mr-2">Python solver script</span><a href="#python-solver-script" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h3 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>cys{s3cr3t_1s_un10cked}
</pre></table></code></div></div><h3 id="solver-python-code"><span class="mr-2">solver python code</span><a href="#solver-python-code" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>the code could change for new binary file as hex dump locations might change</p><p>#!/usr/bin/env python3 “”” Solver for the Echo-Double Challenge Based on the decompiled code analysis “””</p><p>def extract_data_from_binary(filename=’l’): “"”Extract data from the binary file””” try: with open(filename, ‘rb’) as f: data = f.read()</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre><td class="rouge-code"><pre>    print(f"[+] File size: {len(data)} bytes (0x{len(data):x})")
    
    # The addresses are 0x404060 and 0x404070
    # We need to find the file offset for these virtual addresses
    
    # Common data section offsets to try
    possible_offsets = [
        0x3060,  # 0x404060 - 0x401000 (common base)
        0x2060,  # Alternative
        0x4060,  # Alternative (if base is 0x400000)
        0x3040,  # Another common offset
    ]
    
    for base_offset in possible_offsets:
        offset_60 = base_offset
        offset_70 = base_offset + 0x10
        
        if offset_60 + 9 &lt;= len(data) and offset_70 + 18 &lt;= len(data):
            data_404060 = data[offset_60:offset_60+9]
            data_404070 = data[offset_70:offset_70+18]
            
            print(f"\n[*] Trying base offset: 0x{base_offset:04x}")
            print(f"    data_404060 (offset 0x{offset_60:04x}): {data_404060.hex()}")
            print(f"    data_404070 (offset 0x{offset_70:04x}): {data_404070.hex()}")
            
            # Try to decode and check if it makes sense
            result = solve_with_data(data_404060, data_404070)
            if result and result['valid']:
                return result
    
    # If nothing worked, try scanning the file
    print("\n[*] Trying to scan entire file for valid patterns...")
    return scan_for_data(data)
    
except FileNotFoundError:
    print(f"Error: File '{filename}' not found")
    return None
except Exception as e:
    print(f"Error: {e}")
    import traceback
    traceback.print_exc()
    return None
</pre></table></code></div></div><p>def scan_for_data(data): “"”Scan the file for potential encoded data””” print(“[*] Scanning for 9-byte sequences that decode to printable ASCII…”)</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre>candidates = []
for i in range(len(data) - 9):
    # Try XORing with 0x55
    spell = bytearray()
    valid = True
    for j in range(9):
        char = data[i+j] ^ 0x55
        if char &lt; 0x20 or char &gt; 0x7e:  # Not printable ASCII
            valid = False
            break
        spell.append(char)
    
    if valid:
        spell_str = spell.decode('ascii')
        print(f"    Found at offset 0x{i:04x}: {spell_str}")
        candidates.append((i, data[i:i+9]))

if candidates:
    print(f"\n[*] Found {len(candidates)} candidate(s)")
    # Use the first candidate
    offset, data_404060 = candidates[0]
    # Look for data_404070 nearby (16 bytes after)
    data_404070 = data[offset+16:offset+16+18] if offset+16+18 &lt;= len(data) else None
    
    if data_404070:
        print(f"[*] Using data at offset 0x{offset:04x}")
        return solve_with_data(data_404060, data_404070)

return None
</pre></table></code></div></div><p>def solve_with_data(data_404060, data_404070): “"”Solve the challenge with extracted data”””</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
</pre><td class="rouge-code"><pre># Step 1: Calculate the spell (key)
# var_1d[i] = data_404060[i] ^ 0x55
spell = bytearray()
for i in range(9):
    spell.append(data_404060[i] ^ 0x55)

print(f"\n[+] Calculated Spell:")
print(f"    Hex: {spell.hex()}")

# Try to decode as ASCII
try:
    spell_str = spell.decode('ascii')
    print(f"    ASCII: {spell_str}")
    is_printable = all(32 &lt;= b &lt;= 126 for b in spell)
except:
    spell_str = spell.decode('ascii', errors='replace')
    print(f"    ASCII (with errors): {spell_str}")
    is_printable = False

# Step 2: Decode the flag (Mirror Key)
# var_88[i] = var_1d[i % 9] ^ data_404070[i]
flag = bytearray()
for i in range(18):
    flag.append(spell[i % 9] ^ data_404070[i])

print(f"\n[+] Decoded Mirror Key:")
print(f"    Hex: {flag.hex()}")

# Try to decode as ASCII
try:
    flag_str = flag.decode('ascii')
    print(f"    ASCII: {flag_str}")
    flag_printable = all(32 &lt;= b &lt;= 126 for b in flag)
except:
    flag_str = flag.decode('ascii', errors='replace')
    print(f"    ASCII (with errors): {flag_str}")
    flag_printable = False

print(f"\n{'='*60}")
print(f"SOLUTION:")
print(f"{'='*60}")
print(f"Ancient Spell to Enter: {spell_str}")
print(f"Mirror Key (Flag): {flag_str}")
print(f"{'='*60}\n")

return {
    'spell': spell_str,
    'flag': flag_str,
    'valid': is_printable and flag_printable
}
</pre></table></code></div></div><p>def manual_solve(): “"”Manual solver - paste your hex data here””” print(“=”<em>60) print(“MANUAL MODE”) print(“=”</em>60) print(“Enter the hex data from the binary\n”) print(“To get the data manually, use:”) print(“ readelf -x .data l”) print(“ or”) print(“ objdump -s -j .data l”) print()</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre>data_404060_hex = input("Enter data_404060 (9 bytes in hex, e.g., 1a2b3c...): ").strip()
data_404070_hex = input("Enter data_404070 (18 bytes in hex, e.g., 4d5e6f...): ").strip()

try:
    # Remove spaces and common separators
    data_404060_hex = data_404060_hex.replace(" ", "").replace("0x", "")
    data_404070_hex = data_404070_hex.replace(" ", "").replace("0x", "")
    
    data_404060 = bytes.fromhex(data_404060_hex)
    data_404070 = bytes.fromhex(data_404070_hex)
    
    if len(data_404060) != 9:
        print(f"Error: data_404060 should be 9 bytes, got {len(data_404060)}")
        return
    
    if len(data_404070) != 18:
        print(f"Error: data_404070 should be 18 bytes, got {len(data_404070)}")
        return
    
    print()
    solve_with_data(data_404060, data_404070)
    
except ValueError as e:
    print(f"Error parsing hex: {e}")
</pre></table></code></div></div><p>def main(): import sys</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre>print("="*60)
print("Echo-Double Challenge Solver")
print("="*60)
print()

# Get filename
if len(sys.argv) &gt; 1:
    filename = sys.argv[1]
else:
    filename = 'l'

# Try automatic extraction first
print(f"[*] Attempting automatic data extraction from '{filename}'...\n")
result = extract_data_from_binary(filename)

if not result:
    print("\n" + "="*60)
    print("Automatic extraction failed. Switching to manual mode...")
    print("="*60)
    print()
    manual_solve()
</pre></table></code></div></div><p>if <strong>name</strong> == “<strong>main</strong>”: main()</p><h2> Flag</h2><code> cys{s3cr3t_1s_un10cked} </code></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div class="panel-heading"> <a href="https://github.com/cyscomvit/writeups/tree/main/website/writeups/FinalTrace_2025/45-echo-double-combat.md" ><i class="fab fa-github"></i> Edit on GitHub </a></div></div></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tag/authentication/">authentication</a> <a class="post-tag" href="/tag/idor/">idor</a> <a class="post-tag" href="/tag/sql-injection/">sql-injection</a> <a class="post-tag" href="/tag/ssti/">ssti</a> <a class="post-tag" href="/tag/xss/">xss</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://cyscomvit.com">Cyscom</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0">Using the <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> theme <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false" ><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script defer src="/assets/js/dist/commons.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
